issuekey,created,title,description,storypoints
16190013,2018-11-28 16:18:45.264,Add pagination to insight-ui,"- Bump jwt lifetime to 1 hour (so we have a workaround for pagination/timeout interactions)
- A user can view multiple pages of insight logs
- Resolve differences in api parameters

Frontend sends POST request in the following format

**REQUEST**
```JavaScript
METHOD: POST
Request URL: `https://${insight_log_endpoint}/fetch?page=0&rowsPerPage=10`
Parameters: page=0 & rowsPerPage=10
Request Headers:{
  Content-type: application/json
}
Request Payload:{
  JWT-Base64-token
}

```

**Expected RESPONSE**
```JavaScript
{
  records:[{...},{...}],
  page: 0,
  rowCount: 2
}
```",2
16189995,2018-11-28 16:17:51.070,Add pagination to insight-api (backend),"Frontend sends POST request in the following format

**REQUEST**
```JavaScript
METHOD: POST
Request URL: `https://${insight_log_endpoint}/fetch?page=0&rowsPerPage=10`
Parameters: page=0 & rowsPerPage=10
Request Headers:{
  Content-type: application/json
}
Request Payload:{
  JWT-Base64-token
}
```

**Expected RESPONSE**
```JavaScript
{
  records:[{...},{...}],
  page: 0,
  rowCount: 2,
  rowsPerPage: 10
}
```


",2
16187374,2018-11-28 14:46:17.485,Demo: Create content for all steps,,5
16187328,2018-11-28 14:44:20.860,Demo: Create needed components,"* [ ]  Stepper
* [x]  Title (design system)
* [x]  Button (design system)
* [x]  Small (design system)
* [x]  Paragraph (design system)


Stepper: Quick solution (later pas opnemen in de common-ui library, om nu tijd te winnen)
",8
16187302,2018-11-28 14:43:00.487,Demo: Finalize design and structure of content,,5
16179692,2018-11-28 10:49:05.535,Deploy common-ui to design-system.nlx.io,Common-ui should contain a Dockerfile that builds a static version of the Storybook and automatically deploys it to design-system.nlx.io.,5
16157729,2018-11-27 15:49:08.242,Invalid URL to x-road on nlx.io,"```$ muffet https://nlx.io
https://nlx.io/about/
	404	https://www.x-road.com
```

There's an invalid link to www.x-road.com, which is not an existing webpage.",1
16144782,2018-11-27 10:30:15.580,Create and use strict TLS configuration in all communication between components,"**As a** 
<br>**I want to**
<br>**so that**

**:white\_check\_mark: Acceptance criteria**

1. All components use a secure TLS configuration
1. TLS configuration can be managed in one separate package
1. Link to TLS config from docs

**:hammer\_and\_wrench: Proposed technical solution**

* Create a `common` package that sets the security parameters on a `*tls.Config` to strict values. Only the latest TLS and best ciphers. This only applies to communication between components we build.

**:link: Reference links**

*

",3
16068101,2018-11-23 13:20:12.100,Remove sorting in Insight app,"![Screenshot_2018-11-23_at_14.18.25](/uploads/0ff1243da92a23938523a16f24d635d5/Screenshot_2018-11-23_at_14.18.25.png)

Sorting of dates appears to be bugged, as 11/7 comes before 11/23 

Remove sorting completely, so that it will have default sorting by date (from backend)",1
16016734,2018-11-21 15:19:16.887,[Investigate] Docker image outway:latest does not work,"The latest docker image for the nlx outway does not work. All services have NO inway addresses.

This may be due to the day docker handles `:latest`, could a non-stable push have resulted in this error? Or has `:latest` not properly been tagged for a while? Start checking the CI/CD first and find out which version `:latest` currently is.

$ docker pull nlxio/outway:latest
latest: Pulling from nlxio/outway
Digest: sha256:c28f77c3c50043e96c35ac3ba124bd7b27b086f0e52c806f3e1c048b5b07ecfa

Timebox: 2 uur",0
16009054,2018-11-21 10:17:32.320,[Investigate] Create solution (incl concrete stories) for solving Linked Data challenges,Timebox: 2x3 uur (GJ en Bart),0
16008866,2018-11-21 10:10:34.363,Sort organizations in insight app menu list,- Sort list consistently using frontend filter,1
15954593,2018-11-19 15:11:09.698,Insight app doesn't regenerate QR and doesn't switch IRMA backend when selecting an other organization.,"In the insight app, when you've selected an organization and then select a different organization, the app doesn't switch to the new IRMA api and doesn't generate a new QR. A page reload is needed to fix the problem.",3
15840551,2018-11-14 11:27:36.269,Move CDN dependencies into local projects,"Move CDN dependencies into a projects (like bootstrap, jquery and others)
In general, CDN is used in non-react projects.

NLX Certportal (on test): https://certportal.test.nlx.io/
![image](/uploads/ec0e1a0609da8b34f7272677473696f5/image.png)

Haarlem Parkeervegunning: https://application.test.haarlem.commonground.nl/
![image](/uploads/3414e56cc5eb79f42161584c8463568a/image.png)

NLX Docs https://docs.test.nlx.io/
![image](/uploads/a0ba5ae23f18204569bfa01fb85b477b/image.png)",1
15582541,2018-11-05 17:55:01.584,Design user-based authentication within NLX,It would be great if NLX offers a generic way of handling user-based authentication. We would like to draft a design document to accumulate all the ideas we have on this topic. This design should be a starting point for actually implementing this feature in NLX.,1
15445623,2018-10-31 14:59:40.629,Create a solid plan/stories for implementing autorisation,"As a PO
I want to have a clear plan for implementing autorisation
so that can present NLX as a good solution for organizations that need authorisation

Acceptance criteria, for example:
- Clear technical plan for implementation
- Necessary stories are added and refined and an epic is created

Notes
- Brainstorm / Experiment
- Write story(ies)
- Check with Sergei to prevent unnecessary double work, they just implemented a similar solution in ZDS 2.0 API reference components",2
14852178,2018-10-11 10:51:25.942,Create a common-ui library,"As a developer
I want to have a common ui library
so that I can reuse components in multiple frontends

Acceptance criteria, for example:
- There is a common ui package
- All currently required components are available in the common ui package
- Stories are created on the backlog for all parts that are not part of this story

Notes
- This story is not concerned with actually replacing the components in the interfaces with the common ui components.
- But stories should be created for what needs to be done later.
- Relative imports
- Imports through an own npm namespace `@nlx/common-ui` and use [npm link](https://docs.npmjs.com/cli/link)",3
14738850,2018-10-06 16:39:13.561,Setup initial NLX performance benchmarking,"Benchmarking number of requests per second, find the boundaries for becoming io-bound, cpu-bound, memory-bound, on several systems.

Ideal would be to integrate those tests in deployment pipeline.

This user story replaces #27, more precise the following aspect:
Performance and scalability benchmarks. E.g. number of requests per second NLX can perform on a certain system.


DoD:

1. Create `nlx-bench` repo for the following:
1. Create server application to serve predictable-duration responses. w/ ansible script to deploy
1. Setup ansible scripts for inway/outway on servers. Use acc NLX network.
1. Create client application which measures round-trip time. w/ ansible script to deploy
1. Let client write output to files, no need for public dashboard / automation.

Proposed tech solutions:

vegeta or apache benchmark
https://github.com/tsenart/vegeta
",8
14508345,2018-09-27 07:30:46.082,Add NLX preprod and prod environment to current cluster and CI,"**As a customer** 
<br>**I want to use the NLX production environment**
<br>**so that I can have confidence in the stability of my solution that makes use of NLX**


**:white\_check\_mark: Acceptance criteria**

1. Note:  MVP production environment means a ""best effort"" production environment reserved for specific partners
1. Pre-prod: New customers show that they are ready to join production
   <br>Prod: New customers that succeed in pre-prod run their business in this NLX network
1. Those environments should have a secure process to provide certificates to organisations, with a manual verification step (see #317)
1. pre-prod and production environment should always be at same version.
1. demo environment needs to stay close to pre-prod and prod but intended deviations should be possible.
1. directory.nlx.io should show prod directory content.
1. directory.preprod.nlx.io should show pre-prod directory content
   


**:hammer\_and\_wrench: Proposed technical solution**

* Update helm charts
* remove cert portal/cf ssl CA from helm charts
* add gitlab CI jobs to manual trigger pre-prod prod release
* DNS record management

**:link: Reference links**

* 

- Deploy a preprod and prod environment from gitlab CI as manual release (same as demo)",5
14507498,2018-09-27 07:18:51.613,Create onboarding process for preprod and prod environment,"**As** a API provider
<br>**I want** to get a certificate for pre-prod and prod environment
<br>**So that** can start using NLX on pre-prod and prod

**:white\_check\_mark: Acceptance criteria**

1.  There is a document describing the process of providing a certificate
2.  Create a new CA and save keys in nlx-pass
3.  Add docs to docs.nlx.io on how to request a certificate

**:hammer\_and\_wrench: Proposed technical solution**

* CF ssl

**:link: Reference links**

* ",3
14441884,2018-09-25 07:27:52.014,Setup link checker for docs in CI,"As a **manitainer**
<br>I want to **automatically check if all used URLs in docs are still valid when committing**
<br>so that **we prevent dead links and solve them as quickly as possible when they happen anyway**


**:white\_check\_mark: Acceptance criteria**

1. docs.nlx.io and appstore.commonground.nl/docs
1. build fails when internal links are dead
1. daily job running for link checking (only give warning in ci/cd)

**:hammer\_and\_wrench: Proposed technical solution**

* In the CI: use [muffet](https://github.com/raviqqe/muffet) in a container linked to the to-be-released docs container to verify all URL's to be valid.
* 

**:link: Reference links**

* 
",3
14086084,2018-09-12 08:48:56.215,Add better graphs of NLX components and their interactions to docs,,1
14041125,2018-09-10 19:02:51.930,Mutual TLS ability for inway -> service connection,"**As a** sysadmin
**I want** mutual TLS encrypted connections between inway and API
**so that** all data connections are secure

There is no protection mechanism yet that can be used to secure services behind an inway. We would like to add some kind of mechanism to protect communication between the inway and the service as well.

**Acceptance criteria**
1. Ability to add client certificates to the inway service definition. This certificate is then used by the inway to connect to the service.
1. Ability to add trust configuration to the inway to determin whitch certificates from the api should be trusted by the inway.
1. Updated Documentation
1. Update all demo deployments",5
14028148,2018-09-10 10:58:51.120,Setup unit tests for inway,"- Write unit tests for code that is currently testable
- Add todo comments for code that needs to be refactored for what needs to be refactored
- Add separate stories for these todos",5
12247771,2018-06-22 11:32:02.082,Add pagination to txlog and txlog-ui,Maybe look into [postgraphile](https://github.com/graphile/postgraphile),1
12125104,2018-05-04 11:47:46.000,Let healthchecker watch db using LISTEN/NOTIFY,Search for issue number in code TODO's.,1
12125109,2018-05-04 11:43:22.000,Split directory inspection and registration API's into separate components/processes,Search for issue number in code TODO's.,1
24458820,2019-09-04 11:59:59.121,Streamline process obtaining production certificates,"**As an** administrator
<br>**I want to** to obtain pre-production and production certificates
<br>**so that** I can run NLX components in the production environment

**:white\_check\_mark: Acceptance criteria**

1. Explain the process for how to obtain certificates
1. Create 'Production` section on docs.nlx.io
1. ~~Maintainer documentation on how to help/validate customers that need a certificate~~
1. ~~Determine who is responsible in the team~~
1. ~~There is a backup of the PKI of the CA~~


**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)",5
24242141,2019-08-28 12:02:32.531,Let inway use the config-api,"**As an** administrator
<br>**I want to** be able to use the config-api to configure my inway
<br>**so that** i do not have to use the toml any more

**:white\_check\_mark: Acceptance criteria**

1. We add a new experimental flag `CONFIG_API` to tell the inway where the configuration API lives
1. The inway adopts the inway configuration, configures the corresponding services and checks every x seconds for new configuration, applies and reloads on a change.",3
24210180,2019-08-27 16:47:21.619,Add authentication to management-api,"**As an** administrator
<br>**I want to** have a secure management-api
<br>**so that** no unauthenticated people can make changes to the API

**:white\_check\_mark: Acceptance criteria**

1. Every API endpoint (except /login) is secured and will check if the user is authenticated
1. There should be a login screen as part of the UI
1. There should be an option to logout from the UI
1. Only support the roles 'admin', 'readonly' for now
1. When not authenticated, the UI should always redirect to the login screen
1. The authenticatie mechanism should be pluggable. Looking up logins from a plain text file is fine for now.
1. Token should expire after 60 minutes (don't implement refresh logic for now)

**:hammer\_and\_wrench: Proposed technical solution**

1. Add & implement a /login endpoint
1. It is possible to specify multiple users, passwords (hashed) and a role in a plain text file

# LATER
1. When logged in, user name should be shown top right in Management UI.
1. When clicking on user name, there should be option to log out


*The overall idea is that one Management Dashboard gives infra admins the possibility to manage their NLX components (while not being able to access functional logs) and gives privacy auditors and / or functional managers the ability to look up transaction logs (while not being able to alter the NLX network config)*
",8
24210043,2019-08-27 16:42:20.212,Create initial management-ui,"**As a** administrator
<br>**I want to** administer my NLX components from a fancy UI
<br>**so that** I do not have to use the CLI anymore

**:white\_check\_mark: Acceptance criteria**

1. A new React app is setup with create-react-app in `management-ui`
1. An initial Router setup is done with react-router with an inway page and service page
1. The system shows a list of Inways and Services
1. It is possible to create a new service, update an existing service and delete a service",13
23908820,2019-08-19 11:41:48.563,Document header specifications,"**As a** end-user developer
<br>**I want to** know the specifications of the NLX http headers
<br>**so that** I can design my datamodel to store the data.

**:white\_check\_mark: Acceptance criteria**

1. Document NLX header specifications (type, size, optional or not)
1. Add this as content on docs.nlx.io including navigation
1. Link to this page frrom relevant sections

**:hammer\_and\_wrench: Proposed technical solution**

* n/a

**:link: Reference links**

* [Header documentation currently](https://docs.nlx.io/further-reading/transaction-logs/)",2
23424852,2019-08-02 09:35:46.193,Make insight-api and irma-api-server configurable and disable on the minikube by default,"**As a** developer
<br>**I want to** have a fast developer environment
<br>**so that** I can develop quickly

**:white\_check\_mark: Acceptance criteria**

1. The services insight-api and irma-api-server are configurable in the organization Helm chart
1. These services are disabled by default on the minikube environment",1
23199269,2019-07-26 13:53:43.808,Clean up Gitlab runners,I cleaned up our Gitlab runners. We should change some of the tags in our jobs to be consistent across projects.,1
22932308,2019-07-17 14:38:04.571,Create a management API to manage inway and service configuration from UI,"**As a** developer
<br>**I want to** by able to manage the inway and service configuration through the management-api
<br>**so that** we can start building the management-ui

**:white\_check\_mark: Acceptance criteria**

1. A new service `management-api` is added to the codebase
1. It is possible to PUT new inway configurations to the `management-api`
1. These inway configuration updates are persisted in etcd
1. There is no authentication or authorisation performed yet on this service (later enhancement)


**Technical implementation**

No gRPC, use REST/JSON",8
22930844,2019-07-17 14:11:24.022,Enhance the quality of NLX error messages,"**As a** user 
<br>**I want** error messages that tell me exactly what is going on
<br>**so that** I don't have to waste time analyzing

**:white\_check\_mark: Acceptance criteria**

1. Possible errors are identified and no longer ambiguous
1. Errors during setup / usage inway and outway are clear
1. Possible errors are documented with a short explanation 
1. +kudos if error message links to docs

**:hammer\_and\_wrench: Proposed technical solution**

1) identifield possible failures.

client -> outway -> F1 -> inway -> F2 -> service.

directory health check -> F3 inway.

directory list 'unhealty' services.

Cases F1, F2 now produces clear logs.
Case F3 now no longer is cause for removal from directory.

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*",8
22930841,2019-07-17 14:11:20.878,Build the config API,"**As a** user
<br>**I want to** have configuration API
<br>**so that** I don't need to start all xways with complex cli commands

--- 

**:white\_check\_mark: Acceptance criteria**

1. Configuration API with persistent storage backend
1. Configurations can be saved and retrieved
1. Configuration template for an inway
1. Configuration is validated by the API

**:hammer\_and\_wrench: Proposed technical solution**

* etcd as persistent storage
* communication between API and component GRPC

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*",13
22835917,2019-07-16 10:57:42.391,Zap logger failed to sync,"When stopping an outway or inway with ctrl+c, you see the following message:

```
failed to sync zap logger: sync /dev/stderr: invalid argument
```

*Expected behaviour*

* The Zap logger is successfully synced and no error is shown.

*Actual behaviour*

* Failed to sync the logger and displaying an error.

**:clipboard: Steps to reproduce**

1. Start outway (or inway) from console
1. Stop outway (or inway) with ctrl+c


**:beetle: Cause**

Not yet known

**:mag: Details**

N/A

---",2
22834631,2019-07-16 10:09:15.187,Enable HTTP2  between outway and inway,"**As a** customer
<br>**I want to** have HTTP2 enabled between the outway and inway
<br>**so that** we use less CPU and gain an higher throughput

**:white\_check\_mark: Acceptance criteria**

1. Running an outway with `GODEBUG=http2debug=1` displays the usage of http2

**:hammer\_and\_wrench: Proposed technical solution**

*  Enable http2 transport in the outway

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)",1
22804784,2019-07-15 14:08:53.749,Switch back to Gitlab Gosec image for SAST,"The following discussion from !657 should be addressed:

- [x] @RonaldKoster started a [discussion](https://gitlab.com/commonground/nlx/merge_requests/657#note_191689116):  (+1 comment)

    > `registry.gitlab.com/bartjkdp/gosec:feature-upgrade-to-gosec-2` image in personal registry? I would prefer something like`registry.gitlab.com/nlx/gosec:feature-upgrade-to-gosec-2`

Switch back to Gitlab image when MR is accepted.",1
22732336,2019-07-12 09:51:18.661,Directory inspection API get service api spec database error,"The `/directory/get-service-api-spec` endpoint on the directory-inspection-api returns `Database error.`.

*Expected behaviour*

*  `200 Ok` response with the service api spec or `404 Not Found` when no spec exists.

*Actual behaviour*

*  500 Internel Server error response: `{""error"":""Database error."",""message"":""Database error."",""code"":13}`

**:clipboard: Steps to reproduce**

1. GET request to https://directory.demo.nlx.io/api/directory/get-service-api-spec/convenantgemeenten/AppointmentDataService


**:beetle: Cause**


* Error is caused by `Scan` that returns an error. See https://gitlab.com/commonground/nlx/blob/master/directory-inspection-api/inspectionservice/get-service-api-spec-doc.go#L63


**:mag: Details**

*  When there are no inways registered:
```
inspectionservice/get-service-api-spec-doc.go:65	failed to execute stmtSelectServiceInway	{""version"": ""v0.73.0"", ""handler"": ""list-services"", ""error"": ""sql: no rows in result set""}
```

*  When there is a inway registered:
```
inspectionservice/get-service-api-spec-doc.go:65	failed to execute stmtSelectServiceInway	{""version"": ""v0.73.0"", ""handler"": ""list-services"", ""error"": ""sql: Scan error on column index 1, name \""api_specification_type\"": unsupported Scan, storing driver.Value type <nil> into type *string""}
```

---",3
22636492,2019-07-09 15:04:08.706,Implement 503 HTTP status code for offline services,"**As a** developer
<br>**I want to** use nlx and have sane error messages
<br>**so that** I can debug my new inway / outway

```
$ curl http://outway:9090/nlx/afval/
nlx outway: invalid path in url
```

Above error could have **many** causes which can be explained. A most of all the *PATH IS CORRECT.*

Communication failure between Inway and directory means no outway will be able to access the service. This makes nlx quite fragile.

Possible causes:

* Inway can't connect to upstream API: `[inway] http: proxy error: dial tcp 127.0.0.1:3000: connect: connection refused`


**:white\_check\_mark: Acceptance criteria**

1. A temporarily unavailable service should give back 503. Not a 4xx. since the user is not at fault.<br>
2. Make Outway work even when communication between inway and directory fails.

**:hammer\_and\_wrench: Proposed technical solution**

* The outway should also have knowlegde of offline services from the directory service.

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)",1
22511556,2019-07-04 08:10:35.700,golangci-lint run outway solve marked issues .,"*Expected behaviour*

* No golangci-lint comments.

*Actual behaviour*

the output of `golangci-lint` should be empty but it is not.

```
auth_test.go:124:25: bodyclose: response body must be closed (bodyclose)
		resp, err := client.Do(req)
		                      ^
listen_test.go:64:25: bodyclose: response body must be closed (bodyclose)
		resp, err := client.Do(req)
		                      ^
cmd/nlx-outway/main.go:70:2: importShadow: shadow of imported from 'go.nlx.io/nlx/common/process' package 'process' (gocritic)
	process := process.NewProcess(logger)
	^
listen.go:28:33: importShadow: shadow of imported from 'go.nlx.io/nlx/common/process' package 'process' (gocritic)
func (o *Outway) ListenAndServe(process *process.Process, address string) error {
                                ^
listen.go:50:36: importShadow: shadow of imported from 'go.nlx.io/nlx/common/process' package 'process' (gocritic)
func (o *Outway) ListenAndServeTLS(process *process.Process, address string, certFile, keyFile string) error {
                                   ^
outway.go:85:6: emptyStringTest: replace `len(authCAPath) == 0` with `authCAPath == """"` (gocritic)
		if len(authCAPath) == 0 {
		   ^
outway.go:88:3: importShadow: shadow of imported package 'url' (gocritic)
		url, err := url.Parse(authServiceURL)
		^
service.go:65:1: paramTypeCombine: func(logger *zap.Logger, roots *x509.CertPool, certFile string, keyFile string, organizationName, serviceName string, inwayAddresses []string) (*RoundRobinLoadBalancedHTTPService, error) could be replaced with func(logger *zap.Logger, roots *x509.CertPool, certFile, keyFile, organizationName, serviceName string, inwayAddresses []string) (*RoundRobinLoadBalancedHTTPService, error) (gocritic)
func NewRoundRobinLoadBalancedHTTPService(logger *zap.Logger, roots *x509.CertPool, certFile string, keyFile string, organizationName, serviceName string, inwayAddresses []string) (*RoundRobinLoadBalancedHTTPService, error) {
^
outway_internal_test.go:53: File is not `gofmt`-ed with `-s` (gofmt)
				&inspectionapi.ListServicesResponse_Service{ServiceName: ""mock-service-a"", OrganizationName: ""mock-org-a"", InwayAddresses: mockServiceAInwayAddresses},
				&inspectionapi.ListServicesResponse_Service{ServiceName: ""mock-service-b"", OrganizationName: ""mock-org-b"", InwayAddresses: mockServiceBInwayAddresses},
				&inspectionapi.ListServicesResponse_Service{ServiceName: ""mock-service-c"", OrganizationName: ""mock-org-c""},
cmd/nlx-outway/main.go:39:1: cyclomatic complexity 12 of func `main` is high (> 10) (gocyclo)
func main() {
^
service_test.go:16:22: string `mockorg` has 2 occurrences, make it a constant (goconst)
	organisationName := ""mockorg""
	                    ^
service_test.go:17:17: string `mockservicename` has 2 occurrences, make it a constant (goconst)
	serviceName := ""mockservicename""
	               ^
service_test.go:19:14: string `../testing/org-nlx-test.crt` has 2 occurrences, make it a constant (goconst)
	certFile := ""../testing/org-nlx-test.crt""
	            ^
service_test.go:20:13: string `../testing/org-nlx-test.key` has 2 occurrences, make it a constant (goconst)
	keyFile := ""../testing/org-nlx-test.key""
	           ^
service.go:38:2: `endPoints` is unused (structcheck)
	endPoints       []*url.URL
	^
outway.go:49:2: `headersStripList` is unused (structcheck)
	headersStripList *http.Header
	^
auth_test.go:86:29: Error return value of `(*encoding/json.Encoder).Encode` is not checked (errcheck)
			json.NewEncoder(w).Encode(authResponse)
			                         ^
auth_test.go:92:28: Error return value of `(*encoding/json.Encoder).Encode` is not checked (errcheck)
		json.NewEncoder(w).Encode(authResponse)
		                         ^
listen.go:103:17: shadow: declaration of ""err"" shadows declaration at line 94 (govet)
		authResponse, err := o.authorizeRequest(r.Header, destination)
		              ^
listen_test.go:86:2: SA4006: this value of `destination` is never used (staticcheck)
	destination, err = parseURLPath(""/organization/service"")
	^
```

**:clipboard: Steps to reproduce**

1. golangci-lint run outway solve all issues.


**:mag: Details**

(Paste any relevant logs - please use code blocks to format console output, logs, and code)

(Add screenshots using `Attach a file`)

---",2
22479450,2019-07-03 11:54:40.254,Add first version of configuration API,"**As a** user
<br>**I want to** configure and manage inways and outways from a central point
<br>**so that** I don't need to start all xways with complex cli commands

--- 

Out of scope (will be done later): 
* Keyless

**:white\_check\_mark: Acceptance criteria**

1. xway registration flow implemented 
1. xway self init and registration
1. management API for self init acknowledgement
1. Configuration API with persistent storage backend
1. xway watches configuration for changes
1. toml's are gone


**:hammer\_and\_wrench: Proposed technical solution**

* 

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*",20
22381848,2019-06-30 10:27:26.340,Move scheduled security scanning to nlx-security repo,"**As a** developer
<br>**I want to** move scheduled security scan to a seperate repo
<br>**so that** it doesn't interfere with the dev pipelines

---

Moving it to a separate repo allows us to:

* Reserve the gitlab-ci.yml for development pipelines, keeping it clean

**:white\_check\_mark: Acceptance criteria**

* [x]  Move scheduled security scan pipeline to repo nlx-security
* [x]  Security scans run on demo, preprod and prod
   * [x]  Dependency scanning
   * [x]  Static application security testing (SAST)
   * [x]  Container scanning
   * [x]  Dynamic application security testing (DAST)
* [x]  Report findings in the security dashboard, building a consistent history
* [x]  Add security scans to the nlx repo development pipelines that do NOT report to security dashboard
   * [x]  Dependency scanning
   * [x]  Static application security testing (SAST)",3
22331361,2019-06-27 20:05:38.458,Changes in inway configuration do not propagate to directory,"When attributes of services change (e.g. api specification url or documentation url) these changes are not propagated to the directory. This can be solved by manually deleting the service from the PostgreSQL database. A new service is created with the correct information.

*Expected behaviour*

* When a change occurs in the inway configuration of a service, this is automatically propagated through tot the directory.

*Actual behaviour*

* The information is not updated in the directory.

**:clipboard: Steps to reproduce**

1. Start a service without an api spec URL on an inway and register to the directory
1. Add an API spec URL
1. See the spec URL is not visible within the directory.


**:beetle: Cause**

* (if cause is known, details here)
* (if you can pinpoint a piece of code, link to line number)


**:mag: Details**

Regression, worked before

(Paste any relevant logs - please use code blocks to format console output, logs, and code)

(Add screenshots using `Attach a file`)

---",2
22272224,2019-06-26 13:38:50.106,Directory: add a link to the documentation of an API,"**As a** user
<br>**I want to** , when using the directory-ui, navigate to the documentation-url provided by the provider of an API
<br>**so that** I can read the documentation of an API 

**:white\_check\_mark: Acceptance criteria**

1. documentation-url link is available on the drawer of the Directory UI

**:hammer\_and\_wrench: Proposed technical solution**

* Display value of property `documentation_url` if present.

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*

**:camera_with_flash: Screenshot**

![Screenshot_2020-12-08_at_13.32.51](/uploads/34b1198fafc76b8cafa350831012ebb8/Screenshot_2020-12-08_at_13.32.51.png)",1
22090288,2019-06-20 10:46:35.050,Enable gitlab-ci on nlx-demo repository,"**As a** developer
<br>**I want to** automatically release Docker images for nlx-demo
<br>**so that** I do not have to do this manually

**Background**

When we moved from Jenkins to Gitlab CI we forgot to create a new configuration for the nlx-demo repo.

**:white\_check\_mark: Acceptance criteria**

1. Gitlab CI automatically Docker images when commits land on master",1
22086017,2019-06-20 08:25:47.295,The /about page on nlx.io is not working any more,"The /about page on nlx.io is not working any more

**:clipboard: Steps to reproduce**

1. Go to www.nlx.io/about

**:beetle: Cause**

* An incorrect nginx configuration",1
22074389,2019-06-19 20:12:36.038,Links in Docs don't work,"In the Getting Started guide, links intended to lead from page to page are broken.
Requesting pages without trailing slash does not work

*Expected behaviour*

Links lead to a page

* consume-an-api.md: `[part 2](../create-certificates)` & `[part 4](../provide-an-api)`
* create-certificates.md: `[part 1](../setup-your-environment)`
* provide-an-api.md: `[part 2](../create-certificates)` & `[part 2](../create-certificates)`

*Actual behaviour*

Every link without trailing slash fails. Instead it attempts to load something from port 8080.

**:clipboard: Steps to reproduce**

1. Visit https://docs.nlx.io/get-started/setup-your-environment/
1. Follow the guide
1. Click every link in the guide

It's not just the guide but everything on docs

**:beetle: Cause**

* Might be an Nginx configuration error


**:mag: Details**


---",2
22069104,2019-06-19 16:13:25.955,"Incorrect port for ""Consume an API"" in docs","Update incorrect port in docs.

*Expected behaviour*

* “You will get back the container id of the container you created from this image. By running this command, we’ve launched our very own NLX outway. It is running on http://localhost:8080.”

*Actual behaviour*

* “You will get back the container id of the container you created from this image. By running this command, we’ve launched our very own NLX outway. It is running on http://localhost:4080.”

**:clipboard: Steps to reproduce**

1. Go to docs ""consume an API"" page: https://docs.acc.nlx.io/get-started/consume-an-api/
1. Navigate to section ""Setting up the outway""


**:beetle: Cause**

* (if cause is known, details here)
* (if you can pinpoint a piece of code, link to line number)


**:mag: Details**

(Paste any relevant logs - please use code blocks to format console output, logs, and code)

(Add screenshots using `Attach a file`)

---",1
22060011,2019-06-19 11:50:23.660,insight-api unit tests,"**As a** developer
<br>**I want to** have unit tests on the insight-api
<br>**so that** I am kinda sure everything is working 

**:white\_check\_mark: Acceptance criteria**

1. Test what can be tested on the insight-api

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*",2
22052521,2019-06-19 09:14:15.265,Eliminate txlog-ui and txlog-api,"**As a** developer
<br>**I don't want to** maintain a deprecated application
<br>**so that** I can spend my energy on more useful tasks

TX Log UI is unsecure technical debt and should be eliminated.
Will be replaced later with UI in Management Dashboard.

**:white\_check\_mark: Acceptance criteria**

1.  update the docs - remove txlog UI and show Postgres guideline to show logs
1.  txlog-ui directory removed from repository
1.  txlog-api directory removed from repository
1.  pipelines updated
1.  helm / skaffold updated
1.  remove from Uptime Robot
1.  update nlx-compose repo


**:hammer\_and\_wrench: Proposed technical solution**

*  Copy Postgres query from txlog-api for guideline

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
* ",3
21935617,2019-06-15 10:12:51.884,Add different issue templates,"**As a** user
<br>**I want to** submit feature requests, bugs, support questions, etc.
<br>**so that** 

**:white\_check\_mark: Acceptance criteria**

1.  Issue template for User story
1.  Issue template for Bug
1.  Issue template for Support tickets
1.  Issue template for Security reports
1.  Template for Merge requests


**:hammer\_and\_wrench: Proposed technical solution**

*  https://gitlab.com/help/user/project/description_templates.md#using-the-templates

**:link: Reference links**

*",1
21907597,2019-06-14 09:09:01.636,Reduce noise from Renovate bot,"**As a** developer
<br>**I want** to reduce the number of Pull Requests generated by Renovate Bot
<br>**so that** runners are available when I need them and I don't have to review and merge so many PR's every day

---

Renovate bot is great but generates too many PR's to comfortably process.
Let's reduce the noise.

**:white\_check\_mark: Acceptance criteria**

1.  Groups of dependencies are grouped into aggregated Pull Requests
1.  Renovate Bot only generates new PR's between 2:00h AM CET and 8:00 AM CET to keep runners available when devs need them

**:hammer\_and\_wrench: Proposed technical solution**

*   Enable Package Grouping: https://renovatebot.com/docs/noise-reduction/#package-grouping
*   Limit Renovate to the night with scheduling: https://renovatebot.com/docs/noise-reduction/#scheduling-renovate

**:link: Reference links**

* https://renovatebot.com/docs/noise-reduction/",2
21859481,2019-06-13 06:23:00.943,Remove FIELDLAB-WALKTROUGH.md,"**As a** PO
<br>**I want to** remove the old fieldlab walktrough
<br>**so that** people don't start a guide that isn't accurate anymore

**:white\_check\_mark: Acceptance criteria**

1.  File FIELDLAB-WALKTROUGH.md is removed from repo root

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",0
21834539,2019-06-12 11:58:05.674,Rename NLX Stelsel to NLX System,"**As a** PO
<br>**I want** the Readme.md to be in English
<br>**so that** everyone can understand it

**:white\_check\_mark: Acceptance criteria**

1.  Change title in Readme.md from NLX Stelsel to NLX System

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",0
21833752,2019-06-12 11:31:28.109,Add security e-mail address,"**As a** responsible security researcher
<br>**I want to** report security issues securely
<br>**so that** the world does not abuse the issue while NLX team is fixing it

**:white\_check\_mark: Acceptance criteria**

1.  We have a ""security@nlx.io"" e-mail address where the world can report security issues (see #143)
1.  This e-mail address creates confidential issues in new repo `nlx-security` 
1.  This new repo has limited access rights - need to know

**:hammer\_and\_wrench: Proposed technical solution**

* Add email forwarder in TransIP

**:link: Reference links**

*",2
21832398,2019-06-12 10:32:51.686,Scheduled pipelines for security scans,"**As a** DevSecOps dude
<br>**I want to** schedule a pipeline running regular scans on our containers and deployed endpoints
<br>**so that** we keep an eye on security after building / deploying

**:white\_check\_mark: Acceptance criteria**

1.  Scheduled pipeline configured in Gitlab
2.  Security scans that we use in build pipelines are added to this pipeline
3.  Results are added to Gitlab Security Dashboard

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",8
21832269,2019-06-12 10:28:01.727,Document Definition of Done,"**As a** PO
<br>**I want** a clear Definition of Done for NLX stories
<br>**so that** it is clear to everyone when a story is truly 'done'

**:white\_check\_mark: Acceptance criteria**

1.  Definition of Done is available as an .md in repo root
2.  Issue template links to DoD
3.  Contribute.md links to DoD

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",1
21829363,2019-06-12 08:52:00.970,Document deployment flow,"**As a** PO
<br>**I want** a documented deployment flow
<br>**so that** everyone involved knows exactly what to do

**:white\_check\_mark: Acceptance criteria**

1. New flow documented in contribute.md
1. Includes detailed actions for all roles, as a manual

**:hammer\_and\_wrench: Proposed technical solution**

* Add to contribute

**:link: Reference links**

*",2
21785012,2019-06-11 08:59:56.430,Adding logrecords by inway & outway is unreliable,"**As a** presentor of the NLX demo
<br>**I want to** be sure the logrecords are always persisted to the database
<br>**so that** I can rely on our software

---

Currently, logrecords are not consistently written to the database. Happens to both inway (more often) and outway.

**:white\_check\_mark: Acceptance criteria**

1. Prevent the following Postgres error when inserting a logrecord to the database:

> failed to start db transaction for log insertion: read tcp 10.130.69.221:42778->10.130.60.248:5432: read: connection reset by peer 

**:hammer\_and\_wrench: Proposed technical solution**

* Reason for this to happen is unclear.
* Investigate issue, Might be the Postgres driver. Check open issues postgres drivers

**:link: Reference links**

* [Errors in Kibana](https://kibana.charlie.k8s.nlx.io/app/kibana#/discover?_g=(refreshInterval:(pause:!f,value:5000),time:(from:'2019-06-11T08:12:04.024Z',mode:absolute,to:'2019-06-11T08:27:04.024Z'))&_a=(columns:!(_source),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'379f7480-85e6-11e9-897a-49a1f312e0a7',key:kubernetes.namespace_name,negate:!f,params:(query:nlx-demo-brp,type:phrase),type:phrase,value:nlx-demo-brp),query:(match:(kubernetes.namespace_name:(query:nlx-demo-brp,type:phrase))))),index:'379f7480-85e6-11e9-897a-49a1f312e0a7',interval:auto,query:(language:lucene,query:ERROR),sort:!('@timestamp',desc))).

**Screenshot**
![Screenshot_2019-06-11_at_10.33.33](/uploads/2c9f1296c9c2d160d4881dd04766d66c/Screenshot_2019-06-11_at_10.33.33.png)",5
21641231,2019-06-06 13:24:33.194,Fix Minikube after previous changes to the Helm charts,"**As a** developer
<br>**I want to** run NLX on minikube again
<br>**so that** I can develop

**:white\_check\_mark: Acceptance criteria**

1.  NLX is running on minikube again

**:hammer\_and\_wrench: Proposed technical solution**

NLX is not working on minikube any more because minikube does not offer a LoadBalancer service type.

* Use Kubernetes internal DNS to redirect internal calls to internal service
",2
21562727,2019-06-04 10:16:34.252,Docs: wrong description --publish parameter,"In the docs https://docs.nlx.io/get-started/provide-an-api/ the description of the --publish parameter is wrong. 

`--publish 4443:4443 connects port 4443 on the host machine to port 443 inside the container. This way, we can send requests to the inway.`

should be

`--publish 4443:8443 connects port 4443 on the host machine to port 8443 inside the container. This way, we can send requests to the inway.`",1
21407059,2019-05-29 12:25:55.249,Change deployment flow,"**:white\_check\_mark: Acceptance criteria**

1.  Semantic release for every push on master
1.  Container release and deploy to test on every version tag
1.  Manual deploy step to deploy version to acc
1.  Manual deploy step to deploy version to prod, etc.",2
21405755,2019-05-29 11:44:19.723,Fix support e-mail,"**As a** user 
<br>**I want to** get support by sending e-mail to support@nlx.io
<br>**so that** it's easy to get support

---

Current solution with external mail provider forwarding to Gitlab servicedesk stopped working.

**:white\_check\_mark: Acceptance criteria**

1.  E-mail addressed to support@nlx.io ends up in Gitlab Servicedesk

**:hammer\_and\_wrench: Proposed technical solution**

*   Use TransIP e-mail",5
21402518,2019-05-29 11:02:56.151,Filterable log messages for nlx-components,"**As a** developer
<br>**I want to** have elasticsearch-readable log output on live environments
<br>**so that** I can filter through log individual log fields

**:white\_check\_mark: Acceptance criteria**

1. Logs outputted in JSON format for all NLX components

**:hammer\_and\_wrench: Proposed technical solution**

* Configure zap and logrus outputs to be json formatted",2
21398177,2019-05-29 09:01:36.555,Enhance visual link between overview and detail pane insight UI,"**As a** user of the Insight UI
<br>**I want to** see some visual indication that something changes in detail pane when selecting another row
<br>**so that** my attention is drawn to the detail pane

---

Currently it is hard to see that content of detail pane changes due high similarity of content in all records

**:white\_check\_mark: Acceptance criteria**

1.  Visual indication when content of detail pane changes after selecting another record

**:hammer\_and\_wrench: Proposed technical solution**

* Add visual indication using :hover :active and maybe a border

**:link: Reference links**

*",2
21215990,2019-05-23 10:34:39.956,Directory UI doesn't give correct feedback for API link,"**As a** user of the Insight UI
<br>**I want to** see some visual indication that url is copied
<br>**so that** I 

---

When hovering the icon to API url in directory UI, there is no indication to where it will lead.
Urgent because current UI gives no clue about what the user should do to use an API via NLX.

**:white\_check\_mark: Acceptance criteria**

1. When clicking the icon to API url in directory UI, there is feedback that the url is copied to clipboard

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*



![Screenshot_2019-05-23_at_12.28.00](/uploads/e22fc703d23bc24c2175b9d5ad89d298/Screenshot_2019-05-23_at_12.28.00.png)",3
20924840,2019-05-15 12:10:13.794,Create sequence diagrams for automatic onboarding w/ admin dashboard and certificate generation,"**As a** developer
<br>**I want to** have sequence diagrams on future systems
<br>**so that** I can understand their inner workings and work towards implementation

**:white\_check\_mark: Acceptance criteria**

1.  Sequence diagrams for onboarding with the admin dashboard and automatic certificate creation

**:hammer\_and\_wrench: Proposed technical solution**

* Sequence diagrams for goseq or websequencediagrams.com",8
20923841,2019-05-15 11:29:59.251,"Add ElasticSearch, LogStash, Kibana to get insight in NLX sys logs","**As an** NLX developer
<br>**I want to** have ELK stack to get great insight in NLX sys logs
<br>**so that** I can find and analyse errors in an efficient manner
<br>**and** we can solve #556 

**:white\_check\_mark: Acceptance criteria**

1. ELK (ElasticSearch, Logstash, Kibana) deployed on our own NLX environments
1. All standard output from NLX components can be written to ELK
1. We can search / analyse those logs with Kibana

**:hammer\_and\_wrench: Proposed technical solution**

* For now quick 'n dirty on non-persistent storage
* Will wait for Haven to add persistent storage

**:link: Reference links**

*",5
20914764,2019-05-15 07:31:15.180,Make `go` available in gitlab shell runners,"**As a** Developer
<br>**I want to** Have go available in $PATH in the gitlab shell runners
<br>**so that** golangci-lint can do it's job

**:white\_check\_mark: Acceptance criteria**

1.  This should be succeeding: https://gitlab.com/commonground/nlx/-/jobs/212261241

**:hammer\_and\_wrench: Proposed technical solution**

* Find out why the ansible role doesn't add go to PATH, or if it does, why golanci-lint doesn't have that same PATH. Then fix it.",2
20234701,2019-04-22 08:06:35.943,Create some initial sketches for the management-ui,"**As an** administrator
<br>**I want to** configure the NLX components in a fancy dashboard
<br>**so that** I don't need the CLI after the initial configuration

**:white\_check\_mark: Acceptance criteria**

1.  We have some initial sketches what the dashboard could look like
1.  These initial sketches are the basis for some initial UI work



Intial sketches can be found on https://sketch.cloud/s/7dDVY

![image](/uploads/d9066acfa7ef114a955ed6366684aef9/image.png)
![image](/uploads/c8a6d457c8201810f43eb55eeb70b51c/image.png)
![image](/uploads/545a6aa3be282daa88fd6871c8e7f19d/image.png)
",3
20202281,2019-04-19 15:50:13.181,Review app for NLX repo,"**As a** PO
<br>**I want to** be able to judge merge requests for frontend in Review App environments
<br>**so that** I don't have to run the full app locally to review and get a more realistic preview

**:white\_check\_mark: Acceptance criteria**

1.  Review app added in pipeline
1.  Merge requests with frontend impact spawn a temporary environment
1.  New flow is documented
1.  New flow is demonstrated and understood by the whole team

**:hammer\_and\_wrench: Proposed technical solution**

* Complication is that we use multiple namespaces for deployment of multiple (demo) organisations. Let's try and add multiple namespaces by Review app
* Loadbalancers are seriously complicated - so we will keep internal trafic inside cluster (no public IP)

**:link: Reference links**

*",8
20202241,2019-04-19 15:47:28.493,Renovate bot for NLX repo,"**As a** PO
<br>**I want** our repo dependencies to be automatically updated by Renovate Bot
<br>**so that** we are always up-to-date with minimal effort

---
Appears to be successful for DON repo, let's implement the same way for consistency

**:white\_check\_mark: Acceptance criteria**

1.  Renovate Bot proposes merge requests which are reviewed and merged manually.

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",1
20139950,2019-04-17 13:01:52.619,Implement log detail pane + pagination for the Insight UI,"**As a** 
<br>**I want to**
<br>**so that**

**:white\_check\_mark: Acceptance criteria**

1. Remaining functionalities from #506
1. Remove search logs functionality - we don't support search in the API

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",5
19969290,2019-04-11 14:24:30.305,Insight API endpoint /fetch returns incorrect content-type,"* URL  
`https://insight-api.test.voorbeeld-haarlem.nl/fetch`
* Response  
```
{""records"":[],""page"":0,""rowsPerPage"":0,""rowCount"":0}
```

**Expected**

Header `Content-Type` with `application/json` as value

**Actual**

Header `Content-Type` with `'text/plain; charset=utf-8` as value

**Add test!**",1
19967897,2019-04-11 13:48:12.761,Insight API endpoint /getDataSubjects returns incorrect content-type,"* URL  
`https://insight-api.test.voorbeeld-haarlem.nl/getDataSubjects`
* Response  
```
{""dataSubjects"":{""burgerservicenummer"":{""label"":""Burgerservicenummer""},""kenteken"":{""label"":""Kenteken""}}}
```

**Expected**

Header `Content-Type` with `application/json` as value

**Actual**

Header `Content-Type` with `'text/plain; charset=utf-8` as value

**Add tests!**",1
19768936,2019-04-05 13:07:17.436,Links in Navigation bar point to wrong environments,"**As a** visitor of NLX.io
<br>**I want to** use the menu in relation to the environment that I'm in
<br>**so that** I won't get confused by the wrong links 

--- 
Depends on move to Gatsby (#540)

**:white\_check\_mark: Acceptance criteria**

1.  When you are on https://docs.test.nlx.io/ and click on ""about"" you should always go to right environment 
1.  Should also work for review envs

**:hammer\_and\_wrench: Proposed technical solution**

*  Small Javascript using Environment Variables   (env.json)

**:link: Reference links**

* [Existing script in Insight UI](https://gitlab.com/commonground/nlx/blob/9f0a69d05577be62e407724ffcb17549d5d86fff/insight-ui/docker/startup.sh) to expose environment variables from the Docker container to the browser's `window.env`",2
19752959,2019-04-04 21:50:47.958,Consistent licence information,"**As a** PO
<br>**I want** it to be clear which licence is applicable to our code
<br>**so that** there can be no doubt about the license 

**:white\_check\_mark: Acceptance criteria**

1. Add individual licence statements to all code files
1. Make sure there is a licence defined in the root of the repository + README

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",2
19685059,2019-04-03 11:36:45.350,PoC: Administrator dashboard,"**As a** developer
<br>**I want to** have a PoC for the administrator dashboard
<br>**so that** we have a clear picture of what (and how) we want to build the dashboard

**:white\_check\_mark: Acceptance criteria**

1. PoC showing setting up an inway with a single command (docker run)
2. Provide documentation describing the setup

**:hammer\_and\_wrench: Proposed technical solution**

* 

**:link: Reference links**

* #429",13
19487741,2019-03-27 10:55:02.178,Provide technical CHANGELOG,"**As a** NLX user
<br>**I want to** see the changes between NLX versions
<br>**so that** I can foresee the upgrade path

**:white\_check\_mark: Acceptance criteria**

1. There should be a CHANGELOG available for NLX, automatically generated from commit logs
1. Instructions for devs, in contribution.md
1. Validated list of components and exact way to spell them (scopes)
1. Start with current version +1  (continue sequence)

**:hammer\_and\_wrench: Proposed technical solution**

* https://semantic-release.gitbook.io/semantic-release/

**:link: Reference links**

* https://gitlab.com/commonground/cg-design-system
* https://keepachangelog.com/en/1.0.0/

* TODO: setup gitlab token for semantic-release",3
19487053,2019-03-27 10:31:18.142,Make URLs in the context of NLX predictable,"**As a** NLX user
<br>**I want to** have predictable URLs in the context of NLX
<br>**so that** a service can offer APIs that provide linked data

Currently URLs in NLX are structured as:

```
http://{outway}/{organization-name}/{service-name}
```

This structure makes URLs in NLX unpredictable as `{outway}` is different in every organization.

With this story we want to support request URLs in the following format: 

```
http://{service-name}.{organization-name}.services.nlx.local
``` 

by adding functionality to the outway. This makes URLs in the context of NLX predictable.


**:desktop_computer: How to demonstrate**

1. Start an outway
1. Set `HTTP_PROXY` env variable to the address of the outway
1. Use curl to make a request to http://{service-name}.{organization-name}.services.nlx.local
1. The request should be received by {service-name} of {organization-name}
1. Use curl to make a request to {outwayaddress}/{origanization}/{service} 
1. The request should be received by {service-name} of {organization-name}

**:white\_check\_mark: Acceptance criteria**

1. The outway forwards requests to hosts with the TLD `.services.nlx.local` to the specific service on NLX.
1. `HTTP_PROXY` is used
1. New feature is described in docs

 
**:hammer\_and\_wrench: Possible technical solutions**

**:question: Open questions**

1. Do we want requests on NLX to be explicit (`*.*.nlx.local`)? Or should we allow internet-routable hostnames te be fetched over NLX implicitly through a SRV record in the public DNS (`*.org.nl`) as well? ->Yes we should allow internet-routable hostnames te be fetched over NLX as a follow up story
1. Should we route non-NLX requests through the outway as well? Possible idea's:
    - Yes, but with a log in the txlog
    - Yes, but we should forward non-NLX requests to an organization proxy

**:warning: Possible problems**

1. Organization names with spaces and dots are not usable when we switch to a hostname, so we should introduce hostname-friendly slugs.

**:link: Reference links**

* PoC #508
* WIP https://gitlab.com/commonground/nlx/nlx/merge_requests/376
* WIP https://gitlab.com/commonground/nlx/draw-io/-/blob/master/concepts/OutwayProxySetup.drawio

**:microphone: Request for feedback**

* Joost (Kadaster)
* @sergei-maertens 

**:hammer\_and\_wrench: Proposed sequence diagram**
![OutwayProxySetup-Page-4](/uploads/11619c74167a5170eb2b6a3103067e41/OutwayProxySetup-Page-4.png)
",8
19310031,2019-03-20 15:26:59.645,Update TTL for online services to 1 day,"**As a** 
<br>**I want to**
<br>**so that**

**:white\_check\_mark: Acceptance criteria**

1. Offline services are removed after 24 hours

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",1
19308961,2019-03-20 14:49:12.832,Add OAS specification for Outway Authorization,"**As a** 
<br>**I want to**
<br>**so that**

**:white\_check\_mark: Acceptance criteria**

1. OAS document API between outway and authz adapter/service

**:hammer\_and\_wrench: Proposed technical solution**

* Add spec file to repository
* Link redoc or similar in the readme/docs

**:link: Reference links**

*",3
19308937,2019-03-20 14:48:29.857,Add documentation for Outway Authorization,"**As a** 
<br>**I want to**
<br>**so that**

**:white\_check\_mark: Acceptance criteria**

1. Add document about outway autorisation to further reading
1. Questions by Amsterdam are addressed in the documentation

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",5
19288659,2019-03-20 12:34:24.827,Implement Outway Authorization based on PoC,"**As a** nlx-user 
<br>**I want to** configure my outway to use a authorization service 
<br>**so that** calls going through my outway are authorized

**:white\_check\_mark: Acceptance criteria**

1. Require TLS connection between outway and autorisation server
1. Let authz _acknowledge_ headers, instead of adding them

**:hammer\_and\_wrench: Proposed technical solution**

*  Based on Ronald PoC
",5
19087038,2019-03-13 21:45:27.985,Add instructions to use NLX with Docker for Windows,"**As a** Windows user
<br>**I want to** have instructions to get started
<br>**so that** I don't have to switch to Mac or Linux to use NLX

**:white\_check\_mark: Acceptance criteria**

1. The 'Get started' section should be compatible with Windows 10

**:hammer\_and\_wrench: Proposed technical solution**

* https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/
* https://www.vagrantup.com

**:link: Reference links**

* Documentatie van Berenschot: [Documentatie_050819.docx](/uploads/4138559d709720f7835eef34fa49b1d7/Documentatie_050819.docx)",5
18806368,2019-03-05 12:28:04.989,Add debug statements to inway registration,"Discussed in standup, add debug statements to inway registration, which is problematic for some users.",1
18709382,2019-03-01 09:33:43.491,Add TLS between client and outway,"**As an** nlx-user
<br>**I want to** secure traffic between my application and the outway
<br>**so that** nobody can snoop my data

**:white\_check\_mark: Acceptance criteria**

1. Outway can be configured with a self-signed certificate
1. Outway supports TLS connections from clients, TLS v1.2 and up
1. Outway requires the usage of TLS

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",5
18649015,2019-02-27 14:57:23.436,[PoC] outway proxy,"**As a** NLX developer
<br>**I want to** know if the outway proxy design is feasible
<br>**so that** I can improve the design and work towards a new way of handling requests over NLX

**:white\_check\_mark: Acceptance criteria**

1.  Outway handles traffic using HTTP_PROXY setup

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",8
18643323,2019-02-27 11:54:45.124,Implement Insight design,"**As a** user
<br>**I want to** use a consistent and future proof ui
<br>**so that** I have a reliable user experience.

**:white\_check\_mark: Acceptance criteria**

1. Implement design (landing, scan, logs, wizard) scoped to design link
1. Create generic components when applicable (add to design system)
1. Design is not optimized for mobile but the content should accessible
1. Current dependencies should be removed (base.css, MaterialUI & jQuery) should be removed
1. Implement using `styled-components`

**:link: Reference links**

Design: https://sketch.cloud/s/wxR9w/p/insight",8
18326373,2019-02-18 14:39:05.827,Inway: use assert package in go tests,"**As a** developer
<br>**I want to** use `""github.com/stretchr/testify/assert""` to do my assertions  
<br>**so that** I conform myself to the go standard

**:white\_check\_mark: Acceptance criteria**

1. 

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",2
18321596,2019-02-18 12:40:42.383,[PoC] Authentication service for the outway,"**As a** NLX user
<br>**I want to** configure my own authentication service to be used by the outway
<br>**so that** requests made through my outway are authenticated.

**:white\_check\_mark: Acceptance criteria**

1.  Authentication service definition in gRPC
1.  Authentication service is configurable on the outway
1.  When a authentication service is configured each request to the outway will be verified using the configured service.  
1.  Outway logs user-specific headers set by the authentication service.
1.  Outway strips user-specific headers before sending it to the inway of a service that is not within the organization of the outway.
1.  Reference implementation of the authentication service based on hardcoded users.
1.  NO docs / NO unit tests

**:hammer\_and\_wrench: Proposed technical solution**

* Outway sends authentication request to the authentication service containing:

  * Destination organization
  * Destination service
  * Request path
  * The contents of `X-NLX-Authentication` header (arbitrary text)
  * Transactionlog id (generated by the outway)

* Authentication service decides whether the request may continue, and optionally provides values that the outway can set onto the outgoing request for the fields:

  * `X-NLX-Requester-User`
  * `X-NLX-Requester-Claims`

**:link: Reference links**

* nlx/design/authentication-within-organizations.md",13
18300796,2019-02-17 18:22:50.068,Draw NLX in typical infrastructures of gov organisations,"**As an** infrastructure manager
<br>**I want to** know how NLX fits in typical infra architectures
<br>**so that** I can decide to integrate NLX in my organisation

**:white\_check\_mark: Acceptance criteria**

1. At least three different, typical infrastructure overviews with NLX implemented
1. Created in Archimate

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",3
18259252,2019-02-15 08:43:25.068,Exclude TLS v1.2 support,"**As a** Architect 
<br>**I want to** use TLS version v1.3 and exclude v1.2
<br>**so that** NLX works faster, is more secure and complies with the advice of the Forum Standardisation (https://www.forumstandaardisatie.nl/sites/bfs/files/FS%20181010.3A%20Forumadvies%20TLS%201.3.pdf)

**:white\_check\_mark: Acceptance criteria**

1. All inter-nlx components : minimum TLS v1.3
1. `Client -> Outway` & `Inway -> API` : minimum TLS v1.2  
1. Exclude unsafe cyphers for v1.2
    
**:hammer\_and\_wrench: Proposed technical solution**

* exclude TLS v1.2 support and heb exclude the following ciphers:
- TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)   ECDH x25519 (eq. 3072 bits RSA)
- TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)   ECDH x25519 (eq. 3072 bits RSA)
- TLS_RSA_WITH_AES_128_GCM_SHA256 (0x9c)
- TLS_RSA_WITH_AES_256_GCM_SHA384 (0x9d)
- TLS_RSA_WITH_AES_128_CBC_SHA (0x2f)
- TLS_RSA_WITH_AES_256_CBC_SHA (0x35)  
- TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA (0xc012)   ECDH x25519 (eq. 3072 bits RSA) 
- TLS_RSA_WITH_3DES_EDE_CBC_SHA (0xa)   

**:link: Reference links**

* https://www.forumstandaardisatie.nl/standaard/tls
* https://www.forumstandaardisatie.nl/sites/bfs/files/FS%20181010.3A%20Forumadvies%20TLS%201.3.pdf

**QUESTIONS:**  
- can we update to 1.3 without causing failures in the current eco system?  
   *yes, see: https://gitlab.com/commonground/nlx/nlx/-/issues/492#note_363856136*",2
18126684,2019-02-11 09:37:29.373,Version numbers shown in FE applications,"**As a** user
<br>**I want to** see which version is running when opening one of the NLX apps
<br>**so that** I don't work under the wrong assumption

**:white\_check\_mark: Acceptance criteria**

1. Version number & commit hash is visible for txlog-ui, directory-ui and insights-ui in javascript console (table).
1. Use https://directory.demo.nlx.io/version.json
",2
18066788,2019-02-08 09:23:59.283,Inway: compare SELF_ADDRESS with certificate domain,"**As a** NLX user
<br>**I want to**  prevent an inway to start when a mismatch exists between self_adddress and certificate
<br>**So that** I cannot config an inway which will never be available

**:white\_check\_mark: Acceptance criteria**

1. Inway prints a error message when there is a mismatch between `SELF_ADDRESS` and certificate
1. the inway fails during start

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",2
18007218,2019-02-06 13:29:29.300,Version numbers shown in containers,"**As a** user
<br>**I want to** see which version is running when starting a NLX container
<br>**so that** I don't work under the wrong assumption

**:white\_check\_mark: Acceptance criteria**

1. Version number & commit hash is available in every image (inway, outway, insight-api, tx-api, txlog-api, directory-inspection-api, directory-registration-api, directory-ui, insight-ui, txlog-ui)
1. Version number & commit hash is shown in terminal when starting one of the above containers
1. This information should be added for every commit

**:link: Reference links**

* Frontend part is described in #486
* Related to #460",3
17963124,2019-02-05 10:35:09.670,Api point url and api response in the API documentation are difficult to read (increase contrast),"**As a** API user
<br>**I want to** be able to easily read api point url and response example
<br>**So that** I can understand API requirements

**:white\_check\_mark: Acceptance criteria**

1.  The api point url and the response are easy to read

**:hammer\_and\_wrench: Proposed technical solution**

- See if we can get the styling to work as default: http://rebilly.github.io/ReDoc/#operation/updatePetWithForm
- Could be that there is still custom styling overrides active.
- If above doesn't work, change text color to black


**:link: Reference links**

*  https://directory.demo.nlx.io/documentation/Enable-U/DemoService#operation/callStockDilutionUsingGET

![image](/uploads/fa37b837a4635e2a0a49397c710c7c47/image.png)",2
17915004,2019-02-03 10:31:33.024,Ensure high availability (HA) for all environments,"**As a** dev, ops
<br>**I want to** have access to a highly available central services
<br>**So that** I can sleep at night

**:white\_check\_mark: Acceptance criteria**

1. Increase replica count in k8s deployment for all central services

**:hammer\_and\_wrench: Proposed technical solution**

* Use LBaaS feature of Fuga R2 (as mentioned by @GeertJohan in the comments)

**:link: Reference links**

*",2
17886001,2019-02-01 12:39:10.363,Document how to use the log level parameter for inway and outway,"**As a** NLX user
<br>**I want to** know how I can set the log level of a inway and/or outway
<br>**So that** I can debug my inway/outway

**:white\_check\_mark: Acceptance criteria**

1.  The LOG_LEVEL environment variable is described in the docs (startup guide)
1. Update:  

* https://docs.nlx.io/try-nlx/management/getting-up-and-running
* https://docs.nlx.io/try-nlx/management/consume-an-api
* https://docs.nlx.io/try-nlx/management/provide-an-api
* https://docs.nlx.io/try-nlx/config-file/consume-an-api
* https://docs.nlx.io/try-nlx/config-file/provide-an-api",1
17813697,2019-01-30 15:09:11.935,Evaluate access rights for repo changes,"**As PO** 
<br>**I want to make sure access rights for all nlx repos are ""least privilege""**
<br>**so that only intended people can alter our production namespace**

**:white\_check\_mark: Acceptance criteria**

1.  Changes in infra on namespace / node level are reserved for ops specialists
2.  Changes to core components are reserved for maintainers and owners
3.  Proposal in slack

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",2
17810224,2019-01-30 13:16:50.182,Sort logs latest first,"**:pencil2: Description**

**As a user of the Insight app** 
<br>**I want to see the newest log entries first**
<br>**so that I don't have to click to the last page to see that what I just came for**

**:white\_check\_mark: Acceptance criteria**

1. Logs should be sorted descending by the `created` property

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

*",1
17804133,2019-01-30 09:57:18.858,Implement directory design,"**As a** nlx user 
<br>**I want** a future proof directory
<br>**So that** I will keep using it

**:white\_check\_mark: Acceptance criteria**

1. Implement [design](https://sketch.cloud/s/wxR9w)
1. Create generic components when applicable
1. Design is not optimized for mobile but the content should accessible
1. Current dependencies should  be removed (base.css, MaterialUI & jQuery) should be removed
1. Implement using `styled-components`

**:link: Reference links**

* https://sketch.cloud/s/wxR9w",8
17567606,2019-01-22 14:47:36.251,Add inway version feedback to the health check for directory-monitor,"Helpful to know which version of inway is running, this can be added to the health check exchange",2
17481315,2019-01-18 20:57:55.436,insight-api: add the ability to configure certificates and https,"**:pencil2: Description**

**As a** nlx-user

**I want to** use https on the insight-api

**So that** my data is secure
",2
17481062,2019-01-18 20:47:25.838,Make sure the Insight app unregisters old service workers automatically,"Bugreport: Old service worker in insight app causes app to load with blank screen
- When loading the insight app (https://insight.demo.nlx.io/) in Chrome, I get a blank screen and a few errors.
- Inspection showed that there was an old service worker still active, somehow causing the app startup to fail.
- After manually unregistering the service worker, the app worked as expected.

Proposed solution: Make sure the Insight app unregisters old service workers automatically

![Screenshot_2019-01-18_at_21.39.14](/uploads/0d7fa5bd1759c4d98c31a4e4241b9f02/Screenshot_2019-01-18_at_21.39.14.png)

![Screenshot_2019-01-18_at_21.39.23](/uploads/1dbbead0099b21686ad75a836491a308/Screenshot_2019-01-18_at_21.39.23.png)

![Screenshot_2019-01-18_at_21.39.46](/uploads/3a7e17c51fb3660315fd0b4911314b09/Screenshot_2019-01-18_at_21.39.46.png)",1
17465656,2019-01-18 13:50:55.355,Cleanup offline services in directory after 14 days,"**:pencil2: Description**

**As a** NLX user

**I want to** have an overview of active services on the directory ui

**So that** I know which services I can rely on

**:white\_check\_mark: Acceptance criteria**

1. Directory should clean up inways that are offline for 14 days
1. This period should be reflected in the docs
1. The 'cleanup threshold' should be configurable when starting the directory container

**:hammer\_and\_wrench: Proposed technical solution**

* Store the  'last online time' per service in the database
",3
17465242,2019-01-18 13:32:42.332,Add contact details to service config,"Add contact details to service configuration.

Perhaps two e-mail addresses would suffice:

* tech   (for questions from NLX management, this one is not public)
* public (for questions from NLX end users to other end users, which is published in directory UI)

Can be optional, so non-breaking (for now).

Tasks:

* Create design
* Update database
* Update directory registration/inspection API
* Update inway
* Update documentation
* Implement design


**Design**
<br>https://sketch.cloud/s/wxR9w/p/directory
- Ignore the telephone number (depiction of possible extra contact info in the future).
- Ignore other design changes in directory, this will be applied in a different ticket.",1
17400630,2019-01-16 18:21:01.279,Fix font in svg used in docs,"https://docs.test.nlx.io   

On Safari/MacOS the text is shown in wrong font

![Screenshot_2019-01-03_at_19.37.19](/uploads/4a6c79df7a2c04f1ec401950aa6f4a72/Screenshot_2019-01-03_at_19.37.19.png)",1
17387151,2019-01-16 11:30:10.109,Move marketing site nlx.io from Github to Gitlab,"**:pencil2: Description**

**As a** developer

**I want to** have all NLX related code available on GitLab

**So that** development is easier

**:white\_check\_mark: Acceptance criteria**

1. The CI / CD pipeline should be configured on GitLab
1. The commit history should not be preserved
1. Deployment should be available on `nlx.io`
1. Deployment is only for PROD. Other environments will be configured as part of another story.

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* https://github.com/VNG-Realisatie/nlx.io 
* https://gitlab.com/commonground",3
17386890,2019-01-16 11:20:51.923,Design a versioning policy,"**As a** customer
<br>**I want** to know what the version policy of NLX is
<br>**so that** I know what measures to take for internal maintenance policy

**:white\_check\_mark: Acceptance criteria**

1.  We have a page in our documentation that describes how we release and what we expect from system administrators.
1.  We have internal documentation that describes how we handle breaking changes and our version skew policy.

 **:link: Reference links**

- [X-Road](https://confluence.niis.org/display/XRDKB/Release+Notes) uses a simple semantic version system, also documented in more detail [here](https://github.com/nordic-institute/X-Road-development/blob/master/DEVELOPMENT_MODEL.md#34-publish). In Finland they recommend their production users to update within four weeks after the central server has been updated.
- [Chrome](https://www.chromium.org/getting-involved/dev-channel), has release channels
- [Google Kubernetes Engine](https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels), has release channels
- [NodeJS releases](https://nodejs.org/en/about/releases/), uses semantic versioning with LTS
- [Ember.js releases](https://emberjs.com/releases/), uses semantic versioning with LTS",3
17386516,2019-01-16 11:10:23.806,Make Docs navigation structure clearer,"- Improve styling so that subpages are more distinguished (indent).


![Screenshot_2019-01-16_at_12.10.29](/uploads/35d08d32f8fb1d91ff8727d4a1a312ef/Screenshot_2019-01-16_at_12.10.29.png)",1
17385941,2019-01-16 10:54:05.775,Add info logging to the inway,"As a user who is configuring a inway I would like to see logging of the inway so I can debug issues which I may have during implementation.  

Log:
*  Certificates loaded.
*  Calls to the directory.
*  Service-config being loaded.
*  Calls coming from a outway.


Acceptance criteria:

- More verbose logging of NLX components (status logs etc.)

- Logging is easily obtainable through for example `tail -f`

- The documentation describes how to view logs
",2
17385932,2019-01-16 10:53:52.989,Add info logging to the outway,"As a user who is configuring a outway I would like to see logging of the outway so I can debug issues which I may have during implementation.  

Log:
*  Certificates loaded
*  Calls to the directory
*  Calls made to the outway

Acceptance criteria:

- More verbose logging of NLX components (status logs etc.)

- Logging is easily obtainable through for example `tail -f`

- The documentation describes how to view logs",2
17385866,2019-01-16 10:51:29.162,Add Getting started guide to docs.nlx.io,"Getting Started contains the following steps:
- Preparing
- Certificates
- Using a service
- Start an outway
- Providing a service
- Start an inway
- Transactionlogs

Create example based on Docker Compose.
Reuse docker compose.yml made by @RonaldKoster 

As a Getting Started (walkthrough) with parts, like: https://docs.docker.com/get-started/

Every part needs a verification step (check if your action went well).",8
17385780,2019-01-16 10:49:11.567,Write docs on how to setup transaction logs,"- https://docs.nlx.io/transactionlogs/ is filled with documentation
- Add links to transaction log setup docs on start an inway and start an outway pages (--env DISABLE_LOGDB=1)",5
17385413,2019-01-16 10:37:16.493,Update documentation based on user feedback,"
Check where this information needs to be added in the docs and 
update the documentation to make it clear that:

- An outway is needed to contact an inway.
- How to mitigate problems with containers that are tagged with :latest.
- How to check if your inway/outway is running.
- The directory exists and that the services offered by an inway can be published in the directory.
- The directory can be used to check if a service is online.
- That localhost on a docker container does not resolve to the hostmachine.",3
17253373,2019-01-10 23:48:32.268,Add link to public demo on front page,"Add a link to demo.nlx.io somewhere on the nlx.io front page, possibly drawing some attention to it",1
17206145,2019-01-09 14:04:13.227,Upgrade IRMA-api-server,"As communicated by IRMA, in their step to moving to a new IRMA api server implementation, they are releasing an update to the current one. We need to stay up to date. See the communication:

1. Update the IRMA api server and release to production/demo BEFORE 31 jan 2019
2. Report to Sietse that we have updated

```
Dear everyone,

I am mailing to everyone I know that runs or is otherwise interested in the irma_api_server, https://github.com/privacybydesign/irma_api_server. This email is about the future of the irma_api_server, its upcoming replacement in Go, and also about future emails like these.

Let me start with something to do:
*Please update your irma_api_server to the latest version as soon as possible, but at least before January 31.*
Otherwise, your irma_api_server will be incompatible with an upcoming version of the IRMA app, that we will release at that time. The reason is explained below.

1) The eventual deprecation and replacement of the irma_api_server
The irma_api_server has been very useful and important for the IRMA ecosystem, but it has its drawbacks; it is not very flexible, or easy to configure, or easy to experiment with. Ever since we switched to the Go programming language for the IRMA app, we have been planning to eventually completely switch to Go. Therefore, we have been working on a new IRMA server in Go, that will eventually replace and deprecate the irma_api_server. This new server has been designed to be:
- Easy to deploy and use in a multitude of environments and use cases,
- Simple to configure and easy to experiment with,
- More efficient and scalable across server farms,
- more easy to automatically test using CI/CD.
Additionally, the new irmaserver improves legacy issues, fixes shortcomings, and improves efficiency in the protocol that it uses when issuing or verifying attributes from IRMA apps. It will be released as a library for use in backend server applications, as well as a standalone server like the irma_api_server. This new server (simply called ""irmaserver"") will be mostly compatible with the current irma_api_server. Not entirely, but when the new irmaserver is released we will simultaneously release an update of irma_js that will abstract away the differences for you as much as possible.

2) End of life of the irma_api_server
In the migration to the new irmaserver there needs to be a compatibility mechanism that ensures that all IRMA apps works with both the new irmaserver and the old irma_api_server.  In order not to pollute the new server with legacy code, we have decided to implement this compatibility mechanism in the irma_api_server, with an update adding compatibility with the upcoming version of the IRMA app, which will be released on February 1. After that, irma_api_servers that have not yet been updated will become incompatible with the latest version of  the IRMA app. This is why it is necessary that all irma_api_servers are updated. *Once your server is updated, please let me know.*
After the update introducing compatibility with both the old and the new upcoming versions of the IRMA app, the irma_api_server will no longer be actively developed, apart from bug fixes and security updates. The new irmaserver will be released soon after that.

3) Future mails like these
IRMA is, by design, a decentral system: anyone can run IRMA servers without involvement of us (the Foundation). This is an important and distinguishing feature contributing to IRMA's trustworthiness, but it also means we (the Foundation) have no way to automatically update all IRMA infrastructure. Although we of course try to prevent making breaking changes, sometimes this is unavoidable. We have to prevent that this leads to a fractured IRMA ecosystem with incompatible apps and servers, which would lead to bad user experience and hurt adoption.
As an alternative update channel, we will henceforth sometimes send emails like this one. The release of the upcoming irmaserver will be announced like this too. If you do *not* want to receive these emails please let me know, but in order to keep the IRMA experience for users as stable and reliable as possible, *we strongly recommend anyone running an irma_api_server, or the new irmaserver after it has been released, to stay on this list*. If you know anyone who you think should receive these emails as well, please let me know.

Kind regards,
Sietse Ringers.
```",1
17064595,2019-01-03 19:21:02.010,Clarify current situation of environments and targets audiences (with visual),"- Create clear description of current target audiences, environments
- Markdown file available on gitlab
- Relevant visuals available
- Clear name & versioning convention incl url
- Show how this relates to build/deploy pipelines
- Plan how to communicate to target audiences

NLX devs have their own flow with several public environments, next to the public environments ment for demo, pre prod and production.

It helps to clarify which is which, including some visual that shows flow for audiences.

Rough sketch  (won't be accurate in current form, but exactly that is the problem - needs clarification)
![Screenshot_2019-01-03_at_20.11.02](/uploads/4d1b5305a9ac627a9fd99dd9ef8c8e0e/Screenshot_2019-01-03_at_20.11.02.png)",5
16795049,2018-12-19 16:22:52.620,Update gitlab runner go version to 1.11.4,"We want to keep using golang:1-alpine in our docker images because we don't want miss any security updates. The latest version of go currently is 1.11.4. and this version produces different hashes as previous versions when running go mod tidy. Because of this our gitlab runner will not pass go.mod.tidy test.  

We need to update our git lab runner to use go version 1.11.4 so we can keep using golang:1-alpine in our docker images",1
16658034,2018-12-14 10:43:09.705,Create an business overview of 'how to start with NLX',"**As a** Business representative
<br>**I want to** have a business overview of NLX
<br>**So that** I can asses what I need to implement NLX and what the business benefits are after implementing NLX.
<br>*NLX documentation so far is clear for (most) developers. What i see is that almost every municipality that is interested in connecting with NLX is searching for a functional (business) overview of 'how to start with NLX?'.
In most municipalities they have to start a project and need to find a budget before they can start (...). So the business needs to understand it first, before some technical people will make a start. For Business people/management the current documentation is not sufficient.*

**:white\_check\_mark: Acceptance criteria**

**The Business overview is available on https://docs.nlx.io/ and makes clear:**
1. What kind of people do i need (what kind of knowledge is required)?
2. What environment(s) do i need?
3. What kind of tools/functionaly do i need in my municipality to connect with NLX?
4. What will be the investment?
5. How much time is estimated for a first connection, a PoC?
6. Which connections are easy tot start with?
7. Acceptance of the business overview by @dennisdewit! 
8. What the business benefits are after implementing NLX!

**:hammer\_and\_wrench: Proposed technical solution**

* business overview document in Markdown
* overview in public available Archimate model

**:link: Reference links**

* https://docs.nlx.io/
* 
",8
16586569,2018-12-11 22:36:04.775,Bump dependency due to CVE,"Dependency with high severity [CVE-2018-16469](https://nvd.nist.gov/vuln/detail/CVE-2018-16469)

Package merge
Vulnerable versions: < 1.2.1
Patched version: 1.2.1

https://gitlab.com/commonground/nlx/blob/master/txlog-ui/package-lock.json#L3980
https://gitlab.com/commonground/nlx/blob/master/txlog-ui/package-lock.json#L7022",1
16329263,2018-12-04 23:55:30.161,Front page nlx.io text layout breaks,"See attached screenshot
![Screenshot_2018-12-05_at_00.53.08](/uploads/9295cb96b3b763c648505a94abd6579f/Screenshot_2018-12-05_at_00.53.08.png)

MacOS 10.14, Safari 12.0",1
16286663,2018-12-03 12:45:44.835,Insight-ui RDW backend demo api returns 500,"Possible solutions:

1. In depth configuration Check @GeertJohan [timebox 3 uur]
2. Get rid of navigation item & long term solution by IRMA team [1 point]

After selecting rdw from the list and scanning QRCode the api call to RDW getproof api point returns 500.

api url (jwt from this sample will expire)
https://irma-api.demo.voorbeeld-rdw.nl/api/v2/verification/jZpQZz9AmUqMSeB5GTZDZIpBfp4iMscKtgNvVTyAo6nW/getproof

response received: {
    ""error"": ""EXCEPTION"",
    ""status"": 500,
    ""description"": ""Encountered unexpected problem"",
    ""message"": ""io.jsonwebtoken.SignatureException: Unable to calculate signature using RSA PrivateKey. Could not sign data""
}

![image](/uploads/160f0eb311515d99bf5c4b765a750b98/image.png)",1
73524801,2020-10-28 14:29:44.777,Add all available service data from API to NLX management directory,"Show all date we have in the directory detail drawer.
- Button to documentation
- Button to specification
- Support addresses
- Flip the status and API type below the title. Status first, then API type (because there is not always an API type to be shown)
- Note: the inline error alert is positioned above the buttons.


**Acceptatie criteria**

1. All data from API result is placed on detail pane as specified in attached design
1. Icon on docs en specs  button is smaller than normal


![image](/uploads/18da4517c8f12f0455522a4111a9cc59/image.png)
![image](/uploads/8ce8b04f17b202ef897f8d262233248a/image.png)",2
73524613,2020-10-28 14:27:26.746,Styled dropdown in settings,"We use a select component in the settings, but it is without (dark mode) styling. See:

![image](/uploads/5aa0a96adf562ca127e7a6f1b3c8bbcb/image.png)

We have a styled react-select component in the appstore, but it is not in de design system yet. <br>
![image](/uploads/071b94a8cbb741011796cc630f07681e/image.png)


**Acceptance criteria**


1. Make component available (from appstore) in design system
1. White dropdown on settings page replaced with the new component",3
73524516,2020-10-28 14:26:00.170,Empty states for collapsibles,"The empty states within collapsibles are in regular texts right now. This should be in `<small>` text, to make it visually clear that it is not content.<br> Also, the text has a hover and active state, but it is not clickable. It should not have any interaction states.

**Acceptance criteria**

1. All empty states styled as empty states

Current situation:<br>
![image](/uploads/2e7f0f37efebb748ae2f2eadd5a47ebb/image.png)
![image](/uploads/0a9542ecfab89e7b8299c92dd425dd8c/image.png)

Design:<br>
![image](/uploads/7cbc4d48b2b1cd2e75f04a280b3356a4/image.png)",1
73524426,2020-10-28 14:24:26.244,Move settings menu item below,"The settings menu item should be secundair, shown at the bottom.<br>
Note: there is a spacing of `1rem` between the bottom of the navigation and the lowest menu item.

![Navbar_Copy](/uploads/bdb071f4c4b8cce559d596f9732ea4e7/Navbar_Copy.png)
![image](/uploads/81bf2254e0bc6691439a78789c904aa6/image.png)",1
73463444,2020-10-27 15:08:51.331,Make sure UI represents actual state after actions,"**As a** _user_
<br>**I want** the UI to automatically update after an action
<br>**so** I don't have to manually refresh or open the service detail to see the actual state

Actions:

- request access
- approve access request
- reject access request
- retry access request after fail
- revoke access

-- 
Out of scope: updating list of orgs with access after granting access


**:desktop_computer: How to demonstrate / e2e test(s):**

1. 

**:white\_check\_mark: Acceptance criteria**

1. After actions listed above, show new state in frontend


**:link: Reference links**

1.

**Implementation**

- API's should give new state as result on the call",3
72977264,2020-10-19 18:30:47.371,Combine inspection and registration API into directory API,"**As a** maintainer
<br>**I want** to combine inspection and registration API into one new directory API
<br>**so** that the whole setup becomes more easy to understand and less work to maintain 

**:white\_check\_mark: Acceptance criteria**

1. Inspection and registration API combined into new directory API
1. This should not be breaking
1. Add deprecation warning to the directory registration api URL and directory inspection api URL flags both will be replace by a single directory API url
1. Reuse a fixed IP of the registration/inspection API for the combined directory API so that the existing firewalls rules still work.
1. Update the IP reference information on docs.nlx.io


**:link: Reference links**

1.",13
72972891,2020-10-19 16:39:13.521,Proxy browser traffic to Mngt API through Mngt UI,"**As a** sysadmin
<br>**I want** to easily setup NLX Management
<br>**so** that I cannot make any mistakes and save some time

**:white\_check\_mark: Acceptance criteria**

1. Connection from browser (via LB) to Management API is no longer needed / possible
1. Remove nginx config
1. Setup go project
1. Use go static file server
1. Setup reverse proxy fpr /api /oidc
1. html/css/js are embeded in the executable. Serve actual files when developing
1. build go binary in docker file
1. update helm chart

**:tools: Technical implementation**

- Management UI changes from Nginx to Go server with html/css/js
- Requests from browser to Management API goes through Management UI

IST:
![Screenshot_2020-10-19_at_18.41.49](/uploads/9eb6ec5d0ab06e7bfbe2ef12209ef600/Screenshot_2020-10-19_at_18.41.49.png)

SOLL:
![Screenshot_2020-10-19_at_18.42.11](/uploads/be86a7324c6bb50f42c91ce284967147/Screenshot_2020-10-19_at_18.42.11.png)



**:link: Reference links**

1.",5
72960224,2020-10-19 13:07:55.312,Migration to Postgres DB from ETCD,"**As a** developer
<br>**I want** to use a database type which is more suited for NLX management
<br>**so** that efficiency is increased

Currently we use an ETCD database. As the feature list of NLX management becomes more complete we are realsing that ETCD, which is a key value database, might not be the right choice. Objects like services, access requests, access grants are tightly related to eachother and storing these objects in a key value database is making less and less sense.

Replacing the key value database with a relational database seems like the right choice. 

With a relational database we can:

* easily retrieve related objects adn therefore greatly simplify the management API codebase
* improve data integrity


**:desktop_computer: How to demonstrate / e2e test(s):**

1. 

**:white\_check\_mark: Acceptance criteria**

1. Support for SQL type databases (mysql, msql, postgres), avoid database specific functionality.
1. ETCD database is replaced by postgress
1. Management API executable can do it's own migrations
1. Support for TLS on database connection 
1. User GORM as ORM (https://gorm.io/)
1. Support SQLite for development

Implementation

1. Use migrate (https://github.com/golang-migrate) for migrations
1. Migration is embeded in the management API  


Technical implementation

1. Start management API with `serve` command to serve API 
1. Start management API with `migrate` command to do migrations


Tasks:

1. [x] Create datamodel
1. [x] Create migrations
1. [x] Update helm charts / deployments
1. [x] Update documentation
1. [x] Implement running migrations using the binary
1. [x] Package migration files into the binary 
1. [x] Implement GORM in management-api
1. [x] Solve access request locking with new database
1. [x] Check which GRPC calls require DB transactions
1. [ ] Use SQLite for testing
1. [ ] Clean demo environment (volume claims, tokens, secrets)

**:link: Reference links**

1.",20
72850332,2020-10-16 17:56:33.674,Shine: add logout icon to menu,"Add a small icon to the 'logout' menu option, as shown here:

https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/exY0lq",1
72710166,2020-10-14 12:15:00.961,Show different counter when there are 0 access request,"When there are 0 access request, the regular counter can be shown in the collapsible. <br>
Only show the notification bubble counter when there is 1 access request or more.<br>
See designs attached.


![Group_110](/uploads/8f1484c0fdd470924beb96199e038f4c/Group_110.png)",1
72708387,2020-10-14 11:51:38.796,Display warning when no organisation inway is selected,"**As an** provider of services
<br>**I want** a very annoying and clear warning when I do not have an inway selected to receive incoming access requests
<br>**so** that requesting organisations can submit their access requests

**:desktop_computer: How to demonstrate / e2e test(s):**

1. 

**:white\_check\_mark: Acceptance criteria**

1. On starting the application: when an organisation offers at least one service and does not have an organisation inway configured, a system warning should be shown on every page.
1. Check if the banner should still be visible: when updating the organization inway, when update/add/remove a service.

Note: we will need to update this logic when we implement delegation

**:link: Reference links**

1.

**:unicorn: Design proposal**
- Non dismissible banner on top (as part of the header?)
- Visible on all pages
- Stays until an organization inway is chosen
- The link goes to the settings page
- NLX management specific component
<br><br>Old design:<br>[/uploads/2c34ae5b9a4e00c0d3fe7149a4e0b898/Banner.png]()
<br><br>New design:<br>![Artboard_Copy](/uploads/8c3b09701a3da5b50c9e1c0cd1f9b4e0/Artboard_Copy.png)",3
72704486,2020-10-14 10:56:24.415,"After revoked access grant, new request  should be possible","**As a** user of a requesting organisation
<br>**I want** to be able to request access again after my access is revoked
<br>**so** that I can retry after I've fixed the reason over which my access was revoked

Currently, when org B revokes access to a service, org A  cannot request access again.
This is even worse since the UI behaves as if you can request access, although the flow won't work.


**:white\_check\_mark: Acceptance criteria**

1. After access to a service is revoked, a new request for access to that same service can be made


**Implementation**

1. Access request state has to be in sync on both sides, this requires a poll mechanism that polls until resolved
1. After access granted, this grant needs to be exchanged and stored on requesting side


**:link: Reference links**

1.![Toegang_ingetrokken](/uploads/f0f66a2ab2d9a5666ede814f01a18adf/Toegang_ingetrokken.png)

![Toegang_ingetrokken_directory](/uploads/049c2380f0386eaad36534b91cafb736/Toegang_ingetrokken_directory.png)

### Insights and TODO's

A `service` has `latestAccessRequest` and `latestAccessProof`. When access has been rejected, the access proof will get a `revokedAt` property.  
This would make it possible for us to show a ""Request access"" button to create a new access request.

However, if a new access request is created, the `latestAccessProof` is still there. We need it to be there to display the right data, but it makes it difficult to show the state of the **new** access request.

We cannot compare the `revokedAt` date with the `createdAt` date of the new access request, because these dates are created by different clocks (systems).

- [ ] Therefore (and maybe other reasons) we need to set a `accessRequestId` prop on the `accessProof` object.
- [ ] Then we can update the frontend (`directoryServiceAccessState`) to show the correct things on screen.",5
72634647,2020-10-13 10:43:13.363,Set the new 'permissions' policy header,"**As a** sysadmin
<br>**I want** the NLX frontend to have complete security headers
<br>**so** that our hygiene is tip top

Set the 'permissions' header in all our frontends.
More important for public frontends than the Management UI

We do not allow anything. All permissions disallowed.

**:white\_check\_mark: Acceptance criteria**

1. Headers set

**:link: Reference links**

1. https://scotthelme.co.uk/goodbye-feature-policy-and-hello-permissions-policy/",2
72256934,2020-10-06 13:12:48.186,"Toaster ""in"" animation broken in nlx","*Expected behaviour*

toaster should slide in from the right

*Actual behaviour*

toaster just appears

**:clipboard: Steps to reproduce**

1. add/edit a service and submit
1. toaster should become visible as described in ""expected behaviour""

**:mag: Details**

Not an issue in DS itself

---",2
71938119,2020-09-30 11:40:32.657,Enable insight UI configuration when using NLX Management,"**As a** beheerder
<br>**I want** to be able to use the insight UI when using NLX Management
<br>**so**

This is part of #1024. Before working on this, discuss with FE, BE & designer how we will solve this.

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

* The NLX Management should be sufficient to setup an environment to give the 'official NLX demo' (parkeervergunningen app), without having to use `nlxctl`

**Settings to be added to the NLX Management settings page**

- InsightAPIURL
- IrmaAPIURL

**:link: Reference links**

1.",3
71861043,2020-09-29 09:40:24.979,Retry a failed access request,"**As a** nlx management user
<br>**I want** to be able to retry a failed access request
<br>**so** that I do not get stuck in a dead lock

![Screenshot_2020-09-29_at_11.35.21](/uploads/f446b06497cebe671abaf96d3f2f2f88/Screenshot_2020-09-29_at_11.35.21.png)

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Pressing ""Probeer opnieuw"" will retry the access request
1. After pressing ""Probeer opnieuw"" the error Alert component disappears and the error message in the request access block changes to a spinner
1. On error while retrying, show toaster with error. Reset UI to initial state.
1. State should automatically update in UI of requesting organisation (without refresh)

**:link: Reference links**

1.",3
71860353,2020-09-29 09:27:33.720,Enable testing the grant access flow for the Review Apps,"**As a** developer
<br>**I want** the be able to manually test the access grant flow
<br>**so** that we deliver a flawless product

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Creating an access request can be tested manually
1. Accepting an access request can be tested manually
1. Revoking an access grant can be tested manually
1. Out of scope: automate test flow using E2E-tests

**Notes**

1. Add NLX Management for the organization Haarlem
1. Keep config for BRP 'as is' to make sure the Parkeervergunning app still works
1. NLX Management for Haarlem should be accessible from the Review Overview page

**:link: Reference links**

1.",3
71858302,2020-09-29 08:57:55.233,Revoke access grant,"**As a** nlx management user
<br>**I want** to able to revoke granted access
<br>**so** that organizations no longer have access to my services

revoke:<br>
![toegangsbewijs](/uploads/d6b5a8b7e520f627a2992dca3fec20d7/toegangsbewijs.png)

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

> Above design is shown in sub drawer, which is similar to access request.  

1. Revoking an access grant optimistically updates the UI state
1. On error while saving, show toaster with error. Reset UI to initial state.
1. Show confirmation dialog before revoking access
1. Organization no longer has access
1. State should automatically update in UI of requesting organisation (without refresh)",3
71858136,2020-09-29 08:55:08.501,View organizations with access,"**As a** nlx management user
<br>**I want** view organizations with access grants to my service
<br>**so** I known which organizations have access

![Incoming_access_requests_-_no_deny_yet](/uploads/2cce29c142f852198148cf2e73a5e6b6/Incoming_access_requests_-_no_deny_yet.png)

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Access grants are displayed in the service detail view
1. Displaying difference between public keys of a organization is out of scope


**:link: Reference links**

1.",3
71791132,2020-09-28 10:19:06.164,Add audit logging to NLX Management,"**As a** compliancy officer
<br>**I want** to see all user-initiated actions in the audit trail
<br>**so** that I can make informed statements about compliancy and

**As a** system admin
<br>**I want** to see all user-initiated actions in the audit trail
<br>**so** that I see what actions led to the current situation

Add the following events to the audit trail:
- User logs in/out
- Login attempts
- New service CRUD
- Incoming/Outgoing access requests - all actions
- Access grants created/revoked
- Access proof created/revoked
- Settings page - all changes

**:white\_check\_mark: Acceptance criteria**  

1. All actions which can be done in NLX management should be logged
1. Every action that is logged should contain structured data:
   - the action (type)
   - date/time
   - organization
   - device used (~~ip-address~~[**](#ip-address)/browser/terminal/client)
   - user
   - a field for meta data
1. If logging fails no actions should be executed. After the action there is no second log to confirm the action has succeeded
1. Audit trail is visible on new 'audit log' page in NLX Management (only list items, without filters/pagination)


> This should be all the icons. Could one of you check if it is complete? -Peter

![image](/uploads/0b88d1d17dd97d1125adaa3c70a344b8/image.png)

![_todo__Audit_log](/uploads/5ba48479c1285ccd0be9637255806d27/_todo__Audit_log.png)

**Out of scope**

- NLX Management role granted/revoked to new user
- Relevant part of audit trail on each specific detail page
- Audit logs are 'immutable' (e.g. if a row is deleted, this breaks a hash chain) For now I think we should keep this in mind but not implement it yet, as it comes with requirement for UX/Design. But we  should 

**:desktop_computer: How to demonstrate / e2e test(s):**

1. When one of the actions (described above) is performed, add to audit log
1. go to audit log page
1. see my actions


--- 

> **<a name=""ip-address""></a> ip-address CAN be seen as too privacy-sensitive. So we are not including it for now
> 
> ![image](/uploads/87fb7be614ca4ff3e7d3c8c6563f8354/image.png)",5
71621281,2020-09-24 11:02:26.106,Show state of access request  in requesting organisation,"Progress:

- [x] Polling mechanism (api to api) !1921
- [x] Expose ~~`lastestAccessGrant`~~ `latestAccessProof` !1935
- [x] Show latest access request states !1931
- [x] Show latest access grant states !1961

---

**As a** user that requests access
<br>**I want** to see the status of my request
<br>**so** that I know if I have access yet

After requesting access:
- keep polling of state of access request changes
- once request accepted, fetch the grant

After grant is fetched and stored:
- change status in UI to 'ACCEPTED'  
   Note: the UI does NOT do polling. See accepted state by closing and opening the drawer.

When access revoked (unknown yet for requesting org):
- keep polling for state change
- revoke local access grant
- change UI to 'Toegang ingetrokken'  (detail drawer and on service row in directory)


**implementation**

Access grant:
1. api will poll every 5 seconds to inway of org B to retrieve access request status
1. API will poll for access grant once status changes to 'approved'
1. When refreshing the UI, 'Je hebt toegang' will be visible once grant is available in requesting organisation 

Revoke: 
1. Access request state has to be in sync on both sides, this requires a poll mechanism that polls until resolved
1. After access granted, this grant needs to be exchanged and stored on requesting side


**:white\_check\_mark: Acceptance criteria**

1. For all below, UI = service row on directory page and service detail pane
1. When access request is clicked and 'ack' is received, UI shows 'Toegang gevraagd' 
1. When grant is received, 'Je hebt toegang' is shown. 
1. When access is revoked, UI in requesting org shows 'Toegang ingetrokken' 
1. After access to a service is revoked, a new request for access to that same service can be made


Out of scope: showing what happens when 'rejected'  
Out of scope: polling in the UI  

**:link: Reference links**

1.![Toegang_ingetrokken](/uploads/f0f66a2ab2d9a5666ede814f01a18adf/Toegang_ingetrokken.png)

![Toegang_ingetrokken_directory](/uploads/049c2380f0386eaad36534b91cafb736/Toegang_ingetrokken_directory.png)

![Screenshot_2020-09-24_at_12.51.07](/uploads/f464c71c333ad576cadafdef203f00f7/Screenshot_2020-09-24_at_12.51.07.png)

![image](/uploads/d4f6ef3b78729da4142108189cc7d1bb/image.png)",8
71536025,2020-09-22 21:37:42.326,Deprecation of treating TLS CommonName as host name,"
The certificates that we produce with our unsafe CA, based on the instructions [here](https://docs.nlx.io/try-nlx/retrieve-a-demo-certificate), are not compatible with the deployment on demo enviroment. This results in all services that use those certificates being offline. 

A temporary fix was applied, by temporarily re-enabling the old behavior by adding the value x509ignoreCN=0 to the GODEBUG environment variable and deploying the relevant demo environment components.

A permanent fix is required.

Urgent:  

- [x] We will automatically add the common name to the subject alternative name in the CA cert portal
- [ ] We will create new demo pki*
- [ ] We will include the intermediate cert in the request cert response
- [ ] We will inform the demo users about the breaking change
- [ ] We will document that a certificate must be newer than and why AND something about the intermediate certificate

Next steps:
- [ ] If possible/feasable, add a test that catches this error when deploying


*We will create a new pki because we do not sign demo the same way as prod and will change demo so it resembles prod


*Expected behaviour*

* Online services are shown online in directory of demo environment

*Actual behaviour*

* Online services are shown offline in directory of demo environment

**:clipboard: Steps to reproduce**

Note: due to temporary fix no longer visible in demo environment. Reproducing is not recommended.

1. Deploy an environment which trusts our Unsafe CA root, without the x509ignoreCN=0 env variable
1. Use certs generated according to the instructions on https://docs.nlx.io/try-nlx/retrieve-a-demo-certificate
1. See all services fail in directory


**:beetle: Cause**

* In Go 1.15 implementation of X5.09 certs, treatment of CommonName field as hostname is deprecated
https://golang.org/doc/go1.15#commonname
* The certificates that we instruct new users of NLX to generate, do no longer work correctly with our release that uses Go 1.15


**:mag: Details**

Example logs due to this bug:

`{""level"":""INFO"",""time"":""2020-09-21T15:37:31.326Z"",""caller"":""inway/inway.go:250"",""message"":""directory registration successful"",""version"":""v0.87.1"",""inway-organization-name"":""utrecht""}
2020-09-21 15:37:36.057073 I | http: TLS handshake error from 192.168.73.0:45365: remote error: tls: bad certificate
2020-09-21 15:37:36.075355 I | http: TLS handshake error from 192.168.73.0:4044: remote error: tls: bad certificate
2020-09-21 15:37:36.075481 I | http: TLS handshake error from 192.168.73.0:63007: remote error: tls: bad certificate
2020-09-21 15:37:36.082503 I | http: TLS handshake error from 192.168.73.0:11627: remote error: tls: bad certificate
2020-09-21 15:37:36.082776 I | http: TLS handshake error from 192.168.73.0:45641: remote error: tls: bad certificate
2020-09-21 15:37:36.090492 I | http: TLS handshake error from 192.168.73.0:55237: remote error: tls: bad certificate
2020-09-21 15:37:36.090559 I | http: TLS handshake error from 192.168.73.0:24471: remote error: tls: bad certificate`

---",5
71251441,2020-09-16 13:50:36.853,Remove Whitelist / Open access radio buttons from UI,"**As a** beheerder
<br>**I want** to use the whitelist only when not using NLX management
<br>**so** both type of users can still restrict access to their services and NO whitelist option in NLX management


**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. all code which is used to store / add / etc entries to the whitelist must be removed

**:link: Reference links**

1.",2
71249705,2020-09-16 13:16:17.400,Show number of access requests on services overview,"**As a** provider of services
<br>**I want** to see which of my services have open access requests (and how many)
<br>**so** that I know where my action is required

**:white\_check\_mark: Acceptance criteria**

1. Counter is shown on services overview on each row with open access requests
1. Visual Design is implemented

**Implementation**

1. BE: Add number of incoming access requests to service object (in list view)
1. FE: make sure the ""counter"" updates when fetching service detail

**:link: Reference links**

1.![Screen_Shot_2020-09-16_at_15.26.05](/uploads/54345e6e5114f4f53c3a76c367840d1b/Screen_Shot_2020-09-16_at_15.26.05.png)",3
71115434,2020-09-14 13:53:42.144,Add installation guide for NLX management to docs for testing purposes,"**As a** system operator
<br>**I want** to known how to install NLX management
<br>**so** that I can play around with it

This is part of #1024.
Before starting with this, discuss with @ehotting and Ingebrid if our proposed solution is ok.

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Go to docs.nlx.io
1. Follow steps in the NLX Management installation guide available on docs.nlx.io
1. End up with a working NLX Management setup

**:white\_check\_mark: Acceptance criteria**

1. Next to 'Try NLX', add the section 'Try NLX Management'
1. Add warning to the 'Try NLX' section that we're working on 'Try NLX Management' and the `config.toml` configuration will be deprecated in the future
1. Add warning to the 'Try NLX Management' section that this is a WIP.

**Notes**

1. Installation guide is aimed at a system running Docker
1. Installation steps available for:
- ETCD
- Dex
- Management API
- Management UI

1. Use Docker compose to setup local setup
1. Use environment variable to configure OIDC `.well-known-config-path`

**:link: Reference links**

1. Previous effort: https://nl-x.slack.com/archives/CU78R12LQ/p1601468678172700",8
70963133,2020-09-10 07:28:25.157,Reject access request,"Implement the view for approving and rejecting access requests, and revoking when already accepted

Choice:  
![Group_17_Copy_3](/uploads/f7d430f7f8256bcb8bbf6279b5dcee95/Group_17_Copy_3.png)

> Note: also see state flow model in [Epic](https://gitlab.com/groups/commonground/nlx/-/epics/12).

> Note 2: this component can be accessed from [service detail](#1004) or [dashboard](#998).

**:white\_check\_mark: Acceptance criteria**

1. Add endpoint to reject access
1. Rejecting an access request optimistically updates the UI state
1. On error while saving, show toaster with error. Reset UI to initial state.

TODO: @petervermeulen can you think of another icon to reject? The cross looks like deleting or throwing something away.

**:link: Reference links**

1.",2
70963083,2020-09-10 07:27:00.142,Accept incoming access requests and authorize requests based on access requests,"**As a** provider of a service
<br>**I want** accept access requests 
<br>**so** that the other organization can use my service

![Incoming_access_requests_-_no_deny_yet](/uploads/2cce29c142f852198148cf2e73a5e6b6/Incoming_access_requests_-_no_deny_yet.png)

**:white\_check\_mark: Acceptance criteria**

1. My service detail pane should list open access requests
1. The accept request should display the requesting organization name
1. I can accept the access request by clicking accept and confirm through a dialog box
1. The result of the action is displayed in a toaster
1. After accepting the request should disapear from the service detail pane
1. After accepting the requesting organization has access
1. ""Organizaties met toegang"" is out of scope

**:link: Reference links**

1.",13
70627225,2020-09-02 11:02:30.378,FE: Access requests visible on dashboard,"**As a** [beheerder]
<br>**I want** to see an overview of access requests on the dashboard
<br>**so** I can always see the requests regardless of the existence of the service 

:warning: We don't have endpoints to collect all outgoing/incoming access requests. Only by servicename. So this story is not purely FE.

**:desktop_computer: How to demonstrate / e2e test(s):**

1. login to nlx management
1. dashboard is shown with a section displaying access requests
1. I can view incoming or outgoing access requests
1. I can click ""view more"" if there are more access requests, these will open in a drawer
1. click on a request, it will show details in a drawer
   - this drawer will overlap the list view if it was open
1. I see a placeholder for the access request detail view

**:white\_check\_mark: Acceptance criteria**

1. Work with mock data on the frontend
1. view (max 5) access requests grouped by service
1. I can open the list view in drawer to see more/all access requests
1. able to open the request; To see details in drawer
   - if clicking on a request in the section: directly show details
   - if clicking on a request in the ""list drawer"": show ""drawer-in-drawer""
1. the detail pages show placeholders


**:link: Reference links**

1.
![_todo__Overview_-_Toegangsverzoeken](/uploads/2ca946bfa2a852dc85274d1e8c66ad2b/_todo__Overview_-_Toegangsverzoeken.png)

![_todo__Overview](/uploads/77ebf9d532d2b5e4be20a93fad4b18f1/_todo__Overview.png)",5
58923768,2020-07-15 09:45:13.343,Remove IE11 support,"**As** many stakeholders
<br>**I want** to drop IE11 support
<br>**so** I can spend more resources to actually implementing features

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Visit the app with IE11 and see a redirect to a page explaining it doesn't support IE11  
   (Not sure if we can automate this single test as an e2e-test)

**:white\_check\_mark: Acceptance criteria**

1. A good feature to test for (check if browser supports it) is [Proxy](https://caniuse.com/#feat=proxy)  
   If the browser does not support it, we should redirect to a page explaining we don't support outdated browsers
   (Note: Proxy is also a feature used by [mobx v5](https://mobx.js.org/README.html#browser-support))
1. Revisit the currently used polyfills, remove any that don't apply anymore to save bundle size
1. Whatever page the user opens (via bookmark of just the login page), the redirect should work.
1. List supported browsers. 

**layout proposal**
https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/R0Wn8j<br><br>
![ie11](/uploads/11f563c2121770d3778528dad000af18/ie11.png)

**Tech sollution**

> Agreed upon by Niels & Jorn

- Create the above design in `public/index.html`, which is the base template for the app
   - Inside the `<div id=""root"">`
- This way if there is an error you will see the ""browser support"" page
- To prevent this page flashing before the app loads, we can use CSS Transitions to only show the page after X seconds
   - On slow connections you may still see the browser support page before the app loads
- If there is NO error, react will simply overwrite the `#root` div and you won't see the page

This is a nice universal approach we can also use in our other projects",2
54143748,2020-07-09 07:19:39.815,Access Request reaches the other organization,"**As a** user of a service
<br>**I want** to send acces requests to the organization that provides the service
<br>**so** that the other organization knows that I want access

**Tasks**
- [x] Create an AccessRequest when the user clicks ""Request access""
- [x] Send a created AccessRequest from org A -> org B
- [x] Being able to set the primary inway for management requests
- [x] Implement a management-api proxy on the inway for org B
- [x] Set organization inway address in postgres after selecting the default ingress
- [x] Receive and store AccessRequest from org A in org B
- [x] Implement proper unique constraint on out/in-coming access requests

**Steps**
- access request can have state=created
- ar sending succeeds
  - communication between organizations runs through a proxy on the Inway of the receiving organizations
  - ar state changes to received
  - ar received is known in the management api 


**:desktop_computer: How to demonstrate / e2e test(s):**

1. 

**:white\_check\_mark: Acceptance criteria**

1. The public key finger print should be stored with the access request on both sides
1. There can only be one access request open per service/public key finger print
1. An access request can be send and received with a response about the state

**:link: Reference links**

1.

![image](/uploads/8cf41e71ca8687c8b07986a15c485e10/image.png)

list: https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/zPE5ka  
detail: https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/Jlbwz9",13
54143477,2020-07-09 07:14:56.771,One service can only be exposed by one Inway,"**As a** NLX beheerder
<br>**I want** have a one on one relation between service and inway
<br>**so** the service is only exposed by one inway

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

**BE**

1. NLX mgt UI - can only choose one inway. No choice will show the current not available message
1. mgt API - model must be changed so it a service can only contain one inway
1. Directory - model must be changed to one service on one inway relationship
1. Directory - must reject the registration when a inway tries to register the same service with a different self address

Dirctory: There will be a breaking change  
- We prefer to do this immediately
- Another option is to make a backward-compatible version in between

This depends on a chat with users of ""prod"" & ""pre-prod""

Same goes for inways

**FE**

NLX Management:  
This currently expects an array for connected inways in services  
This should change to a single entry

![Screenshot_2020-07-16_at_14.17.34](/uploads/4f4b9b0809005b02246e8b190c9333e3/Screenshot_2020-07-16_at_14.17.34.png)

Directory UI:  
Also work with a single entry instead of array for displaying status

![Screenshot_2020-07-16_at_14.17.13](/uploads/1d2add359fbd7113beaaf091a03e3f9c/Screenshot_2020-07-16_at_14.17.13.png)


**UI changes**<br>
[https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/v/eaaEyz/a/Jlbwz9/r/RMomoj](https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/v/eaaEyz/a/Jlbwz9/r/RMomoj)

**:link: Reference links**

1.",5
35437745,2020-06-04 14:22:43.723,Semantic release for Helm charts,"The Helm chart have two versions: the version of the chart and the version of the application. The application version reflects the version of NLX.

- When we release a new version of NLX the application version should be updated.
- When the application version changes, the chart version should increase.

Right now it is a manual step to change the version numbers of the charts. A of writing we didn't release a new version of NLX and the charts didn't need a version change.

We can solve this in two ways:

- Give the Helm charts their own version numbering<br>
  `Chart        0.1.0  -> 0.2.0  -> 0.3.0`<br>
  `Application  0.86.0 -> 0.87.0 -> 0.87.1`
  
- Use the NLX version also for the chart<br>
  `Chart        0.86.0 -> 0.87.0 -> 0.87.1`<br>
  `Application  0.86.0 -> 0.87.0 -> 0.87.1`


Either way the semantic release tool needs to change the version number.",2
35417864,2020-06-04 07:52:36.228,Directory in NLX management shows all services including your own,"**As a** beheerder  
<br>**I want** to see all services in the directory in NLX management
<br>**so** I have a complete overview there and do not have to go to the public website

Possible iterations:  
1. one list containing all
1. one list with filtering or  
  two lists, one for all others and one for mine
1. later maybe also one list for all services I'm connected to via my outway?

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. 

**:link: Reference links**

1.
",2
35368816,2020-06-03 08:20:15.706,Implement toaster in NLX,"Implement our freshly made toaster component in our projects, on the following locations:

## Todo

1. After creating a new service, you'll be redirected to that newly created service (the drawer), with a toaster.
1. After editing a service, you'll be redirected to that service, with a toaster.
1. After removing a service, you'll see the service overview page and a toaster (currently a localised Alert).
1. Reuse the same message/content from the message.",2
35368039,2020-06-03 08:13:23.345,Management: keep item in list visibly selected,"**As a** user
<br>**I want** the selected item in list to be visibly selected
<br>**so** I have an easy reference between the item in detail drawer and the list of items

For example on Services page, when service in list is clicked it is selected and Drawer opens with details.  
The item in list gets focus state with visual indication. But it loses focus when clicking somewhere else.

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Go to services page
1. Click a service (drawer with details opens, focus is set to Drawer (default function of normal drawer))
1. Service in list is visibly selected by different background color
1. Pressing tab after clicking will focus first element in the Drawer
1. Clicking on an element in the detail drawer will keep the service visibly selected
1. Clicking another service in the list will make that one visibly selected
1. Focus will be reset to the Drawer (so pressing tab will once again select the first element in drawer)

**:white\_check\_mark: Acceptance criteria**

- Selected service item has coloured background (similar to `selected` state of dropdown in attached design)
- On click focus will reset to drawer
- When closing the drawer (pressing ESC or clicking X) will set **unset selected state**, but **set focus** on item
- Should work like this on all pages (eg: ServicesPage, InwaysPage)

**:tools: Tech**

- hover, active and selected states should be managed by `Table` component in DS
- Capturing focus should be default functionality of Drawer, even when background is not used (update `Drawer` in DS if necessary)
- ServicesPage (and others, like inways) will need to maintain a state property to know what the selected item is

**:paintbrush: Design**

Design tokens:<br>
*Light theme*
```
$color-background-dropdown-hover		rgba(0, 0, 0, 0.1)
$color-background-dropdown-active		rgba(0, 0, 0, 0.3)
$color-background-dropdown-selected		rgba(0, 0, 0, 0.2)
```
*Dark theme*
```
$color-background-dropdown-hover		rgba(255, 255, 255, 0.1)
$color-background-dropdown-active		rgba(255, 255, 255, 0.3)
$color-background-dropdown-selected		rgba(255, 255, 255, 0.2)
```
![Dropdown_states](/uploads/aad2e78ed5f2aacf4c4a5793e35c87d3/Dropdown_states.png)",5
35062044,2020-05-27 12:04:17.111,Add inside info for admin when service has no inway,"
**As a** admin
<br>**I want** to be informed on several levels about the availability of my service
<br>**so** I easily see I need to give some TLC to a service 


**:desktop_computer: How to demonstrate / e2e test(s):**

1. do the steps mentioned in the acceptance criteria and check if the message is displayed on three places: the add/edit form, the details drawer and the service list


**:white\_check\_mark: Acceptance criteria**

1. when you add or edit a service and you do not connect it to a inway (or remove the connection), then the message should be displayed (ALLREADY DONE)
1. Same situation as above: no inway is connected to a service: then you will see in the details drawer of the service the same message which is shown in the form   
![Group_68_Copy](/uploads/c79901964303df549f68a44a1874048c/Group_68_Copy.png)
1. Same situation as above: no inway is connected to a service: then you will see in the service list the title of the message which is shown in the form and in the detail drawer
![image](/uploads/fa50eae9865eec0c0ee0fefdaa8fe551/image.png)


**:proposed solution**
- if inway count is 0 and boolean internal = False, then show on both appearances the standard message
- title of message should be: Geen inway gekoppeld
![Screen_Recording_2020-06-18_at_15.21.50](/uploads/970f5e7c193ff915a341bc7628edeb11/Screen_Recording_2020-06-18_at_15.21.50.mov)",2
34970015,2020-05-25 09:50:15.558,Listen to 127.0.0.1 by default,"## Problem

All our components that accept incoming requests (start listeners), like an inway and outway, listen by default to the `0.0.0.0` address. That means it will bound to all network interfaces. When you deploy an outway (or other component) on a server that is directly connected to the internet and no firewall is configured, it will expose the outway to the public internet. This might be a security risk.


## Proposal

Change the default value for all the 'listen' options in all components from `0.0.0.0:<port>` to `127.0.0.1:<port>`.",1
34539656,2020-05-14 08:25:07.863,Adopt new rules section in gitlab ci yaml,"**As a** developer
<br>**I want** to use the current pipeline syntax for rules
<br>**so** my pipelines will run

In GitLab 13.0 the `only`/`except` syntax to specify when a job should be executed is changed to `rules`. In our case the `container_scanning` jobs overrides a gitlab template that has migrated to `rules`, while we specify `only`/`except`. See this [failed pipeline](https://gitlab.com/commonground/nlx/nlx/pipelines/145888217). This needs to be fixed asap. After that all jobs need to be updated to prevent future issues.

**:white\_check\_mark: Acceptance criteria**

1. no conflicting use of `rules` and `only`/`except` in jobs
1. all jobs use `rules`

**:link: Reference links**

1. https://about.gitlab.com/releases/2020/05/06/gitlab-com-13-0-breaking-changes/",2
34432607,2020-05-12 07:45:01.544,Link inway(s) to a service,"**As an** [beheerder]
<br>**I want** to link one or multiple inways to a service
<br>**so** my service can be found and used by other organizations

**:desktop_computer: How to demonstrate / e2e test(s):**
1. Add a service 
1. Fill in all details
1. select one or multiple inways
1. store the service
1. see that the service is added to the service list
1. see in the public directory that the service is available in the list
1. see in NLX management that the service is NOT visible since its your own service


**:white\_check\_mark: Acceptance criteria**

1. Add this functionality to the add/edit service form (see designs attached)
1. Works the same by editing a service, but linked inways are prefilled.
1. when no inways are available, then show message simular to the message on the inway page. The selection box and + link are hidden
1. When no inways are linked, and the option ""publish in directory"" is chosen, show an alert notification (see design below)
1. Update the order of the form fields (see design below)


**:link: Reference links**

1.

**Designs:**<br>
![_busy__Add_new_service](/uploads/85c21409a5194d21d949cf9c53ee8c01/_busy__Add_new_service.png)
![_busy__Add_new_service_-_Multiple_inways](/uploads/854234ddb54c25e0395670743f5a38b3/_busy__Add_new_service_-_Multiple_inways.png)
",5
34305729,2020-05-08 09:31:35.371,Outway: use separate certificate for https endpoint,"## Problem

The outway has two (internal) endpoints: http and https. Currently the https endpoint serves the (PKIO) organization certificate to the client. The problem with this is that the organization certificate should contain the internal domain name on which the outway is reachable. Besides this certificate is used for authenticating the outway on the NLX network.


## Proposal

Use separate certificate for the https endpoint. This should be explicit be configured, no fallback to the organization certificate. If it is desired to use the same certificate then this needs to be configured twice.

## Focus
This issue has a focus on the changes of the connection between the client and the outway. other issue's should address other points of the to-be situation for the outway

### Acceptance criteria / technical 

* Add certificate bundle (certificate, private key, ca certificate) options to `nlx-outway`
* Validate as usual
* Use certificate bundle to start the https server
* Start HTTPs server only when certificate bundle is provided, including CA certificate
* CA certificate is required


### References

* Options: https://gitlab.com/commonground/nlx/nlx/-/blob/master/outway/cmd/nlx-outway/main.go#L24
* HTTPs server: https://gitlab.com/commonground/nlx/nlx/-/blob/master/outway/listen.go#L58-63


### Changes for the to-be situation
1. use the .local address https://en.wikipedia.org/wiki/.local
2. relocate the state of the Outway to the NLX Management component
3. add local certificates and keypairs
4. remove the ""DISABLE_LOGDB"" flagg and define the NLX_LOG_ADDRESS 
 -- when the adress is empty the logging should be disabled and the http headers should 
include a warning stating that Logging is disabled in the outway
5. The client must inform the outway whitch organisation and service to adress. basically their are three options:
 5.1 the client should add 2 headers that includes {organization-name}/{service-name}/ OR
 5.2 the client should include the {organization-name}/{service-name} in the path OR
 5.2 the client should include {organization-name}/{service-name} in the hostname

### Considerations:
if the response to the client includes a NLX domain consiting of https://nlx.{provider}.nl/ 
the response should be altered to replace : 
-- https://nlx.{provider}.nl/{path} with 
-- https://{consumer}.local/{organization-name}/{service-name}/{path}

hence making it possible to referens to a NLX resource in the response

The linked data issue should also be resolved for the outway to work as a proxy
hence making it possible to referens to a NLX resource in the response
the linked data issue should also be resolved for the outway to work as a proxy
https://gitlab.com/commonground/nlx/nlx/-/issues/316
https://gitlab.com/commonground/nlx/nlx/-/issues/530
https://gitlab.com/commonground/nlx/nlx/-/merge_requests/1337",2
33312838,2020-04-15 10:16:29.014,Outways page,"**As a** administrator
<br>**I want** to have an overview of all the outways 
<br>**so** that I can copy its Public Key PEM

**:desktop_computer: How to demonstrate**

1. Navigate to in/outway

**:white\_check\_mark: Acceptance criteria**

1. Rename menu item 'inways' to 'in/outway'
1. Display type toggle (all/inway/outway)
1. Implement detail pane
1. Enable copying the Public Key PEM from the detail pane
1. Do not implement search
1. Do not implement sorting
1. Outway should register itself to the management API
1. Outway should not start when management API url is missing

**Questions**

- Currently outways are not using the config API so the system does not know which outways are available?

**:link: Reference links**

1. In/Outways overview page: https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/nPV5g0
1. Outway detail pane: https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/Yxr5Lm
1. Add Public Key PEM field to the certificate info: https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/1pzP3n",13
33276983,2020-04-14 15:29:11.951,Design System - Input component,"Created separate story for extracting the input components into the Common Ground Design System.

**:white\_check\_mark: Acceptance criteria**

1. Input fields (text, radio & checkbox)
1. TextInput, RadioInput & CheckboxInput (helper components which include the label, input and validation message)
1. Documentation
1. Apply updates in Appstore & NLX Dashboard (the DON team should be informed about this).",5
33264588,2020-04-14 12:35:24.230,Implement toaster component,"**As an** user 
<br>**I want** clear feedback on my actions
<br>**so** that there is no doubt if my action was successful or not.

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. A component to give feedback on actions. Often called ""toaster"" or ""alert notification"". Which appears in the upper right corner.
1. Styling is the same as the inline alerts, with an added shadow and close icon.
1. There are 4 flavours, the same types as the inline alerts. (info, success, warning, error)
1. Animation specs are in the image attached. 

**:link: Reference links**

1.

![Alert_notification__toaster__component_specs](/uploads/2dcfaa4e279872e6f6b21446bc71ff7b/Alert_notification__toaster__component_specs.png)

<br><br>
SVG close icon:<br>
`<svg xmlns=""http://www.w3.org/2000/svg"" viewBox=""0 0 24 24"" width=""24"" height=""24"">
                    <polygon id=""Path"" points=""0 0 24 24""></polygon>
                    <polygon id=""Path"" fill-rule=""nonzero"" points=""12 10.8216667 16.125 6.69666667 17.3033333 7.875 13.1783333 12 17.3033333 16.125 16.125 17.3033333 12 13.1783333 7.875 17.3033333 6.69666667 16.125 10.8216667 12 6.69666667 7.875 7.875 6.69666667""></polygon>
</svg>`",2
32728142,2020-04-01 11:31:12.167,NLX Management: show organization name,"**As a** _NLX Management user_
<br>**I want** _to see the organization name_
<br>**so** _that I know for which organization I perform actions_

**:desktop_computer: How to demonstrate / e2e test(s):**

1. just login and show

**:white\_check\_mark: Acceptance criteria**

1. Organization name comes from the (PKIO) certificate

On login page:  
1. Show the organization name also on the login page and show that name fully
  
On other pages:  
1. Only show organization name in normal font weight
1. Show ellipsis (...) when the name is longer then 20rem
1. Hover on the name, shows the complete name


**Proposed tech solution:**  
* create new endpoint for fetching environment vars

**:link: Reference links**

1. ![_busy__Services](/uploads/ad0b0411ede231e0cf34cafa786728c4/_busy__Services.png)
1. The login page based on https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/7L27xY
   The rest of that design will be implemented in https://gitlab.com/commonground/nlx/nlx/-/issues/929",3
32626805,2020-03-30 11:15:24.075,Merge management-api and config-api,"> One management-api to rule them all - Hugo

We would like to join the management-api and config-api so there is only one component with the responsibility to hold state within one organization. The new name is: **management-api**

Acceptance criteria:
- The config-api and management-api are combined in one component
- The inway uses the management-api for polling configuration

Technical design:
- The management-api listens on both 8080 (HTTP with session authentication) and 8443 (HTTPS mTLS)
",5
32122681,2020-03-18 09:16:07.540,Management: change multi-language approach,"Dutch will be the default language. However, because of international aspirations, the software (i18n keys and routing) should be English.

- [x] Change public facing URLs to English
- [x] Change translation strings to English
- [x] Add English and Dutch translation files. The English ones will initially be the same as the key strings.
- [x] Add some documentation about how to internationalization as developers",2
32092418,2020-03-17 15:08:48.894,Management: edit a service,"**As a** administrator
<br>**I want** to edit a service
<br>**so** I can alter the configuration when needed

**:desktop_computer: How to demonstrate**

1. Select an existing service and change it settings
1. View service details to confirm new settings

**:white\_check\_mark: Acceptance criteria**

1. I am able to change the settings of a service
1. The service name is immutable
1. Show confirmation message when successful
1. Show error message on failure

**:link: Reference links**

1.https://sketch.cloud/s/eDOWa/a/3YxOja",3
32091213,2020-03-17 15:03:16.828,Management: remove a service,"**As a** adminstrator
<br>**I want** remove a service
<br>**so** that services that are no longer provided to the NLX network

**:desktop_computer: How to demonstrate**

1. Create a service
1. Delete it
1. Navigate to service overview and confirm service is deleted

**:white\_check\_mark: Acceptance criteria**

1. Show confirmation dialog before deleting (native browser confirm)
1. Show confirmation when successful
1. Show error message on failure

**:link: Reference links**

1.https://sketch.cloud/s/eDOWa/a/3Yjyyj",2
32091104,2020-03-17 15:00:44.264,Management: service details,"**As a** administrator
<br>**I want** to view the details of my services
<br>**so** that I know how a service is configured

**:desktop_computer: How to demonstrate**

1. Select a service from the services overview and display the details

**:white\_check\_mark: Acceptance criteria**

1. Implement design with available fields in the API
1. Extract drawer component into DS
1. Implement drawer into other consuming projects (DON & Appstore)

**:link: Reference links**

1. https://sketch.cloud/s/eDOWa/a/3Yjyyj",5
32090384,2020-03-17 14:48:01.543,Management: add a new service,"**As a** administrator
<br>**I want** to add a new service
<br>**so** that I can offer services to the NLX network

**:desktop_computer: How to demonstrate**

1. Create a new service
1. Open the services overview
1. Find your new service 

**:white\_check\_mark: Acceptance criteria**

1. Implement form as designed with the fields that are available in the API
1. For now we do not implement the field Inways -> follow up story
1. Show a  confirmation message when the service has been created
1. Show error message when it fails
1. Navigate to service overview after successful creation
1. Extract input component into DS
1. Implement input into other consuming projects (DON & Appstore)

**:link: Reference links**

1. https://sketch.cloud/s/eDOWa/a/3YxOja",8
31873580,2020-03-11 14:17:25.231,Request access: persist and show outgoing access request,"**As a** administrator
<br>**I want** see that there's an access request for a service
<br>**so** that I know my access status per service

**:desktop_computer: How to demonstrate**

1. Prepare the DB so every status is visible in the directory
1. Open the Review App
1. Navigate to the directory page
1. There is a status column with the status for every service

**:white\_check\_mark: Acceptance criteria**

1. It should be possible to request access from the Directory
1. Outgoing access requests are persisted in the management-api using Etcd.
1. Add extra column to the directory list with the status request of the request.
1. The management api exposes an endpoint with all data required for the Services list in the UI.

**:link: Reference links**

1. https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/JgzOy9",5
31873431,2020-03-11 14:14:10.584,Request access: create an access request,"**As a** administrator
<br>**I want** request access to a service
<br>**so** that I can use the service when I get permission

**:desktop_computer: How to demonstrate**

1. After clicking on ""Request access"" in the management-ui an access request is logged in the stdout of the management-api

**:white\_check\_mark: Acceptance criteria**

Todo:
- Add drawer 
- Add button ""Request access"" in drawer and in row of service
- The management-ui passes the request to the management-api (API)

**E2E tests**
- Press button and see pending state

**:link: Reference links**

1. https://www.sketch.com/s/89b1e1ac-ec61-482a-bc78-8d1b811bf210/a/pMoKvG",5
31598205,2020-03-05 08:34:38.766,Management: services list,"**As a** administrator
<br>**I want** see a list of services running in my NLX deployment
<br>**so** that I know what is runnning

**:desktop_computer: How to demonstrate**

1. Navigate to services
1. View list of services
1. Open service list with wifi turned off (should generate an error)
1. Open an empty service list to verify empty state

**:white\_check\_mark: Acceptance criteria**

1. Services is available in the navigation
1. Display name
1. Display authorization type
1. ~~Display status~~ not available from API
1. ~~Display api spec type~~ not available from API
1. Display progress icon when loading
1. Display error message when loading the overview fails
1. Add empty state when no services are available
1. Do not implement search and setting button

**:link: Reference links**

Design:
https://sketch.cloud/s/eDOWa/a/zPE5ka
<br><br>
Empty state pattern: (from in/outways, but is the same for all tables)<br>
https://sketch.cloud/s/eDOWa/a/3Y9ldz
<br><br>
Loading state pattern: (from in/outways, but is the same for all tables)<br>
https://sketch.cloud/s/eDOWa/a/8RnoEa
<br><br>
Interactive state table tokens:
<br><br>
// Table<br>
$colorBorderTable			$colorPaletteGray800<br>
$colorBorderTableFocus			$colorFocus<br>
$colorBackgroundTableHover		$colorBackgroundAlt<br>
$colorBackgroundTableActive		$colorPaletteGray800<br><br>

Working example van een ander design system (qua sortering, inclusief animerend pijltje :wink:):<br>
https://www.carbondesignsystem.com/components/data-table/code/<br><br>
![Table_interaction_states](/uploads/a1bc4dbad10fc1563349c098ec9eaf8d/Table_interaction_states.png)
",5
31598171,2020-03-05 08:33:48.546,Management: inway details,"**As a** administrator
<br>**I want** so the details of my inways
<br>**so** that I can verify they are configurated correctly

**:desktop_computer: How to demonstrate**

1. Select a inway from the in/outway overview

**:white\_check\_mark: Acceptance criteria**

Create drawer with:

1. Display name
1. Display type in/outway
1. Display IP-adres
1. Display Hostname
1. Display Self address
1. Display Version
1. Display service list (showing the name of each service)
1. Do not implement clickable service list

**Questions**

1. Show we display certifcate information? 
   - We can do so in a follow up story.
1. Can you navigate to service details from service list?
   - Yes.
1. Disable sorting in service list?
   - Yes, the list can not be sorted.

**:link: Reference links**

1. https://sketch.cloud/s/eDOWa/a/1pzP3n",5
31598142,2020-03-05 08:33:00.561,Management: inways,"**As a** administrator
<br>**I want** to have an overview of all the inway
<br>**so** that I can see whats running on my environment

**:desktop_computer: How to demonstrate**

1. Navigate to inways (button is named only inway opposed to what the design says)
1. Open overview with wifi turned off (should generate an error)
1. Open overview without inway configured to verify empty state

**:white\_check\_mark: Acceptance criteria**
1. Only show the logical inways (so aggregate multiple instances to one)
1. Add inway into menu
1. Display type (inway)
1. Display name
1. Display hostname
1. Display status
1. Display number of services
1. Display version
1. Display progress icon when loading
1. Display error message when loading the overview fails
1. Add empty state when no inway are available
1. Do not implement search
1. Do not implement sorting
1. Path should be /in-outways





**:link: Reference links**

1. https://sketch.cloud/s/eDOWa/a/nPV5g0
1. https://sketch.cloud/s/eDOWa/a/3Y9ldz",5
31598107,2020-03-05 08:32:03.532,Management: directory list,"**As a** administrator
<br>**I want** to see a list of all services available on the NLX network
<br>**so** that I know which APIs I can use

**:desktop_computer: How to demonstrate**

1. Navigate to directory
1. View list of services from the directory-url
1. Open directory with wifi turned off (should generate an error)
1. Open an empty directory list to verify empty state

**:white\_check\_mark: Acceptance criteria**

1. Add directory to navigation
1. Display organization
1. Display service name
1. Display status
1. Display API-type
1. ~~Display environment~~ (will be done as part of https://gitlab.com/commonground/nlx/nlx/-/issues/911)
1. Display progress icon when loading
1. Display error message when loading fails
1. Display empty state when no services are available
1. Do not implement search
1. Do not implement authorization column

**Questions**

- Do we implement sorting?
- ~~It would be great if we can mark the list services endpoint on the outway [public and stable](https://docs.nlx.io/use-nlx/new-releases) as well. Applications can then use this special endpoint to implement introspection features. @sergei-maertens would be very happy with this feature.~~ will be picked up in #924 

**:wrench: Proposed technical solution**
- We add an endpoint on the outway that shows the list of services in the directory
- The management-api retrieves the list of services in the directory through the outway

**:link: Reference links**

1. https://sketch.cloud/s/eDOWa/a/JgzOy9",5
31598052,2020-03-05 08:30:25.428,Implement 404 page,"**As a** _user_
<br>**I want** _goal_
<br>**so** _purpose_

**:desktop_computer: How to demonstrate**

1. Enter a non-existing url (eg: `<base_url>/asdf`) and see 404 page

**:white\_check\_mark: Acceptance criteria**

Depends on:
- page template

Todo:
- implement design
- show 404 page when a route is invalid / not found

**:link: Reference links**

1. https://sketch.cloud/s/eDOWa/a/PEzbMP",1
31597770,2020-03-05 08:29:00.679,Implement page template,"**As a** _user_
<br>**I want** _goal_
<br>**so** _purpose_

**:desktop_computer: How to demonstrate**

1.

**:white\_check\_mark: Acceptance criteria**

Todo:
- fetch requirements from Peter about what sections should be scrollable / fixed
- user account info at top
- gemeente + environment info at top
- sidebar including only the link 'NLX Management' (links to root), 

**:link: Reference links**

1. https://sketch.cloud/s/eDOWa/a/rPQ5lD",5
31597658,2020-03-05 08:27:42.778,Implement authentication mechanism,"**As a** system administrator
<br>**I want** login to management using open-id connect
<br>**so** securely manage NLX

**:desktop_computer: How to demonstrate**

1. in style

**:white\_check\_mark: Acceptance criteria**

1. remove username password
1. add open-id connect
1. docker-compose example with dex
1. developer documentation, no user documentation yet

**:link: Reference links**

Use appstore history

1. https://sketch.cloud/s/eDOWa/a/7L27xY",5
31597604,2020-03-05 08:26:13.565,Implement E2E test tooling,"**As a** _user_
<br>**I want** _goal_
<br>**so** _purpose_

**:desktop_computer: How to demonstrate**

1.

**:white\_check\_mark: Acceptance criteria**

- E2E-test setup using BrowserStack and initial test (see setup Appstore)
- a11y-test setup using axe + test welcome page (see setup DON)

**:link: Reference links**

1.


- can we run an actual instance of the management-ui as part of a Review App? Can we give BrowserStack access to it? -> yes, in review app",3
31597540,2020-03-05 08:24:54.101,Implement Welcome page,"**As a** _user_
<br>**I want** _goal_
<br>**so** _purpose_

**:desktop_computer: How to demonstrate**

1.

**:white\_check\_mark: Acceptance criteria**

- setup CI/CD
- setup fresh CRA in 'nlx-management'
- implement welcome page
- path: /login
- out of scope: login button, should be done as part of the dex story
- create separate `@commonground/linting package` with our shared linting configuration. As a base [this repo](https://github.com/publicJorn/eslint-config-jorn) can be used. It's a copy of react-scripts. No specific work was done for it yet.  (we'll base it on standardjs) **@publicJorn**

**:link: Reference links**

1. https://sketch.cloud/s/eDOWa/a/7L27xY",8
31597435,2020-03-05 08:22:37.460,Extract components from Appstore to CG Design System,"**As a** _user_
<br>**I want** _goal_
<br>**so** _purpose_

**:desktop_computer: How to demonstrate**

1.

**:white\_check\_mark: Acceptance criteria**

- remove components from CG DS which we don't use in DON and Appstore
- provide default theme.js
- add global styling, Typography and Button components
- take Peter his thoughts into account (https://sketch.cloud/s/D9YpW)
- update [DON](https://gitlab.com/commonground/developer.overheid.nl/-/issues/194) & [Appstore](https://gitlab.com/commonground/appstore/appstore/-/issues/170) so they use these components


**:link: Reference links**

1. https://gitlab.com/commonground/appstore/appstore/issues/165

**:hammer_and_wrench: Technical solution:**

* [x] Chart what components are currently used in our apps
* [x] Remove all unused components
* [x] Update dependencies
* Add the following anew
  * [x] Global styling (extendable)
  * [x] Theming (extendable)
  * [x] Typography (Discuss: in global styling or as components?)
  * [ ] ~~Grid~~
  * [x] Button
* [x] Create tests with [RTL](https://testing-library.com/docs/react-testing-library/)",8
31037261,2020-02-19 18:07:57.734,Add abstraction layer (txlog-api) between inway/outway and txlog-db,"Currently inways and outways directly write via a Postgres interface to the txlog-db. It would be great to introduce a layer of abstraction here (txlog-api), so the database is more pluggable and security is enhanced.

Currently, only `ListRecords` is implemented.

:bangbang: This is a breaking change, since you need to specify an extra flag with the TXLog API address to the Inway & Outway. We can make this backwards compatible by supporting both a `TXLOG API` address and a `TXLOG Postgres DSN`. The current issue assumes we **WILL** make this backwards compatible.

**Todo**

- implement write call to create a single record
- update Outway and Inway
- support using both the txlog Postgres DSN flag and the txlog API flag
- attempt to use CQRS pattern?",8
30983776,2020-02-18 17:20:29.103,Display a warning in NLX inway/outway when permissions of the private key are too broad,"For security reasons we would like to check if the key file is not too open. If they are, NLX should display a warning.",1
30963229,2020-02-18 10:34:12.431,Improve documentation on using the G1 root CA certificate,"- Document to use the G1 root CA certificate instead of the use of an intermediate certificate.
",1
30962610,2020-02-18 10:19:21.428,Display helpful error message when loading wrong certificate,"### User story

*For components that load certificates: inway, outway, directory*

As a **developer**
<br>I want to **see why the provided certificate is not valid**
<br>so that **I know what the problem is**

### How to demonstrate
* Load certificate that is not signed by the provided root cert
* Should display, that the cert is only valid for '$ca_1', and not for provided '$ca_2'


**:hammer\_and\_wrench: Proposed technical solution**

* Read information about provided certificates and display it",2
30961957,2020-02-18 10:08:18.210,Add support for intermediate certificates in chain,"As a **user**
<br>I want to **use a certificate that is signed by an intermediate certificate**
<br>so that **I can use PKI Overheid certificates**

---

Problem right now is that the eg. the inway only offers the leaf certificate in the TLS handshake. The other party, eg. the directory, can verify that certificate because the intermediate certificates are missing. The directory only has the root certificate.

**:movie_camera: How to demonstrate**
* -
* -

**:mag_right:(Test) scenarios**<br>
*Title*<BR>
Given demo env
When using cert without intermdiate
Then it should keep working

**:white\_check\_mark: Acceptance criteria**

1. Update NLX documentation about [going prod](https://docs.nlx.io/use-nlx/request-a-production-cert)
1. Unit Tests
1. NLX works with intermediate certificates between all NLX components


**:hammer\_and\_wrench: Proposed technical solution**

* Load all the certificates, including the intermediate, and use them during TLS handshake
* Use full chain cert files
* See: !1207

**:link: Reference links**

* 
",5
28363181,2019-12-12 12:42:48.040,Do not run acc build and deploy for tags,,1
28326571,2019-12-11 18:30:02.937,Failing Go tests due to expired certificates,"Our Go tests failed because the test certificates expired. Updated the test certificates with an expiry of 200 years, also added an upgrade script to update the certs when necessary.",2
28279267,2019-12-10 16:46:27.941,More granular authorization on inways using certificate pinning,"### User story

As an **ops person**
<br>I want to **be able to authorize more granularly on inways**
<br>so that **I can improve the security of the NLX system in general**

NLX currently offers a way to whitelist organizations based on an organization name. This is really easy, but also introduces a large attack vector as every trusted certificate that is handed out for an organization can automatically be used in the context of NLX.

To allow more granular authorizations, we would like to introduce authorizations based on the `subjectPublicKeyInfo` field in the certificate. This has the following benefits:

- This restricts the certificates from a particular organization that can be used to setup NLX connections.
- This allows organizations to compartiment their security by having different security zones.
- This protects the NLX system of compromised CA's by pinning to specific public keys of certificates.

Of course this results in more administrative work by the inway administrator, but we can probably solve this partially by implementing good UX confirmation flows as described in #742. This could be a great follow-up story.

**:white\_check\_mark: Acceptance criteria**

1. The service-config.toml and config API are extended to support authorization based on public keys
1. We describe authorization based on the public key as the preferred way of authorization in production in the docs
1. When multiple authorization options are set, they all need to match before authorization is confirmed.
1. Remain backwards compatible and announce deprecation for the old way of authorizing in the service-config.toml.
1. Documentation about this feature is added to the docusaurus

**:wrench: Proposal**

*service-config.toml*

```toml
[services.postman-echo]
endpoint-url = ""https://postman-echo.com/""
documentation-url = ""https://docs.postman-echo.com/""
authorization-model = ""whitelist""

[[services.postman-echo.authorization-whitelist]]
organization-name = ""Gemeente Utrecht""
public-key = ""sha256:GX6v14r7KP+TTQPzzmg3XgcaEVfcsCgUx6TfDCHTu5M=""

[[services.postman-echo.authorization-whitelist]]
public-key = ""sha256:/YAbDkjkJ6/2961u8Mun+Y8RVygDbSSoH5ZiSSdeCsU="" # Gemeente Amsterdam

[[services.postman-echo.authorization-whitelist]]
organization-name = ""Gemeente Haarlem""
```

We could for example use a SHA-256 hash of the public key, similar to the [HTTP Public Key Pinning](https://developer.mozilla.org/en-US/docs/Web/HTTP/Public_Key_Pinning) (HPKP) header (thanks @hugoboos).

Example similar to HPKP:

```bash
openssl x509 -in org.crt -pubkey -noout | openssl pkey -pubin -outform der | openssl dgst -sha256 -binary | base64
GX6v14r7KP+TTQPzzmg3XgcaEVfcsCgUx6TfDCHTu5M=
```

Or skip the base64 step:

```bash
openssl x509 -in org.crt -pubkey | openssl pkey -pubin -outform der | openssl dgst -sha256
197eafd78afb28ff934d03f3ce68375e071a1157dcb02814c7a4df0c21d3bb93
```
",5
28024204,2019-12-06 15:00:26.786,Restructure Helm charts and upgrade Helm to v3,"As a **Developer**
<br>I want to **deploy using Helm v3**
<br>so that **I can use up to date tooling**

**:white\_check\_mark: Acceptance criteria**

1. The charts can be used with Helm 3
1. The charts can be used by ourselves for development / testing purposes, but also by users
1. The charts are structured per (set of) component(s)
1. It is possible to install multiple releases in the same Kubernetes namespace
1. Documentation is updated accordingly
1. A review app is limited to one Kubernetes namespace

**:pencil2: Proposed structure**

*Central*
- directory
- certportal
- docs

*Organization*
- inway
- outway
- insight
- management

Reference information
- Check out Helm repository of signals application



## Tasks

### Update to Helm v3

* [x]  Update deployment Docker image
* [x]  Update deployments
  * [x]  NLX deployment
  * [x]  AppsStore deployment
  * [x]  DON deployment
* [x]  Migrate clusters
  * [x]  Review
    * [x]  Migrate releases
    * [x]  Remove Tiller
  * [x]  Delta
    * [x]  Migrate releases
      * [x]  cgn-prod
      * [x]  go-nlx-io-prod
      * [x]  hackathon-services
      * [x]  nlx-demo
      * [x]  nlx-acc
      * [x]  nlx-preprod-directory
      * [x]  nlx-prod-directory
      * [x]  nlx-io-prod
      * [x]  nlx-prod-demo
    * [x]  Remove Tiller


### Restructure charts

#### Core

- [x]  Directory UI
- [x]  Directory
- [x]  Directory monitor
- [x]  Docs


#### Organisation

- [x]  Inway
- [x]  Outway
- [x]  Unsafe CA
- [x]  Config API
- [x]  Transaction log
- [x]  Auth service
- [x]  NLX Management 


#### Demo

- [x]  Insight API
- [x]  Insight UI
- [x]  Cert portal
- [x]  Demo application
- [x]  IRMA server


#### Support

- [x]  Review page",8
27394081,2019-11-21 09:44:41.890,Migrate docs.nlx.io to Docusaurus 2,"As a developer
<br>I want to use only one documentation tool
<br>so that I can fix bugs only once

### How to demonstrate
* Show a screenshot of the previous version
* Navigate to the new version
* Show that they look mostly the same

### (Test) scenarios
*Same look and feel*  
Given the documentation site  
When I visit it  
Then looks and feels similar to the previous edition

*No external CSS and JS*  
Given the documentation site  
When it is loaded in the browser  
Then it loads only resources from the documentation site itself and algolia

**:white\_check\_mark: Acceptance criteria**

1. docs.nlx.io is served using Docusaurus 2
1. It has the same look and feel as the Docusaurus 1 implementation
1. No CCS and JS files are loaded from external CDNs
1. CSP Rules allow for no external css or js files

**:hammer\_and\_wrench: Proposed technical solution**

* Follow the [migration documentation](https://docusaurus-2.netlify.com/docs/migrating-from-v1-to-v2/) for Docusaurus 2 
",2
27058303,2019-11-14 16:05:16.988,The support link in the menu is not working any more,"
*Expected behaviour*

* When I click on the Support button I get the support page

*Actual behaviour*

* I get a 404

**:clipboard: Steps to reproduce**

1. Go to nlx.io
1. Click on support


**:beetle: Cause**

* This is caused due to restructuring of the docs

---",1
27046096,2019-11-14 10:18:51.687,Display friendly error pages,"### User story

As a **user**
<br>I want to **see a nice error page instead of the default nginx error page**
<br>so that **I know what is wrong and have options to further navigate the websie**

The [documentation website](https://docs.nlx.io) shows the default nginx error pages in case of an http error:

![Screen_Shot_2019-11-14_at_11.16.00](/uploads/b142c95e8259b4f159ec1a840b466b91/Screen_Shot_2019-11-14_at_11.16.00.png)



**:white\_check\_mark: Acceptance criteria**

1. add 404 custom page containing a user friendly error message
1. all 404 errors must redirect to this page
1. custom page must include NLX logo and a link back to docs.nlx.io root
1. the scope of this page is docs.nlx.io


**:hammer\_and\_wrench: Proposed technical solution**

* create new page in docusaurus which is not present in navigation

**:link: Reference links**

*",2
27024068,2019-11-13 16:33:58.973,Alter TTL for directory entries to 86.400 seconds,"As a **maintainer**
<br>I want to **clean up the directory by removing off-line services**
<br>so that **the directory content stays relevant**

### How to demonstrate
*
*

### (Test) scenarios
*Title*<BR>
Given <BR>
When <BR>
Then <BR>


**:white\_check\_mark: Acceptance criteria**

1. Directory regularly cleans up offline services after being unreachable for set Time To Live (in seconds)
1. Set Time To Live to 1 day (86.400 seconds)
1. Documentation **(!)**
1. Tests

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* 
",1
27016170,2019-11-13 13:53:52.027,Repair benchmark setup,"
Benchmark cluster shows 100% errors for transactions due to logs that fill up every few days.


We need to fix this 'future proof':

- Postgres dedicated (not in docker)
- Ansible roles to deploy correctly",3
26931883,2019-11-11 11:06:47.559,Service permissions are not propagated correctly when using config-api,,1
26844542,2019-11-08 09:54:37.753,Display in- and outway versions in dashboard,"**As a** maintainer
<br>**I want to** see which versions of the inway & outway are being used
<br>**so that** I can make better decisions about release management and communicate about them

---

### (Test) scenarios
*Title*<BR>
Given the stats api and version info available in the database<BR>
When I open the grafana dashboard<BR>
Then I see one line graph per environment with a counter of inways and on for the outways per version <BR>


**:white\_check\_mark: Acceptance criteria**

1. The NLX Grafana dashboard should show a graph with the version of the inways and outways being used.
1. One line per version representing usage over time (x axis = time, y axis = count)
1. Display a graph for the inways and one for the outways. Show both graphs for all environments (DEMO, pre-PROD & PROD).

For inspiration:

![Screenshot_2019-11-05_at_10.40.37](/uploads/f41793c35b7fe55a32ea80605240c571/Screenshot_2019-11-05_at_10.40.37.png)

**:hammer\_and\_wrench: Proposed technical solution**

* use /stats endpoint to the inspection api to pull data to display/mine OR use influx idea of Hugo 

**:link: Reference links**

*",3
26701458,2019-11-05 09:41:40.003,Store inway and outway version in use per environment,"### User story

**As a** maintainer
<br>**I want to** store the versions of inways and outways per environment
<br>**so that** I can make better decisions about release management and communicate about them

---

### (Test) scenarios
*Title*<BR>
Given an inway<BR>
When the inway registers itself<BR>
Then the inway will send the version to the directory and that is stored in the database<BR>

Given an outway<BR>
When the outway fetches the inways from the directory<BR>
Then the outway will send the version to the directory and that is stored in the database<BR>

Given the /stats endpoint  
When the /stats endpoint is requested  
Then the raw data is returned to the client

**:white\_check\_mark: Acceptance criteria**

1. all inways and outways in demo, pre-prod and prod are added
1. there must be an endpoint which is used to get the version info


**:hammer\_and\_wrench: Proposed technical solution**

* for the inway we move the inspection of the version from the monitor to the registration
* for the outway we add it as parameter in the request to the directory
* we store both versions in the directory for the inways, we add the version of the outways in a new table
* add /stats endpoint to the inspection api. use this endpoint to add stats to the database and pull data to display/mine OR use influx idea

**:link: Reference links**

* 

",5
26249675,2019-10-23 20:09:51.582,Notify system administrators of updates and breaking changes,"
***Needs a new refinements since this will depend on #867***<br>
New:
* Generate notifications as all notifications in new NLX Management
* Allow users to configure how they want to be notified

---

**As a** system administrator
<br>**I want to** know when I need to update NLX and when breaking changes are introduced
<br>**so that** I can stay secure and up-to-date

**:white\_check\_mark: Acceptance criteria**
 
1. receivers are technical email addresses of inways
1. Is part of the pipeline, we send out a notification when a new release is made
1. must be a distinct list of email addresses (distinct over the three environments - demo, pre-prod and prod)
1. support@nlx.io is the from address
1. fixed email content with a variable latest version inclusive a remark how to unsubscribe
1. add unsubscribed mail addresses table (not in a public repro) which is used to remove those addresses from the mailinglist


**:hammer\_and\_wrench: Proposed technical solution**

* Implement mail job which fetches all inway email addresses and mails a template mail where version and change log link is added.
* auto fill mailing list with email addresses of inways (in the directory)
* its a new component within our cluster
* When we hand out certificates for the demo, pre-prod and prod environment we register one or more contacts

**Not in this story**
* addresses of outways
* for future reference mayne: subscription page, link to this page in the documentation in docusaurus",8
26248978,2019-10-23 19:32:06.256,Revisit the development workflow,"We would like to revisit our current development workflow and make some changes to the CI:

* [x]  Discuss the development workflow
* [x]  Document the changes
* [x]  Make changes to the CI",2
26009369,2019-10-16 15:53:53.585,Fix Let's Encrypt certificate limit on review cluster,"We are hitting the Let's Encrypt domain rate-limit for nlx.io.

- We would like to move reviews to *.nlx.reviews to not impact nlx.io certificate handouts any more.
- We would like to request wildcard certificates for *.nlx.reviews.",2
25914364,2019-10-14 15:26:37.901,Add Review App URL overview page,"**As a** reviewer and/or approver
<br>**I want to** be able to use an overview page with all relevant Review App urls
<br>**so that** I don't have to search for them in the deployment job console logs

---

Right now it's not easy to find the URL's necessary to review and / or approve the Review App deployment. Those are generated by Review App and can be found in de deployment job log. 

**:white\_check\_mark: Acceptance criteria**

1. Create a release specific page with all Review App URL's that are served by Ingress
1. Deploy this page only in case of a Review App deployment
1. Starting a Review App from Merge Request page opens this new page in browser.
1. Don't spend any time on layout, just the URL's in order of deployment will do

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
* ",3
25913737,2019-10-14 15:05:47.461,Optimize build times by parallelisation and caching,"**As a** maintainer
<br>**I want to** see my builds succeed quickly
<br>**so that** I can focus on coding

**:white\_check\_mark: Acceptance criteria**

1. Builds of dependencies are done in parallel
1. Builds of code that does not change are available from cache
1. Significant reduction of build times

**:hammer\_and\_wrench: Proposed technical solution**

* Use Kaniko https://skaffold.dev/docs/how-tos/builders/#dockerfile-in-cluster-with-kaniko
* Check if all Docker layers are cached correctly


**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)",5
25848177,2019-10-11 11:06:18.850,Don't strip data-subjects in outway,"In #694 we discovered that outways strip data-subject headers from calls. This means that the inway cannot log this header, resulting in inability to disclose logs via Insight API.

When fixing this, update the header docs as well.


*Expected behaviour*

* data-subject header should not be stripped

*Actual behaviour*

* data subject is stripped by outway

**:clipboard: Steps to reproduce**

1. (reproducibility is very important)
1.
1.


**:beetle: Cause**

* (if cause is known, details here)
* (if you can pinpoint a piece of code, link to line number)


**:mag: Details**

(Paste any relevant logs - please use code blocks to format console output, logs, and code)

(Add screenshots using `Attach a file`)

---",1
25758193,2019-10-09 10:55:35.090,Replace Hugo docs with Docusaurus,"We'd like to improve our documentation as part of #505.

- replace hugo docs with Docusaurus (Helm charts, Docker images, Skaffold...)
- use documentation files as is in Docusaurus. we can cleanup/style in a next iteration
- add current content as part of the English language
- marketing pagina stays at is
- use default Docusaurus, but use the NLX colors
- keep the current links in the navbar
- tested in Chrome, Firefox and Safari

**For further reference**
- Can and how will we toggle between Linux, Mac OS & Windows environments?
See https://facebook.github.io/react-native/docs/getting-started",8
25594841,2019-10-03 16:50:35.176,Dashboard with NLX in numbers,"**As a** maintainer
<br>**I want to** know how many organisations & services are active on the provided environments
<br>**so that** I have a measure of success and growth

**:white\_check\_mark: Acceptance criteria**

1. Grafana dashboard with graphs per indicator:
* Cumulative number of organisations over time 
* Cumulative number of services over time 
1. Above graphs for every provided environment (test, accept, preprod, prod, demo)
1. Interval is every 24-hours at 06:00
1. Above graphs all with x-axis covering the same date range: from date $first_organisation_in_production_environment until $today
1. Backups will be done as part of #777

---
Example 
![Screenshot_2019-10-03_at_18.22.04](/uploads/fbedacf3a0699ba46f3d3d4b53cb6c5a/Screenshot_2019-10-03_at_18.22.04.png)
1.

**:hammer\_and\_wrench: Proposed technical solution**

* Fetch data using a cron job in Grafana / Influx DB node
* Fetch data using the public Directory API endpoints (/list-organizations, /list-services)

**:link: Reference links**

* https://directory.demo.nlx.io/api/directory/list-organizations
* https://directory.demo.nlx.io/api/directory/list-services

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
* [Ansible roles for the benchmark cluster](https://gitlab.com/commonground/nlx/benchmark)",3
25532915,2019-10-02 08:29:06.783,Extend demo environment,"**As a** potential user
<br>**I want to** see the most important concepts of NLX in action
<br>**so that** I can decide if I want to use NLX

---

Current demo shows Insight API concept with IRMA. We need more demo's, to be able to show every relevant concept in a permanent online environment.

For this, we extend the current demo UI with a navigation structure to browse through several demo's. Each demo 

Let's start with an overview page that, to start with, contains just the insight demo.

**:white\_check\_mark: Acceptance criteria**

1. Permanent online Demo landing page explaining NLX at demo.nlx.io
1. Landing page offers the insight demo as an option, with room to expand
1. In a separate demo repository: https://gitlab.com/commonground/nlx/demo
1. Hosted in its own namespace, but using API's from the demo environment (demo's run with demo certs)


**:hammer\_and\_wrench: Proposed technical solution**

* A separate Helm chart with the name nlx-demo that provides all demo-related components
* This Helm chart is automatically deployed through `.gitlab-ci.yml`
* There are no separate environments for nlx-demo, only one production environment
",8
25297062,2019-09-25 12:29:36.160,Set inway default authorization model to whitelist,"**As an** user
<br>**I want** my inway to use the whitelist authorization model by default
<br>**so that** I don't accidentally publish private APIs to everyone on the NLX network.

**:white\_check\_mark: Acceptance criteria**

1. Inway uses whitelist authorization model by default
1.

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*",1
25296663,2019-09-25 12:21:51.248,Add information about support in docs,"**As a** user of NLX
<br>**I want to** know how to get support
<br>**so that** I don't feel alone when I have a problem

**:white\_check\_mark: Acceptance criteria**

1. Update existing menu item Support
1. Add contact as subpage of Support
1. Add support@nlx.io e-mail to contact page
1. Add https://community.commonground.nl to contact page
1. Add https://gitlab.com/commonground/nlx/nlx to contact page
1. Move common errors to subpagina of support
1. Add link to Support section as part of the navbar (for the marketing website, directory ui, insight ui, docs)

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*",2
25291707,2019-09-25 09:47:52.996,Docs: how to implement whitelist authorization on inways,"**As a** user
<br>**I want to** know how to create an authorization whitelist for my inway 
<br>**so that** I can prevent unwanted access to my API's

**:white\_check\_mark: Acceptance criteria**

1. Description of how use the authorization whitelist functionality of the inway in the docs
1. Just the config via .toml, management UI documentation follows later

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*",2
25101470,2019-09-23 07:04:10.467,Replace IRMA server,"**As a** maintainer
<br>**I want to** move our product to use the new IRMA server
<br>**so that** our demo keeps working

---
Note: related to #750 as the whole relevant code base will be moved there.

**:white\_check\_mark: Acceptance criteria**

1. Use the new IRMA server
1. Purge the old one from our code

---

We got notice from the IRMA team:
```
The irma_api_server is now officially deprecated, and to those still using it this is a last call to move away from the irma_api_server to its successor, the irma server command (see https://irma.app/docs/irma-server/). In particular this means the following:
- The irma_api_server is now no longer able to handle attribute based signatures due to a recent change in how the IRMA app produces these, and this will not be fixed, nor will any other feature or fix be applied to the irma_api_server.
- The privacybydesign/irma_api_server docker image will be deleted one month from now.
```

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*
",2
24944922,2019-09-18 13:15:41.604,Add explanation about config-api and management UI in the NLX ecosystem to docs,"**As an** aspiring NLX administrator
<br>**I want to** know what the config-api and management UI are
<br>**so that** I can use them to my benefit

**:white\_check\_mark: Acceptance criteria**

1. Documentation about what the config-api and management UI are
1. Documentation about how to install

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)

**Acceptance by:** Eelco",3
24944899,2019-09-18 13:15:09.576,Add explanation about IRMA / insight-api in the NLX ecosystem to docs,"**As an** aspiring NLX administrator
<br>**I want to** know what IRMA and the insight-api are
<br>**so that** I can use them to my benefit

**:white\_check\_mark: Acceptance criteria**

1. Information about the role of IRMA and the insight-api in the NLX ecosystem

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
* 

**Acceptance by:** Eelco",3
24942396,2019-09-18 13:01:20.264,Add basic-auth to management ui in Traefik,"**As a** developer/ops
<br>**I want to** restrict access to the management ui's of our voorbeeld organizations
<br>**so that** hackers have no joy

**:white\_check\_mark: Acceptance criteria**

1. Add basic auth to traefik Ingress
1. Sub-domain  management.* requires authentication

**:hammer\_and\_wrench: Proposed technical solution**

Traefik ingress annotations:
```
    ingress.kubernetes.io/auth-type: basic
    ingress.kubernetes.io/auth-secret: ""basic-auth""
```

Secret:
```
apiVersion: v1
kind: Secret
metadata:
  name: basic-auth
  namespace: <namespace where the ingress lives>
type: Opaque
data:
  auth: #base64 encoded user:password as htpasswd
```

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)

**Acceptance by:** Geert",2
24941927,2019-09-18 12:47:29.335,Configure insight/irma in the management UI,"**As a** user
<br>**I want to** configure insight/irma for my organization
<br>**so that** users can view log records that contain attributes they own.

**:white\_check\_mark: Acceptance criteria**

1. insight-api address is configurable in the management UI, values are saved to the config-api/etcd.
1. IRMA server address is configurable in the management UI, values are saved to the config-api/etcd.
1. Create new API call on directory-registration-api, to modify organization-level values such as irma-api, insight-api
1. Let config-api use new directory-registration-api method to update organization-level values.

**:hammer\_and\_wrench: Proposed technical solution**

*

**:link: Reference links**

* [Project Definition of Done](https://gitlab.com/commonground/nlx/nlx/blob/master/CONTRIBUTING.md#4-2-definition-of-done)
*",5
24696576,2019-09-11 16:10:21.655,Further reading subsection is empty,"Further reading menu items shopws not the expected list of pages

*Expected behaviour*

* https://docs.nlx.io/further-reading/ should show a list of all child items

*Actual behaviour*

* Shows just 1 item

--- 

Depends on move to Gatsby, suggestion to do this first

**:clipboard: Steps to reproduce**

1. Go to https://docs.nlx.io/further-reading/ 

**:beetle: Cause**

* (if cause is known, details here)
* (if you can pinpoint a piece of code, link to line number)


**:mag: Details**

(Paste any relevant logs - please use code blocks to format console output, logs, and code)

(Add screenshots using `Attach a file`)

---",1
24461545,2019-09-04 13:16:24.807,Upgrade organization helm chart to start config-api and use it from inway,"* Enable config-api for RDW
* Add k8s Job to reset etcd data and insert services into etcd using nlxctl
* Enable config-api for inway in RDW",3
24460960,2019-09-04 13:03:44.207,"Move ""Compliancy with EU regulations"" page to compliancy section","**As a** PO
<br>**I want to** see the Compliancy with EU regulations page moved
<br>**so that** it doesn't distract from the clear documentation

---

**:white\_check\_mark: Acceptance criteria**

1. Move page to a new ""Compliancy"" section
1. Format .md to make the layout better readable   (@spreeker made this already)

Current docs: https://docs.nlx.io/introduction/compliancy/",1
24458860,2019-09-04 12:01:26.137,Configure PKI-O EV certificates on www.nlx.io,"**As a** end-user
<br>**I want to** have EV certificates on www.nlx.io
<br>**so that** it looks more secure

**:white\_check\_mark: Acceptance criteria**

1. EV certificates are configured on www.nlx.io

![image](/uploads/6b15cc56994476ab01a0f0785156f8f4/image.png)",1
117592401,2022-10-26 09:32:22.439,Bug: OIDC token to big for cookie store,OIDC tokens can become larger then 4kb which is the maximum size for a  item in the cookie store. Currently Gemeente Utrecht is reaching this limit. We should store a reference to the token in the cookie store and store the complete token in the database.,5
116639021,2022-10-11 08:23:10.334,Write delegation transaction log record in the consumer log too,The information is available in the DB & API. The info should be shown in the UI.,2
116560595,2022-10-10 08:23:45.037,Rework feedback when synchronisation of access request fails,"**As a** _user_
<br>**I want** _goal_
<br>**so** _purpose_

The toasters showing an error when synchronizing access requests are currently too intrusive for the user.

**:white\_check\_mark: Acceptance criteria**

1. Do not poll the synchronization endpoint for the service detail pane (overview page only is sufficient)
1. Show a warning icon in the 'Access' column, when an organization is not reachable
1. Remove all toasters as feedback
1. In the service detail pane, display a warning icon and reason why synchonization failed
1. Ensure we only poll once every 3 seconds. Currently the poller starts multiple times when opening / closing the detail pane. Or opening / closing the directory overview page.


Voorstel feedback:

- Interne fout: raadpleeg eigen systeembeheerder
- Geen organisatie Inway bekend bij `<org x>`
- Organisatie Inway van `<org x >` niet bereikbaar
- Interne fout bij `<org x>`

**:link: Reference links**

1.",5
116326542,2022-10-05 14:14:44.923,Include transaction log in the E2E tests,"We do not validate the creation of transaction logs in our E2E this has caused a bug like https://gitlab.com/commonground/nlx/nlx/-/issues/1630 to be possible. 

In a perfect world we should test that:

1. The consuming org creates a transaction log record with the direction `out` 
2. The providing org creates a transaction log record with the direction `in`
3. In case of delegation a transaction log record should contain ""x on behalf of y""",5
115760724,2022-09-26 08:11:35.843,Document how to add a new role via the DB,- document that we might add permissions in the future and where to find these (link to go-file),1
115760480,2022-09-26 08:06:58.437,Document how to add a user with role to Management,"^ To start, choose a template",1
114018802,2022-08-29 10:58:40.416,Remove scheduler,"**As a** user
<br>**I want** _goal_
<br>**so** _purpose_


_Chosen solution: NLX management takes over the job of the scheduler_

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Create access request
2. Revoke access request
3. Sync access request state
4. Retrieve access proof
5. Add an order should still work

**:white\_check\_mark: Acceptance criteria**

1. Scheduler for access requests should be removed
1. Management UI, directory overview: should display checkmark if at least one Outway has access to the service (poll every 5 seconds)
1. Management UI, directory service detail: should display access status per Outway  (poll every 5 seconds)
1. Update documentation in `technical-docs/sequence-diagrams`

**Technical notes**

- add API endpoint to synchronize the access requests.
- re-fetch service details if the synchronization was successful
- update E2E tests to execute the synchronize API endpoint if a request has been updated
- Move logic for sending an access request from the scheduler to the send call

**:link: Reference links**

1.",13
113616265,2022-08-22 09:02:29.187,Change implementation of NLX error messages,"**As a** implementator of the NLX standard
<br>**I want** to know which error messages I should return
<br>**so** that I can implement the standard.

NLX added error codes and error messages to the components see issue https://gitlab.com/commonground/nlx/nlx/-/issues/1557. With the chosen implementation all the possible error codes are contained in a single file which makes it easy for anyone implementing the standard to get a overview of the error codes. 

The actual error message is not part of the standard. The fields with extra information are. 
This allows implementors to define error messages in their own language. But we ensure all relevant fields are provided by the standard.

Example: `permission denied, organization <ORG> or public key fingerprint <PUBLIC_KEY> is not allowed access.`

`<ORG>` and `<PUBLIC_KEY>` are defined in the standard required to be part of the message.

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Move error messages to the same file as the error codes

**:link: Reference links**

1.",3
113284568,2022-08-15 11:18:29.241,OIDC: correctly handle different notations of the audience in the Access Token,"Dex stores the audience as a string in the Access Token, Keycloak stores it as an array of strings. Both approaches are valid but the Management API can only handle the audience as a string. We should fix this.

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. 

**:link: Reference links**

1. https://github.com/coreos/go-oidc/blob/2d47dd95152744f41009de5797efe6cc07832a41/oidc/oidc.go#L475",2
111845845,2022-07-19 10:11:47.388,"Update ""Request a production certificate"" section of the docs","The current Openssl command doesn't add a SAN to the CSR. Go has deprecated the CommonName field in the certificate and uses the SAN instead. Without a SAN go cannot validate the certificate. 

New command (openssl 1.1.1 required): 

```
openssl req  -addext ""subjectAltName = DNS:mijn.inway.nl"" -utf8 -nodes -sha256 -newkey rsa:4096 -keyout org.key -out org.csr
```",1
111765099,2022-07-18 07:31:32.319,Remove Outway in NLX Management,"**As a** NLX user
<br>**I want** to remove an Outway in NLX Management
<br>**so** that I can remove the second Outway entry that appears after I change the name of the Outway

This is feedback from Wego4it from the Hackathon.

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**



**Technical proposal**

- add API endpoint to remove Outway
- Add remove button to Management UI
- Make sure only admin is allowed to perform this
- Add E2E test

**:link: Reference links**

1.",5
111564671,2022-07-13 08:48:11.952,Run txlog-api migrations in Helm chart,"**As a** NLX user
<br>**I want** that txlog database migrations are done when I update my Kubernetes deployment to the latest version
<br>**so** that I can automate updating my deployment

Currently the txlog database migrations are done by manually running a job in Kuberenetes for which we provide a template( `technical-jobs/txlog-api-job-migrations.yaml`). This makes automating NLX deployment updates not as easy as it could be. 


**:desktop_computer: How to demonstrate / e2e test(s):**

1.

Technical solution:

Use the same approach as the Managment API; Include running the migrations in the txlog-api binary and add it as a init container to the txlog-api deployment chart. 

**:white\_check\_mark: Acceptance criteria**

1. 

**:link: Reference links**

1.",3
111107605,2022-07-04 08:31:01.491,Inject NLX headers for clients who do not include them,"Not all clients are able to add the correct NLX http headers to the request to the Outway. although we prefer that the client provides them themselves, a client which can't be changed for whatever reason still needs to be able to work with NLX. Old vs new principle. So in NLX management a sort of general header config per service should be possible which adds the headers to the request. 

The outway must have this general config in memory and apply it when necessary. 

Add documentation page similar to the [url rewrite](https://docs.acc.nlx.io/reference-information/rewrite-base-url) in which we provide a example of a proxy that adds order headers to the request.",3
110526921,2022-06-22 07:19:42.344,Automate updating NLX version numbers in the example Helm value files,"Docs: https://docs.nlx.io/try-nlx/helm/preparation

Use Semantic Release to update these values when tagging a new release.
We already have a script in place for the charts.",2
110464455,2022-06-21 09:57:09.740,Update Bitnami PostgreSQL chart  in NLX Try Me,"We currently use version 10.x.x of the bitnami postgres chart in the Try Me guide. Our guide is incompatible with the latest version of the bitnami postgres chart.

Release notes v11: https://docs.bitnami.com/kubernetes/infrastructure/postgresql/administration/upgrade/

Docs: https://docs.nlx.io/try-nlx/helm/postgresql

Check the NLX Haven add-on too.

Once the upgrade is completed, we should upgrade to future versions as part of the maintenance maister job.",5
110283848,2022-06-17 10:00:44.413,Add docs on re-writing OpenAPI spec base URLs,"Add Nginx-template + Dockerimage file for the 'madrid-proxy'.
These have been added to the MR for the OGC demo, see https://gitlab.com/commonground/nlx/nlx/-/merge_requests/3680


1. Move relevant files to separate repo
2. Link to the repo in the docs as part of 'Reference information'
3. Done",2
110283793,2022-06-17 09:59:50.611,Test GRPC through NLX,"Test locally using a local gRPC service. The result of this test should be a yes/no.

If no: Create a new issue with changes needed to make NLX support gRPC.
If yes: create movie to proof we support gRPC

**Out of scope:**

- add test to demo-environments",3
109863875,2022-06-09 15:20:13.222,Add fixed error codes to nlx error messages,"We created a clear distinction between NLX errors and API errors. Now add fixed error codes to the error messages and document that fixed list of error codes with a description so that clients can process based on fixed codes in stead of possibly changing descriptions. 

When the Outway/Inway returns a NLX specific error message (status code 540), the body of the response should contain both an error message and an error code. All the possible errors should be in 1 file so we have a clear overview.",8
108681215,2022-05-17 12:51:23.481,RBAC for NLX Management,"**As a** NLX user
<br>**I want** a flexible RBAC system
<br>**so** that I am able to setup roles which match my organization structure 

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Actions which are possible with the Management API are translated to permissions
1. Assign permissions to the admin role 
2. API endpoint should check if the endpoint can be used by the authenticated user/role
3. Enable passing credentials to NLX CTL (to pass to the API) (figure out if this should be a JWT or something else)
4. Basic auth should keep working


**Technical notes**

1. Assign a key to every API-endpoint / page in UI. These can then be assigned to roles. Eg. `permissions.service.add`.

**:link: Reference links**

1.",21
108677686,2022-05-17 11:52:48.476,Add more users to Dex,"- currently, we only have 'admin'
- add extra users with the same role as 'admin'.

Add locally, for review and acc.

Add script to easily add new users (on the fly during the hackathon) (with admin or read-only role)",3
108615249,2022-05-16 13:43:52.945,Add OPA to demo setup,"**As a** NLX promoter
<br>**I want** to be able to demo the OPA integration
<br>**so** that I can show people how the OPA intergration works

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Add a client secret to the parkeerrechten admin interface
2. If a request fails because of OPA the error message in the UI should reflect that
3. Add links to `auth-opa/inway`and `auth-opa/outway` to the links page

**:link: Reference links**

1.",3
108227027,2022-05-09 08:32:07.973,Als gemeente Stijns wil ik alle inwoners van alle gemeenten kunnen zien,"**As a** gemeente Stijns
<br>**I want** alle inwoners van alle gemeenten kunnen zien
<br>**so** we can use this during the hackathon

**:white\_check\_mark: Acceptance criteria**

- [x] replace current [demo basisregister-fictieve-personen API (Flask)](https://gitlab.com/commonground/nlx/demo/-/tree/main/basisregister-fictieve-personen) with a CRUD API (Golang)
- [x] introduce a database (simple scheme, put all data in a single column of type JSON)
- [x] the current API should still work (GET `/natuurlijke_personen`)
- [ ] introduce UI which lists all records from the fictieve-personen-api for the current municipality

---

**Out of scope**

- [ ] return the address of a persoon [in the same format as Haal Centraal](https://vng-realisatie.github.io/Haal-Centraal-BRP-bevragen/swagger-ui#/Ingeschreven%20Personen/GetIngeschrevenPersoon) (search for `verblijfplaats`)

**:link: Notities**

1. UI bij Stijns, API bij RvRD",5
106573454,2022-04-13 09:42:01.766,All errors which an Outway can receive when working with orders,"^ To start, choose a template",8
106572528,2022-04-13 09:25:47.506,Make clear separation between NLX errors and API errors,"Use the following HTTP status codes for the http endpoint on the NLX outway so that the apis calling the outway know that it's a NLX error instead of a error from the service itself.
  - ~~502~~ 540 Bad Gateway - The server was acting as a gateway or proxy and received an invalid response from the upstream server.
  - ~~504~~ 541 Gateway Timeout - The server was acting as a gateway or proxy and did not receive a timely response from the upstream server.
  - 542 Unauthorized - 

~~We also could use the [`Proxy-Status`](https://tools.ietf.org/id/draft-ietf-httpbis-proxy-status-01.html#rfc.section.2) header, but its still a draft~~

Current possible errors:
- 400 Bad Request
- 401 Unauthorized
- 500 Internal Server Error
- 501 Not Implemented
- 503 Service Unavailable

Proposal:
540 - 559 reserved codes for NLX
- 540 Bad Request
- 541 Unauthorized
- 550 Internal Server Error
- 551 Not Implemented
- 553 Service Unavailable

Or just one reserved code:
- 540 NLX Gateway Error",5
106442361,2022-04-11 11:43:46.281,Use sqlc in the directory API,"Use sqlc in the directory API so that the strucs needed to communicate with the database are auto-generated.

The same setup should be used as in the txlog-api.",8
105817045,2022-03-31 11:52:09.120,Upgrade React to v18,"# TODO

- decouple management ui from shared eslint config
- decouple directory ui from shared eslint config
- decouple design system from shared eslint config
- upgrade design system to react v18
- upgrade management ui to react v18
- upgrade directory ui to react v18

---

[React v18](https://reactjs.org/blog/2022/03/29/react-v18.html) has been released, we should upgrade from v17 to v18.

However, there's a couple of projects tight together, which requires a coordinated effort in order to upgrade.

There's other dependencies that come along with this upgrade. Eg. `@testing-library/user-event`, `jest`, Create React App etc.

Projects that should upgrade first:

- https://gitlab.com/commonground/core/eslint-config
- https://gitlab.com/commonground/core/eslint-config-cra-standard-prettier

Then:

- https://gitlab.com/commonground/core/design-system

Then:

- https://gitlab.com/commonground/nlx/demo (contains multiple UIs)
- https://gitlab.com/commonground/nlx/nlx.io
- https://gitlab.com/commonground/nlx/nlx (contains multiple UIs)",8
104991312,2022-03-17 10:24:00.729,Enable configuring the Management API proxy address separately from the Organization Inway address,"**As a** user
<br>**I want** to be able to use a single predictable port (`443` or `8443`) for my Inway and the management traffic going through the Inway
<br>**so** I can use my current setup using Otomi don't have to expose a custom port (port+1) for NLX

Currently, the Management API proxy address is derived from the Organization Inway address (port + 1).

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. When registering an Inway to the Directory, the Management API proxy address must be registered separately from the Organization Inway address
1. The management API proxy address flag should be required
1. The Inway data and management addresses stored in the directory should include portnumbers 
1.  I want to be able to expose both the Inway and the Inway Management API proxy on the same port and use domainnames to differentiate traffic. (eg. the Inway is registered at `https://my-inway.gemeente.nl` and the Management API Proxy is registered at `https://my-inway-proxy.gemeente.nl`)
1. Document extra flag in the commit message in such a way that it is clear to our users how they can use the new flag when upgrading (eg. clearly state the required upgrade path in the commit)
1. Ensure Try me is updated accordingly

**Proposed workflow**

1. Build this
1. Ensure its not a breaking change (keep track of time) (except for orders)
1. Release

Note: the estimation of this issue is without the work for making it non-breaking

**Remaining questions about breaking changes:**

- what if (existing) Inways do not register a management API Proxy address to the directory?


**:link: Reference links**

1.",8
104860713,2022-03-15 15:46:59.543,Implement auth plugin for the Outway,"We have implemented the auth plugin in the Outway so that it can communicate with an OPA server. Implement the same plugin for the Inway and make Outway auth plugin production ready.

Include demo of OPA-server for the demo environment for the Parkeervergunningen Admin.

Enable stripping custom headers for requests from the Outway to the Inway. So the headers can be used by OPA but not intercepted by the Inway.

- [ ] add tests
- [ ] change docs
- [ ] include links to OPA-server to the links overview page

The same should happen for the Inway as part of #1502+",8
100843071,2022-01-18 13:50:30.441,Implement E2E-tests: access a service using an outway,"**As a** user
<br>**I want** to access a service using an outway
<br>**so** ?

**:desktop_computer: How to demonstrate / e2e test(s):**

```gherkin
Scenario: Access a service using an outway
    Given ""Gemeente Stijns"" has an outway
        And ""Gemeente Stijns"" has access to ""basis-register-fictieve-kentekens"" of ""RvRD""
    When the outway of ""Gemeente Stijns"" calls the service ""basis-register-fictieve-kentekens"" from ""RvRD""
    Then ""Gemeente Stijns"" receives a successful response
```

**:white\_check\_mark: Acceptance criteria**

1. Implement the scenario as described above

**:link: Reference links**

1.",5
100842522,2022-01-18 13:42:34.845,Implement E2E-tests: use an order to access a service,"**As a** user
<br>**I want** to use an order access a service from the Management UI
<br>**so** ?

**:desktop_computer: How to demonstrate / e2e test(s):**

```gherkin
Scenario: Use an order to access service
        Given ""Vergunningsoftware BV"" has the default Outway running
            And ""Vergunningsoftware BV"" has an active order with reference ""order-ref-1"" from ""Gemeente Stijns"" for service ""basis-register-fictieve-kentekens"" of ""RvRD""
        When the default Outway of ""Vergunningsoftware BV"" calls the service ""basis-register-fictieve-kentekens"" via the order of ""Gemeente Stijns"" with reference ""order-ref-1""
        Then ""Vergunningsoftware BV"" receives a successful response
```

**:white\_check\_mark: Acceptance criteria**

1. Implement the scenario as described above
1. Extract multiple gives from a single given
1. Update previously created scenarios to use the extracted givens

**:link: Reference links**

1.",5
99083487,2021-12-15 13:04:02.907,Self healing managmentAPI settings to directory,"**As a** NLX participant
<br>**I want** the directory to be fully self healing for inways, outways and organizational information
<br>**so** when the directory is available again after failure, all the necessary information will be automatically added again and peace is restored in the land of NLX

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. organizational email address is send to the directory periodically
1. test scenario: remove a previously added email address and see if it will return again
1. same sync period as inways and outways

**:link: Reference links**

1.",5
98670554,2021-12-08 13:35:28.936,Add simple acceptance of NLX Terms & conditions to NLX management,"**As a** NLX maintainer 
<br>**I want** to be able to explicitly accept the NLX terms and conditions for this NLX ecosystem
<br>**so** I announce that I'm participating and accountable for my own organization 


**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**


1. After login in, a user should see the Terms & Conditions (T&C) screen if they have not yet been approved for the organization of this Management API
1. When a user clicks 'Approve', this should be stored in the Management API
1. An audit log should be added when approving the T&C
1. The Directory API should accept an URL where the T&C are hosted
1. If this URL is not specified, the T&C should not be shown after authentication
1. Add E2E test for accepting T&C
1. This change should be communicated to NLX demo users
1. Update docs to include approving T&C

**:link: Reference links**

![_todo__Terms_of_use](/uploads/1e50ecf2701ae998c2529a5cd554b905/_todo__Terms_of_use.png)
[Gebruiksvoorwaarden_NLX_maart_2020.pdf](/uploads/97a8a5a52b375353653138ecefe32491/Gebruiksvoorwaarden_NLX_maart_2020.pdf)",8
97873935,2021-11-24 11:34:16.232,Register organization email address,"**As a** NLX user
<br>**I want** to know if there is a (breaking) change upcoming
<br>**so** that I can make sure my NLX setup keeps working

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Add field for organization email address in NLX management
1. Show BIG modal in NLX management while the organization email address is empty
1. The organization email address should be stored in the directory
1. Describe the organization email field in the docs

**:link: Reference links**

1.",5
97871328,2021-11-24 11:01:15.862,Inway and Outway directory registration,"**As a** NLX user
<br>**I want** see which organizations are using this NLX network
<br>**so** that I can determine the value of this NLX network for my organization.

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Of an outway the following information is stored in the directory:
 * Organization
 * Outway name
 * Version
 * Created at
 * Updated at
1. Add overview to directory UI
1. The overview displays a list of organizations participating on the NLX network
1. For each organization is displayed whether the organization offers services, consumes services or both.


![Screen_Shot_2021-11-29_at_10.17.09](/uploads/59304333e22ae897afcd7f70718e9510/Screen_Shot_2021-11-29_at_10.17.09.png)
column width:
- organization widest
- date only what's needed
- inways, outlays and services all the same width

**:link: Reference links**

1.",8
97814622,2021-11-23 14:27:52.026,Implement E2E scenarios,"We have descripted several E2E scenarios using gherkin(https://cucumber.io/docs/gherkin/). These scenaro's should be implemented using the Cucumber framework.

We implemented the e2e scenario for creating the a service using Playwright but we decided we want to switch to Selenium because Selenium supports more browsers and offers support for running the test in paralel.

**:white\_check\_mark: Acceptance criteria**

1. Use Selenium
1. All Givens should use the management API directly instead of using the browser (recommented by Selenium because the browser is slow https://www.selenium.dev/documentation/test_practices/overview/)
1. Rewrite the Playwright implementation for ""Create Service""(`testing/e2e/src/steps`) with Selenium 
1. The test should run in the pipeline
1. Scenarios should run independend from eachother
1. Try to use our BrowserStack account to setup the tests with BrowserStack. If this does not work use Selenium images.
1. Update BrowserStack account to teamcore@vng.nl
1. Add browser image to the dev docker compose file so we can run the test localy.  
```
browser:
    image: selenium/standalone-chrome:4.1.1
    shm_size: 2gb
    ports:
      - 4444:4444
```

The following scenario's should be implemented:
1. Delete an inway  #1458
1. Unset organisation inway #1459
1. Create an order
1. Create a service
1. Delete a service #1460
 
An example of how to use Cucumber in combination with Selenium: https://github.com/browserstack/cucumber-js-browserstack. Please note this example uses BrowserStack which we won't use so any configuration regarding BrowserStack in this example can be ignored.",13
97529259,2021-11-18 08:14:35.799,Request access for a certificate,"**As a** NLX user
<br>**I want** to select the certificate for which I want to request access
<br>**so** that specific certificate is included in the access request.

### How to handle the UI part of it 
1. directory
- the quick action button is removed
- the status column only contains errors/warnings of one of underlaying the access requests 

![directory](/uploads/12aea0bd1072b0ea5a2a2c153a6869d3/directory.png)

1. Service detailpage

![Group_52](/uploads/23bf7d0d6de5b354ce08ae6d40176704/Group_52.png)

1. Access request confirmation modal

![accessrequest-modal](/uploads/82590125f2bd3995ea5ef42ba68e45b7/accessrequest-modal.png)


**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. If a organization does not have an outway, when opening the service detail view we should display a message something like ""Please configure a outway to request access""

TODO:

1. [x] Include certificate in RequestAccess call
1. [x] Include certificate in GetAccessRequestState call
1. [x] Include certificate in GetAccessProof call
1. [x] Include certificate fingerprint in ListAccessGrantsForService call
1. [x] Include certificate fingerprint in ListIncomingAccessRequests call
1. [x] Include certificate fingerprint in ListOutgoingAccessRequests call
1. [x] For an access proof retrieve outways attached to a certificate
1. [x] Add certificate fingerprint to the outway database table
1. [x] Remove stacktrace from front-end
1. [x] The get service detail call should include a array of access requests and access grants instead of a single object
1. [x] Add access per certificate to orders on the back-end
1. [x] Update plantuml if necessary
1. [x] implement UI for listing outways with / without access
1. [x] implement UI for confirming requesting access
1. [x] display error message on directory if one of the access requests failed to send
1. [x] enable selecting outway / public key fingerprint with service when adding an order
1. [x] claim per service
1. [x] restrict selecting only a single Outway per service when creating an order (FE & API)
1. [ ] When in a eco system of old, pre-this-change versions, the eco system should continue to work
1. [x] Add extra Outway & certificate to dev, review and acc environment, so we can test this functionality

TODOs after merging the MR:

1. [ ] Update sequence diagrams for ordeders, see epic: &27+


**Test scenario for backwards compatibility**

> bestaande verbinding -> ene partij doet upgrade -> verbinding zou moeten blijven werken

```
      // 1.
      // review cluster weggooien
      // alle deployments deployem voor 0.124
      // access request maken & goedkeuren voor een service (gemeente stijns moet toegang hebben tot rvrd)
      // order toevoegen en testen met curl (toegang tot rvrd delegeren naar vergunningsoftware)
      // handmatig via k9s de directory updaten naar de review tag (2d6b6fb9) [van registry.nlx.reviews/commonground/nlx/nlx/nlxio/management-api:2d6b6fb9]
      // controleren of we met het toegangsverzoek nog steeds toegang hegbben
      // handmatig via k9s de rvrd updaten naar de review tag (2d6b6fb9) [van registry.nlx.reviews/commonground/nlx/nlx/nlxio/management-api:2d6b6fb9]
      // toegang rechtstreeks & via order testen
      // -> rechtstreekse toegang werkt. toegang via order faalt, de outway laat weten: 'nlx-inway: no access'. vermoedelijk omdat de structuur van de claim is aangepast.

      // 2.
      // review cluster weggooien
      // alle deployments deployem voor 0.124
      // access request maken & goedkeuren voor een service (gemeente stijns moet toegang hebben tot rvrd)
      // order toevoegen en testen met curl (toegang tot rvrd delegeren naar vergunningsoftware)
      // handmatig via k9s de directory updaten naar de review tag (2d6b6fb9) [van registry.nlx.reviews/commonground/nlx/nlx/nlxio/management-api:2d6b6fb9]
      // controleren of we met het toegangsverzoek nog steeds toegang hegbben
      // handmatig via k9s de gemeente stijns updaten naar de review tag (2d6b6fb9) [van registry.nlx.reviews/commonground/nlx/nlx/nlxio/management-api:2d6b6fb9]
      // toegang rechtstreeks & via order testen
```




** Questions **

1. Can we keep the history of access requests/grants in the auditlog? 
1. This will either be  breaking change or we need to add if/else to most calls concerning access request/grants. If we decide to make this a breaking change it will only affect setups were the consumer and provider use a different version of NLX. This has been discussed during our review. Conduction was the only stakeholder with active NLX installations. Their response: Mag een breaking change zijn, dan is het duidelijk voor iedereen.
Alleen last van voor demodam,  maar dat cluster ligt er momenteel uit, dus momenteel geen last van. Als het weer up gaat, dan zal Robert updates moeten doorvoeren.

1. Should requests between NLX components contain the version of the component? This information could be used to give our users more specific error messages.
 

**:link: Reference links**",21
97356866,2021-11-15 13:58:25.806,The organization owning the outway must be able to revoke access,"It is not possible for a consumer to 'quit' or 'cancel' and ongoing access request. This potentially result in unnecessary activities (time spend by the owner of the service to assess the request) and when something is wrong at the owner side (the Inway) an access request with an error state will exists indefinitely (or at least until the owner fixes its problem). In order to have control over the access requests, it's necessary to be able to delete an request. Since you might delete a request which was actually already granted by the owner (the consumer just doesn't know that yet), it must also be possible to then cancel access from the consumer side of things. And if that's an option, then we just as easily can add that functionality to the UI making it explicitly possible.


Acceptance criteria:
- Add two buttons
    - one for cancelling access as a consumer (when you already had access)
       - must result in removing the access grant and maybe the proof -> figure it out
       - showing the correct status for the access of the specific outway -> back to no access again with the messages/status access cancelled by 'Ingetrokken door [user]' including time stamp
       - adding an audit log entry at the consumer side 
       - add the request access button

    - one for canceling an access request as a consumer
       - The cancelling access request button is only visible when at the supplier side the access is not granted (could be that the revoke action hasn't synchronized yet)
       - remove the access request on both sides
       - add audit record 
       - the status of the access of the specific outway must be No access including 'geannuleerd door [user]' and a timestamp
       - add the request access button

- Add end to end tests
- Check and update documentation when necessary

TODO:

- [x] Make split in audit log between action start and action end
- [x] Add database integration tests
- [x] Update Management UI
- [x] Update Inway
- [ ] Syncer moet approved access state niet opniuew updaten
- [x] Sequence diagram
- [ ] Check if there are changes to convert GORM to sqlc",13
97347326,2021-11-15 12:53:31.441,Add serialnumber to CSR,"As a NLX demo user
I want to be able to add the subject serialnumber to my CSR
So that I am able to predict my URL's

Acceptation Criteria 
- [x] Add instructions on how to add a subject serial number in the docs
- [x] Add instructions on how to add subject serial number to an existing CSR
- [ ] Communicate this change to team Haven
- [x] The certportal should use the subject serial number in the CSR. If there is no subject serial number present, generate a random serial number
- [x] Verify that access requests still work after adding a subject serialnumber to an existing CSR. (DOES NOT WORK)",3
97217641,2021-11-12 08:06:54.619,Help user distinct own services from other services,"**As a** NLX management user
<br>**I want** to have a clear distinction between my own services and those from others
<br>**so** I can easily find the service I'm looking for

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Open NLX management
1. See button 'Mijn services'
1. Click on that button
1. See the page name 'Mijn services'
1. See button 'Directory'
1. Open Directory
1. See that the organization name of your own services is yellow. The others are the original color

**:white\_check\_mark: Acceptance criteria**

1. Services vertalen naar Mijn services
3. Color the organization name of my own services yellow in the directory

**:link: Reference links**

1.",2
96502327,2021-11-01 09:59:20.918,Remove an inway using the NLX management UI,"**As a** system manager
<br>**I want** to be able to remove inways
<br>**so** that unused inways are no longer visible in NLX management

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Add delete button to the Inway details screen
1. Ask for confirmation before deleting the inway
1. If the inway is still offering services display this in the confirmation dialog
1. If deleted inway is the organization inway and your are still offering service display the ""No organization set"" warning.    

**:link: Reference links**

1.",5
96246525,2021-10-27 12:03:06.184,Refactor database layer to adapters in the directory API,"**As a** NLX developer
<br>**I want** seperate my database logic from my business logic
<br>**so** that the project remains easy to maintain

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Split database and business logic into seperate layers
1. Add postgres folder to adapter folder


 ![Schermafbeelding_2021-10-27_om_13.59.42](/uploads/a38c4f4efa9007f241f152c822465e12/Schermafbeelding_2021-10-27_om_13.59.42.png)

**:link: Reference links**

1.",5
95352982,2021-10-13 11:52:38.191,Create workaround for Earthly,"Currently, using `earthly +all` fails on Mac OS.
Create a Docker image with the prerequisites installed, which can be used to generate the same files.",3
95351162,2021-10-13 11:26:34.273,Add Parkeerrechten admin & viewer to ACC,"So we can test the order flows on ACC and include these test scenario's as part of our definition of done.

Make sure the DNS-records for the demo-gemeente's are added.

Research if we can introduce a wildcard DNS-record for the domains.",5
95345193,2021-10-13 09:57:39.831,Do not require trailing slash for outway URLs,"**As a** NLX user
<br>**I want** my request to work when I do not add a trailing slash
<br>**so** that I do not get confused when my URL seems correct but fails

requested by steven gort

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. `localhost/12345678901234567890/servicename` should work
1. `localhost/12345678901234567890/servicename/` should work

**:link: Reference links**

1.",3
94524020,2021-09-29 10:14:26.438,Create database fixtures using our own repository interfaces in the directory API,"**As a** developer
<br>**I want** to add test data for our database integration tests using our own repository interfaces
<br>**so** that we do not depend on a specific database

Additional benefits:

* We can safely run our database integration tests in a transaction which allows us to run the test in parallel without running the directory inspection API and directory registration API tests in different databases. 
* We no longer depend on an external tool to add our test data (https://github.com/go-testfixtures/testfixtures/)

**:desktop_computer: How to demonstrate / e2e test(s):**

1.
2. 
**:white\_check\_mark: Acceptance criteria**

1. 

**:link: Reference links**

1.",8
94446055,2021-09-28 12:21:55.873,View latest transaction log records in NLX management,"**As a** NLX maintainer
<br>**I want** to have access to the latest transaction logs
<br>**so** I can see what's currently going on

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**
- [x] Enable getting the transaction log via the application-overview page (add link per organization)
- [x] Transaction log API returns records as JSON / GRPC
- [x] Add connection string to the managementAPI as a flag
- [x] The page should tell the user that he/she didnt activate the transaction logging 
- [x] Show the latest 100 records in NLX management (Make sure this is communicated to the user -> if easy peasy cheap: then use the variable containing the limit... otherwise just type it in the text*)
- [ ] Change the transaction documentation
- [x] Change the management API documentation in the guide
- [x] Change the current Logs icon in the UI to: Audit log
- [x] Add new logs icon with the text: Transactions log
- [x] Use internal certs as authorization on the API 

* text above: De laatste 100 records in de transaction log van jouw in- en outways

**row must resemble:**  
tijd | binnenkomend van | organisatie | service   
tijd | uitgaand naar    | organisatie | service

**:link: Reference links**

1. https://links.acc.nlx.io",13
93711089,2021-09-15 11:55:38.611,Document the usage of subject serialnumber,"Request a demo certificate
* describe that the serialnumber is used by NLX as the organization identifier
Provide an API
* update URLs used in `Quering your own API's` section

Request a production certifiate
* describe that the serialnumber is used by NLX as the organization identifier

_For Subject.SerialNumber specification, see https://gitlab.com/commonground/nlx/nlx/-/issues/1376_",2
93711034,2021-09-15 11:54:37.055,"Use subject serialnumber in the Inspection API, Management API, Inway and Outway","Directory Inspection API + Management API + Inway + Outway

**Acceptatie criteria**

- [ ] The directory inspection API returns serialnumber in the ListServices call
- [ ] Outway should use serialnumber to find services
- [ ] The serial number should be added to access request and orders (later on we will display these in the UI)

Directory-inspection-api
* return serialnumber in list services call

Management-api
* add serialnumber to access_requests_incoming
* add serialnumber to access_requests_outgoing
* user serialnumber as organization identifier in access grants
* use serialnumber as delagatee in orders
* use serialnumber in order_services

Management API & UI
* Replace the inputfield of organization name with subject serialnumber when creating an order
* Use subject serialnumber to create an access request
* add serialnumber to auditlogs

Inway 
* store serialnumber in TX log
* the check if there is an access grant for an organization should happen on serialnumber instead of organizationname
* the check if a received claim is owned by the sender should happen on serialnumber instead of organizationname

Outway
* parse serialnumber from url
* use serialnumber as identifier in the hashmap for services
* store serialnumber in TX log
* use serialnumber to retrieve order token instead of organization name
* use serialnumber as identifier in the hashmap for delegation claims",13
93710882,2021-09-15 11:52:47.508,Use subject serialnumber in the directory registration API,"Directory Registration API

Directory-registration-api
* store serialnumber in register service call

**Acceptatie criteria**

- [ ] The directory will keep storing the organizationname and add the serialnumber",5
93710799,2021-09-15 11:51:26.834,Add database integration tests for the inspection API,"* Add database integration tests
* Do not extract domain from the database layer

This preparation is needed for when we're introducing the subject serialnumber in the management API.",3
93710705,2021-09-15 11:49:56.065,Add database integration tests for the Management API,"* Add database integration tests for orders and access requests
* Do not extract domain from the database layer

This preparation is needed for when we're introducing the subject serialnumber in the management API.",5
93710618,2021-09-15 11:48:34.978,Management UI should display subject serialnumber,"**As a** systeembeheerder
<br>**I want** to see my own and other organizations their Subject serialnumber
<br>**so** every organization can be identified using their OIN

**:desktop_computer: How to demonstrate / e2e test(s):**

- When a OIN is present, it should be displayed
- When no OIN is present, it should display an empty value

**:white\_check\_mark: Acceptance criteria**

- [ ] Display the subject serialnumber of your own organization (to be designed by @petervermeulen)
- [ ] Display the subject serialnumber in directory view (to be designed by @petervermeulen)
- [ ] Subject serialnumber should be present in the MobX models

**:link: Reference links**

1.

![Group_52](/uploads/57cbe72a1765a36975187a34a81f9bd2/Group_52.png)",2
93710455,2021-09-15 11:46:04.443,The directory should display subject serialnumber when available,"**As a** user
<br>**I want** to be able to find the OIN of every organization in the public directory
<br>**so** I can verify the organization

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

- [ ] Display OIN in the public directory UI on the service detail pane

Design, see: https://gitlab.com/commonground/nlx/nlx/-/issues/1366

**:link: Reference links**

1.",2
93710404,2021-09-15 11:44:47.213,Make Certportal should add Subject serialnumber to certificates,"**As a** user of the demo directory
<br>**I want** the certificate I request to contain a _Subject serialnumber_
<br>**so** I can use the certificate for my NLX components

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Open the demo directory
1. Request a certificate
1. Download the generated CRT
1. Verify there is a subject serialnumber present using `openssl x509 -in org.crt -text`

**:white\_check\_mark: Acceptance criteria**

- [ ] Certportal should add a subject serial number in the `subject.serialnumber` field of the certificate 
- [ ] The subject serial number may not exceed a length of 20 characters
- [ ] The subject serial number must be unique within every NLX environment

**:link: Reference links**

1.",3
93546001,2021-09-13 08:12:17.980,Register organization inway,"**As a** NLX developer
<br>**I want** the organization inway setting in the directory to recover it self when the directory database has been reset
<br>**so** that I have a self healing and more robust system 

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Configure organization inway for ""organization a""
2. Reset the directory database
3. Send an access request to ""organization a""
4. ""organization a"" should receive this access request

** TODO **

1. [ ] ManagementAPI: GetOrganizationInway should return the organization inway flag
1. [ ] Inway: send ""is organization inway"" flag when calling RegisterInway
1. [ ] DirectoryRegistrationAPI: RegisterInway parses the organization inway flag and update the database

**:white\_check\_mark: Acceptance criteria**

1. Inway tells the directory that it should be used as management API

**:link: Reference links**

1.",5
92172321,2021-08-18 07:45:52.865,Change an existing order,"**As a** maintainer
<br>**I want** to change an existing order
<br>**so** maintaining orders is flexible and easy

The following fields should be editable
1. Order description
1. Public key
1. Start/enddate
1. Services

**:white\_check\_mark: Acceptance criteria**
1. Add entry to auditlog
1. Add edit button to order detail view in the same way as service detail view (see screenshot)
1. Open order form
1. a changed order must result in one order on both ends again

**:link: Reference links**

![Schermafbeelding_2021-11-17_om_11.25.38](/uploads/aebb8d4d49744bee683a5f46b5bfa07e/Schermafbeelding_2021-11-17_om_11.25.38.png)",5
92112806,2021-08-17 11:57:51.787,Keep track of Inway activity,"**As a** NLX maintainer  
**I want** to be able to know when an Inway was last active
<br>**so** we can prepare for automatically removing inactive Inways

**✅ Acceptance criteria**

1. When registering an Inway, the `created_at` and `updated_at` fields must be added (to know when an inway is created and when its address has been updated)
1. Process is replaced with CTX
1. Database logic is moved to `adapters`",5
92033045,2021-08-16 11:27:16.084,Handle service deletion,"#### As a owner of a service:

**Current behavior**

A service with access requests(active or revoked) cannot be deleted.

**Expected behavior**

* If there are no active access requests the service can be deleted

* if there are active access requests, the user should be informed that there are still active access requests and confirm that the user is sure he/she wants to delete the service.

* If there are active orders containing the service, the user should be informed that there are still active orders and confirm that the user is sure he/she wants to delete the service.

* If there are active orders and access requests, the user should be informed there are still active access requests and orders, the user should confirm is sure he/she wants to delete the service.

#### As owner of an outgoing order containing services owned by another organization

No actions required

#### As owner of an incoming order containing services owned by another organization

No actions required

**:white\_check\_mark: Acceptance criteria**

1. A service can be deleted even if there are active access requests or/and orders
1. Front-end gets latest connected access requests/orders before deleting
1. Check if access requests is actually active and not, for example, revoked
1. Show confirmation dialog when there are still active access requests/ orders before deleting
1. Remove service, access requests and order_service entries from database
1. If scheduler of the management API detects that the service of an access grant has been deleted, the access grant should be deleted from the database.",8
90536924,2021-07-20 06:31:01.382,Document NLX installatie-reis afwerken,"**Acceptatie creteria**

- [ ] handleiding verder doorlopen en uitbreiden
- [ ] alle TODO's zijn weggewerkt

We kunnen de Parkeerrechten API aanbieden als test-api. De Docker image: `nlxio/parkeerrechten-api` ([Parkeerrechten API](https://gitlab.com/commonground/nlx/demo/-/tree/master/parkeerrechten-api)).

**E-mail verzonden op 20 juli van @evangelderen met uitnodiging voor overleg op 10 augustus:**

> 10 augustus is de dag waarop de guide af moet zijn. Eerst in rudimentaire vorm (dus zonder lieve teksten erom heen) in het samenwerk MD bestand: https://hackmd.io/26na7EFER4yHJTfX6gQdEA?view
> 
> Wanneer hij dan goed is, dan knallen we hem in de docs site.
>  
> Niels: jij ben net terug van vakantie dan dus jij hebt alleen 3 dagen nog hiervoor en we bepalen samen met Ruben wat we oppakken.
> Ronald: jij gaat al superblij worden van de stappen die we vandaag 20 juli gezet hebben en ga absoluut je gang om het af te maken… maar… nogmaals… rudimentair.. de commando’s en korte uitleg zijn belangrijk
> Henk: voor jou is dit allemaal nieuw maar als het goed is, dan ben je nu je tweede week ingegaan en heb je waarschijnlijk de eerste week al op basis van deze guide lokaal zitten proberen en testen. Maar samen met Ronald kunnen jullie prima bepalen wat je de eerste week gaat doen.",13
90491494,2021-07-19 12:03:20.477,Add orders functionality to demo setup,"**As a** presenter of NLX
<br>**I want** to be able to demonstrate orders
<br>**so** potential users of NLX can easily see how orders work

**Prerequisites**
- make sure public key of every organization can be copied (#917)


**:white\_check\_mark: Acceptance criteria**

- The application should not load the parkeerrechten initially, since we don't know what Claim to use.
Add a 'Parkeerrechten ophalen' button with the option to provide the Claim for every organization.
- The header containing the reference nr of the opdracht is: X-NLX-Request-Claim
  - The curl command is something like: curl my-outway.nl/org/service -H ""X-NLX-Request-Claim: <opdrachtnummer>""
- the ui of parkeervergunning bv (admin) must have a text input for the order reference
- if the reference is kept empty, no Claim header should be added to the request
- describe test-flows for the orders-functionality (on ACC)

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:link: Reference links**

1.",5
90372140,2021-07-16 06:57:54.613,Enable GitLab pipeline for MRs from forks,"MR from a fork is unable to merge due to pipeline not starting: https://gitlab.com/commonground/nlx/nlx/-/merge_requests/2785

TODO: check with the Haven boys if this has security (would it be possible to alter environment settings via those runners?) / performance implications",1
88682570,2021-06-14 14:13:19.605,Provider can see its orders,"**As a** admin of NLX Management of a [Delegatee]
<br>**I want** to see my orders  
<br>**so** I have the same insight as my [Delegator(s)]

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Open NLX Management as an Delegator
1. Add a new order
1. Open NLX Management as the designated Delegatee
1. See that the new order is missing
1. Click on the 'fetch order' button
   - When clicking the button, the management api will check all organizations for new orders for me
1. Go to 'Opdrachten' list view and see the newly added opdrachten

**:white\_check\_mark: Acceptance criteria**

1. The delegatee will only fetch his own orders
1. It should be possible to retrieve the orders when directory is down
   - Do this similarly to how we do it in the outway
1. Sort same as overview of delegator: by valid until desc

**design**

See below in comments",5
88437818,2021-06-09 08:03:41.190,Add values.schema.json to our helm charts,"**As a** developer
<br>**I want** to be able to validate my helm values
<br>**so** that I can catch mistakes before deploying


**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. values.schema.json file added to all our public charts (nlx-inway, nlx-outway, nlx-management)
1. Validate using `helm lint` (https://helm.sh/docs/topics/charts/#schema-files)

**Notes**

- Reply from Conduction on the tooling they use that requires these value files:  
> ""Wij gebruiken zelf Dashkube, maar bijvoorbeeld Rancher, Red kuber, Open shift, Azure dashbashboard en bitnami ondersteunen dit volgens mij ook""

**:link: Reference links**

1. https://austindewey.com/2020/06/13/helm-tricks-input-validation-with-values-schema-json/",5
88391680,2021-06-08 12:56:45.226,Remove horizontal lines on log in screen (minor usability issue),"This issue came up multiple times now, so we better fix it. I actually became victim myself last week, so that says enough ;)

The horizontal lines makes it look like inputs, but they are purely decoration. By removing them, this is no longer an issue.

![image](/uploads/7eb753676c6e520ca130ce15e4f8a89b/image.png)",1
88322508,2021-06-07 12:31:01.929,Enable basic access authentication for NLX management,"**As a** new interested developer
<br>**I want** to be able to use basic access authentication in NLX management 
<br>**so** I do not need OpenID Connect provider to get up and running

**:desktop_computer: How to demonstrate / e2e test(s):**

1. 

**:white\_check\_mark: Acceptance criteria**

1. able to choose during installation between basic auth and OIDC (= default setting)
1. change docs to match new option
1. login page will be included in NLX management
1. remove DEX from NLX try me
1. local development will use basic auth. All other env. will use OIDC
1. edward must install nlx on his laptop


**:link: Reference links**

1.",8
87973227,2021-05-31 12:21:39.788,Simplify NLX Try me setup,"**As a** developer
<br>**I want** to use a simplified NLX setup
<br>**so** I can easily experiment with all NLX functionality

**:desktop_computer: How to demonstrate / e2e test(s):**

1. 

**:white\_check\_mark: Acceptance criteria**

1. Replace using the Directory from the `demo` environment with a local directory  
- custom CA
- directory registration API
- directory inspection API
- directory monitor

2. Running `docker compose up` should be sufficient to run the complete setup
3. Update the [Try me](https://docs.nlx.io/try-nlx/introduction) documentation section, to reflect these changes
4. Move 'Retrieve a demo certificate' to another section of the documentation

**:link: Reference links**

1.",5
87972507,2021-05-31 12:11:26.602,Automatically test NLX Try me setup,"**As a** developer
<br>**I want** to use a simplified NLX setup
<br>**so** I can easily experiment with all NLX functionality

**:desktop_computer: How to demonstrate / e2e test(s):**

1. 

**:white\_check\_mark: Acceptance criteria**

1. Enable setting an organization inway via the NLX ctl
1. Add `docker compose up` command to the CI, perform a HTTP request using the outway to the inway and verify if the response is correct.
1. Trigger the pipeline from the NLX repository for every commit on the master branch. As we do with the '[Trigger packaging build](https://gitlab.com/commonground/nlx/nlx/-/pipelines/300996356)' job.
1. Post message in slack if the pipeline for 'Try NLX' fails. The same kind of message as we have for a failed build on the `master` branch of NLX.

**:link: Reference links**

1.",5
87971841,2021-05-31 11:59:13.438,Enable transaction logs for the Try NLX setup,"**As a** developer
<br>**I want** the transaction log to be enabled by default when following the docs
<br>**so** I can experiment with the transaction logs functionality

**:desktop_computer: How to demonstrate / e2e test(s):**

1. When setting up Try NLX from the docs, transaction logs should be inserted in the txlog-db

**:white\_check\_mark: Acceptance criteria**

- Transaction logs are enabled by default for the [Try NLX](https://gitlab.com/commonground/nlx/nlx-try-me) Docker Compose file
- Document how the transaction logs can be viewed

**:link: Reference links**

1.",3
86938038,2021-05-12 12:19:00.443,Update documentation,"Remove section 'Consume an API'. It needs to be rewritten later on, using the Management UI and access requests.
(otherwise we need to accept toegangsverzoeken for every one)",1
86935322,2021-05-12 11:36:00.254,Bugfixes and remaining tasks for the 'Verwerkingenlogging',See Verwerkingenlogging board.,3
86852485,2021-05-11 11:19:14.373,Verwijder parkeervergunningen applicatie,"**NLX repo**

- [x] Helm charts
- [x] insight-ui
- [x] insight-api
- [x] insight settings page in management ui & management api (remove support for both `irmaServerURL` and `insightURL properties)
- [x] references to the insight app should be removed from the docs
- [ ] `demo.nlx.io` -> to redirect to `directory.demo.nlx.io` -> should be done through ingress
- [x] remove DNS records for `application.*.*`
- [x] remove DNS records for insight
- [ ] remove DNS records for irma

**[Demo repo](https://gitlab.com/commonground/nlx/demo)**

- [x] overview-ui (https://gitlab.com/commonground/nlx/demo/-/merge_requests/44)

**Others**

- [x] https://gitlab.com/commonground/nlx/irma (archived)
- [x] remove Parkeervergunningen from Componentencatalogus
- [ ] Remove related Docker images from the GitLab & Docker hub registries",3
86765943,2021-05-10 08:44:35.554,Use parkeerrechten apps for gemeente Stijns on ACC,"Part of #1206

Use 'toon parkeerrechten' app together with 'parkeerrechten API' in the acceptance environment for gemeente Stijns.


**Technical notes**

- we will not add the demo applications to the Review Apps (this would make Review Apps too big without too much added benefits)
- use the current NLX 'acc-environment' to deploy the demo applications (we will move these to the demo-environment later on, once we're ready setting up all apps, to shorten the feedback loop)
- the Helm-charts for the 'demo-environment' will be hosted in the NLX repository (`/helm` directory) (this is easier and allows us to focus on making NLX easier to install)
- add support for PostgreSQL to the `parkeervergunningen-api` and use PostgreSQL for the ACC environment

![Screenshot_2021-05-10_at_10.45.05](/uploads/c3367961d01db4ff43c2da9f5726c6bf/Screenshot_2021-05-10_at_10.45.05.png)",3
86516238,2021-05-05 11:56:35.722,Create NLX deployment chart (which includes all sub-charts),"**As a** developer
<br>**I want** to install NLX using a single command
<br>**so** I feel empowered

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Enable installing NLX using a single Helm chart
1. Add support for the following ""modes""  
- Provide a service
- Use a service
1. Document the following scenario's on docs.nlx.io:  
- Provide a service
- Use a service

**Tasks**

- [x] Support optional CertManager config by default
- [ ] Automatically run migrations
- [x] Add support for adding a super-user

**:link: Reference links**

1.",8
86441199,2021-05-04 09:44:09.882,Fix inconsistent Helm charts,"**As an** organization attempting to setup NLX using Kubernetes
<br>**I want** properly documented Helm charts
<br>**so** I can install NLX without asking for help

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Enable specifying a custom port and database name for the postgres connection 
(Make postgresql settings configurable in Helm charts)
* Management API/UI
1. An inway should be externally available by default  
(Make `serviceType` and related config configurable for Inway and document the different values / implications)
1. Review the ingress for the Inway (is this outdated and should it be removed for example?)
1. Make a clear distinction between the internal PKI and organization certs (if we don't succeed in issuing the internal PKI certificates using CertManager)
1. Make clear which fields are required in the Helm charts README

**:link: Reference links**

1.",5
86134389,2021-04-28 12:25:42.017,Create demo app to create a parkeerrecht,"Depends on #1221 (copy app)

* [x] shows list of parkeerrechten (after clicking button)
* shows a form to add a parkeerrecht
  * [x] choose gemeente (list of gemeentes is passed through environment variables)
  * [x] enter kenteken, which fetches data from `basisregister-fictieve-kentekens` and `-personen`
  * [x] show car model and personal data. Then either:
    * if all ok: enable submit button
    * if not in selected gemeent: show warning
* [x] include application in deployment to ACC for the Vergunningsoftware BV",3
80161533,2021-03-03 11:02:47.157,Create E2E test for access request flow,"Currently some parts of the database-layer are not being tested as we mock the database in our unittests. We do want to test this but it's hard to create end-to-end tests as it requires two Management API's, access requests etc.

We need e2e tests for:

1. Create a failing request to a service without access
2. Create an access request
3. Accept access request
4. Make the same request as in step 1 and watch it succeed",2
80069538,2021-03-02 09:24:10.921,Show overview of created delegations,"**As a** municipality
<br>**I want** to have an overview of the delegations I have created
<br>**so** that I know which services can be accessed on my behalf by other organizations

**:desktop_computer: How to demonstrate / e2e test(s):**

1. As municipality, open NLX management and navigate to ""Opdrachten""
1. If there are no delegations an empty state is shown
1. If there are delegations they are shown in the overview
1. Click on a delegation to open the delegation detail view in drawer
1. Click on ""Toon verlopen opdrachten"" to show expired delegations

**:white\_check\_mark: Acceptance criteria**

1. do not implement the status column
1. add a column with the validUntill: valid until as header
1. there is no difference between actual or expired orders
1. the table is sorted on validUntil Desc


Technical implementation



![_todo__Opdrachten](/uploads/40f8c525d0b070ad597f650c1f20c853/_todo__Opdrachten.png)

![_todo__Opdrachten_-_Ontvangen](/uploads/b8b0136209eb9ea24ed67550eb4d8752/_todo__Opdrachten_-_Ontvangen.png)

![_todo__Opdrachten_-_Verlopen_expanded](/uploads/bf92db68f984ee5f0b89c0545a887032/_todo__Opdrachten_-_Verlopen_expanded.png)

![_todo__Opdrachten_-_Empty_state](/uploads/d0fc0fa085097421d988706435483978/_todo__Opdrachten_-_Empty_state.png)

![_todo__Opdrachten_-_Details](/uploads/2d9fbef2854e3161cd8593486e499fd5/_todo__Opdrachten_-_Details.png)

**:link: Reference links**

1.",5
80063691,2021-03-02 08:16:10.781,Revoke access delegation,"**As a** _user_
<br>**I want** _goal_
<br>**so** _purpose_

- een opdracht hoeft/kan maar door 1 partij ingetrokken worden
- een ingetrokken opdracht ziet er net iets anders uit in het overzicht (Peter)
- het intrekken gebeurt lokaal direct
  - via de scheduler gaat het naar de andere kant

scenario 1: opdrachtgever trekt actieve opdracht in
- een opdrachtnemer kan dus max de duur van zijn geldige claim nog bij de gegevens obv die opdracht

scenario 2: opdrachtnemer trekt actieve opdracht in
- de outway gaat controleren of de opdracht nog wel geldig is die hoort bij de referentie nr en organisatie naam in de call van de client
  - indien er geen actieve opdracht is, dan geen verzoek naar buiten
- een opdrachtnemer kan dus max de duur van zijn geldige claim nog bij de gegevens obv die opdracht

scenario 3: opdrachtgever of opdrachtnemer verwijderd inactieve opdracht
- dit is alleen een lokaal ding. niet syncen
- weight is 3 (just in case we want to create a separate story for this)


**Updated as part of discussion wed 25th**:

If we implement revoking an order as delegatee, we would introduce a pulling mechanism. This would require for the organization to have an inway, even if they don't provide any service.

We're in doubt if we should make an inway required for organizations not providing a service. This must be discussed first.

Conclusion: revoking incoming orders should not be possible, that's out of scope for now


![_todo__Opdrachten_-_Details_Copy_2](/uploads/1b4ba906864a8abe4cbf38eacdeb9e0c/_todo__Opdrachten_-_Details_Copy_2.png)

![_todo__Opdrachten_-_Ontvangen_Copy](/uploads/2ec5297e818395b1a3a446dda1dcbe3d/_todo__Opdrachten_-_Ontvangen_Copy.png)



**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. update the sequence diagram (as seen in the epic)

**:link: Reference links**",13
80061764,2021-03-02 07:45:10.718,Grant delegation to a supplier,"**As a** municipality
<br>**I want** to be able to allow suppliers to access services on my behalf
<br>**so** that I do not need to share my private key

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Make a request as Saas Party X to kentekenregister of RDW and watch it fail
1. Log in to NLX management of Gemeente Haarlem
1. Create delegation for Saas Party X to access the service kentekenenregister on behalf of Gemeente Haarlem
1. Make a request as Saas Party X to kentekenregister of RDW with the delegation header and watch it succeed

### Checks we perform when requesting a claim for an order:

All checks below must succeed, otherwise, no claim will be given.

* *Reference*: is there an order for the provided order reference?
* *Public key*: is public key of the order equal to the public key of the organization requesting the claim
* *Date*: is the end date of the order in the future



**:white\_check\_mark: Acceptance criteria**

1. As a municipality, I want to be able to add a new delegation for a SaaS Party
1. The fields required for a new order are:  
  - Reference (text field max length 100, unique value)
  - Description (max. length 100)
  - Public key (server-side validation if its a valid public key), text field
  - Name of the organization you want to delegate access to (URL-friendly, see [validation in our code](https://gitlab.com/commonground/nlx/nlx/-/blob/4c7f0be8b2c9c980351b6202fbd2106bf4acdab0/directory-registration-api/pkg/database/inway.go#L16)), text field
  - Valid from (valid date)
  - Valid until (valid date)
  - Services (only services for which the municipality has an access grant)
1. Management API of the Municipality should return the real created delegation (instead of the mock, build as part of #1179)
1. Make sure the relevant audit log records are implemented
1. Add description of delegations to docs.nlx.io

**Tasks**

1. [x] Implement add delegation form in UI
1. [x] Add endpoint to add order to management api (for municipality)
1. [x] Update `RequestClaim` endpoint to check if there's an order for the delegatee with the provided order reference
1. [x] `ExpiredAt` of claim should not exceed the `validUntil` property of the order
1. [x] Claim should expire after 4 hours

**Questions**

- How should the list of services look like? Proposal: `<organization-name> - <service-name>` Comment Peter: Good proposal
- Should 'Valid until' be required? Yes
- Should we add 'Doelbinding'? Is 'Opdrachtomschrijving' 'Doelbinding'? We will not add Doelbinding and ""Opdracht omschrijving"" and ""Doelbinding"" are not the same
- OPEN @ehotting : do we need to add a disclaimer that the opdracht is not a legal document?

![_todo__Opdrachten_-_Add_new_Copy](/uploads/1f31acbd7be2c8750c0987a904179ff6/_todo__Opdrachten_-_Add_new_Copy.png)

Audit log records:<br>
![image](/uploads/22f7ac388d017dd2896286e8d712ae36/image.png)

**:link: Reference links**

1.",13
79990593,2021-03-01 09:47:52.970,Access services as a supplier,"**As a** supplier
<br>**I want** to access services using a mandate given by a municipality
<br>**so** I do not have to share my private key with the supplier

**:desktop_computer: How to demonstrate / e2e test(s):**

1. Send a request without delegation header and watch it fail
1. Saas Party X can access RDW on behalf of Gemeente Haarlem by sending a request with delegation header
1. The transaction log of RDW should show that the request was made on behalf of Gemeente Haarlem

**:white\_check\_mark: Acceptance criteria**

1. A supplier can access a service on behalf of an organization
1. The transaction log record made for a request should include that it was a delegation
1. Delegated access should be granted on the organization certificate of the supplier
1. A delegated request should be verifyable without making additional API requests.
1. The creation of claim must by synchronous

Tasks:

1. [x] Create the gRPC endpoint to retrieve a claim from municipality
1. [x] Store public key with incoming acces request
1. [x] Parse delegation header in the outway (@excol-org)
1. [x] Check if claim exists in the outway (@excol-org)
1. [x] Create the gRPC endpoint to retrieve claim outway-> management api  (@ndequeker)
1. [x] Verify claim in the inway using the public key stored in the incoming access request (!2346) (@RonaldKoster @ndequeker )
1. [x] Store delegation data in the transaction log of outway (@excol-org)
1. [x] Store delegation data in the transaction log of inway (@RonaldKoster @ndequeker)
1. [x] Add Saas Party X to Helm charts (!2332) (@RonaldKoster)
1. [x] Prepare demo setup to send a delegated request using Saas Party X, gemeente Haarlem and RDW
1. [x] Outway should fail to start if no management-api is specified.
1. [ ] Optional: add E2E tests for the demo scenario, using Cypress (see https://gitlab.com/commonground/nlx/nlx/-/issues/1199)


**Technical implementation**

1. The management API of the municipality will always return a valid claim. We will merge this with master but we won't release it. In case we need to make a release because of a bug we will add a feature flag to disable it.

**:link: Reference links**

Sequence diagram, see https://gitlab.com/groups/commonground/nlx/-/epics/14",13
79979444,2021-03-01 08:01:01.157,Remove ability to configure inway with config file,"**As a** NLX maintainer
<br>**I want** to remove the ability to configure the inway with a .toml file
<br>**so** that NLX users are forced to embrace the future (NLX management) and NLX becomes easier to maintain

Breaking changes:
1. Authorization mode is replaced by access requests
1. ca-cert-path can no longer be configured

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Improve code quality of the `inway`  
* remove `common/process.go` (replace with context?) (@excol-org @RonaldKoster )
* use plugin system from outway (move to `common`?) (@excol-org)
1. Update demo organization BRP so that is uses NLX management (@RonaldKoster)
1. Update the docs !2380 (@ndequeker)
1. Communicate this change together with @evangelderen
1. Remove all code needed for the .toml file

**:link: Reference links**

1.",8
79777109,2021-02-25 09:49:52.474,GRPC Gateway v1.x -> v2.x,"As part of #1158, we've discovered that the [GRPC Gateway has released v2](https://github.com/grpc-ecosystem/grpc-gateway/releases/tag/v2.0.0) which is a new major version. We need to upgrade the compilation steps (from our proto-files to `*.pb.go`, `pb.gw.go` & `.swagger.json`).

We currently have five proto-files:

1. directory-inspection-api/inspectionapi/inspectionapi.proto
1. directory-inspection-api/stats/stats.proto
1. directory-registration-api/registrationapi/registrationapi.proto
1. management-api/api/management.proto
1. management-api/api/external/external.proto

We've tried to gradually move from v1 -> v2 using [Earthly](https://docs.earthly.dev), but did not succeed in a timely matter.
We can make another attempt, or transition to v2 for all our proto-files.",3
79276948,2021-02-17 14:43:53.799,Create a helm repository for the NLX helm charts,"**As a** developer
<br>**I want** to download the NLX helm charts from a helm repository
<br>**so** that I can install/update the charts using the helm cli

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. There is a helm repository (https://helm.sh/docs/topics/chart_repository/)


**Todo**
- [ ] Replace repository in README's

**:link: Reference links**

1.",3
78404665,2021-02-04 07:48:05.797,Pagination for Services page,"**As a** user
<br>**I want** to have a paginated list of the organizations of my service
<br>**so** my browser does not crash with large list of services

**:desktop: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Add pagination for the Services page (max. 20 items per page)
1. Polling statistics for the services should only include statistics for the current page
1. Re-use the pagination component(s) from the DON project

**:link: Reference links**

1.",3
78288517,2021-02-02 15:12:00.479,Show pricing data of the service,"**As a** user interested in a service
<br>**I want** to see the costs when this service is not free to use
<br>**so** I know I will receive an invoice

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. NLX Management directory should show detailed pricing info on the detail view
1. The 'request access modal' should indicate that you're requesting access to a paid service

**:link: Reference links**

1.

![_todo__Directory_-_Details](/uploads/9de006f2d040d0739a3573a8e11c0b2b/_todo__Directory_-_Details.png)

![Group_9_Copy_4](/uploads/222fac4a34d1900fee708fba73328c72/Group_9_Copy_4.png)",5
78288488,2021-02-02 15:11:44.215,Add pricing information to services,"**As a** _user_
<br>**I want** _goal_
<br>**so** _purpose_


**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. When submitting a new service, the following fields are required:
   - administration fee (for setting up the contract and access)
   - subscription fee (per month)
   - transaction fee (cost per use)
1. Pricing fields are set to '0' by default
1. Service detail pane should display the pricing fields

**:link: Reference links**

1.

![_busy__Add_new_service](/uploads/8c020085cc2ae7c7a1c1d299d88a15f2/_busy__Add_new_service.png)

![_busy__Services_-_Details](/uploads/caa1f2284e0341d4fb0cea6fe33a8a3d/_busy__Services_-_Details.png)",3
78287468,2021-02-02 15:03:39.044,Export billing info,"**As a** purchase / ordering employee
<br>**I want** to download all financial information about the use of my services 
<br>**so** I can create invoice for my customers

**:desktop_computer: How to demonstrate / e2e test(s):**

1. go to the 'Activity' page
1. click on the download button
1. open file with Numbers on my shiny Mac

**:white\_check\_mark: Acceptance criteria**

- Filename: YYYYMMDD-activiteit-per-organisatie.csv
- see csv drawing below for columns  
   Note: see warning below for actual info
- Group by: service -> organisation -> month
- Documentation about 'Enable transaction logs' should include instructions on how to specify log database URL to NLX Management
- Only include transactions for you inway in report
- When unable to connect to the DB -> export should be an empty CSV

**:link: Reference information**

![csv-export](/uploads/b1ce3ad60fc736fa63a28e04cbbe6b79/Untitled-2021-02-08-1345.png)  
> source: https://excalidraw.com/#json=4645701698977792,v1uHInLjAMIyq8Q48_coXQ

:warning: The above rows are not completely accurate anymore. For each organization/service it should list:

- 1 line for initial setup cost
- 1 line per month if montly fee
- 1 line per month per # requests

![_todo__Organization_activity_Copy_4](/uploads/2491713205c5489942fb75ad0da8be66/_todo__Organization_activity_Copy_4.png)

State where there is no transaction log configured:<br>
![image](/uploads/c8cccf650c0157dd77214b8043b070e2/image.png)",5
77877271,2021-01-26 16:06:46.260,Same name for api properties,"See `management.proto` :

`message ServiceStatistics` has `incomingAccessRequestCount`  
but a few lines below  
`message Service` has `incomingAccessRequestsCount`

It should be singular: incomingAccessRequestCount

This needs to be changed in BE and FE.",1
77545391,2021-01-20 13:40:55.546,Document NLX in production,"**As a** developer
<br>**I want** know how to setup NLX in my production environment
<br>**so** that I can run NLX in production

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Create a NLX in production section on docs.nlx.io
1. Make the destinction between Try NLX and NLX in production as clear as possible
1. Improve 'Request a production certificate' clearly describe and number all steps needed to get your production certificate. 
1. Add a description on how to generate the internal PKI certificates
1. Add drawing of connections that use internal PKI and PKI-O created by @hugoboos 

**:link: Reference links**

1.",8
77544853,2021-01-20 13:33:17.248,nlx.io - investigate toolset,"Determine what toolset we need to build the new site containing:

* nlx website
* docs
  * how to implement search without docusaurus
* directory

Outcome:  
- describe the toolset (below)

---

**Research and result**
In Epic: https://gitlab.com/groups/commonground/nlx/-/epics/19",8
77544039,2021-01-20 13:21:28.432,Document helm charts,"**As a** developer
<br>**I want** know how I can use the NLX helm charts
<br>**so** that I am able to install NLX on my Kubernetes cluster

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. Add a readme to each chart describing the possible values. (https://github.com/jetstack/cert-manager/blob/master/deploy/charts/cert-manager/README.template.md)
1. Make the charts available as a helm repository (https://helm.sh/docs/topics/chart_repository/)


**:link: Reference links**

1.",5
76140675,2020-12-16 13:45:36.924,Validate claims in authorization middleware,"Currently, in the `OnlyAuthenticated` middleware (`management-api/pkg/oidc/authenticator.go:106`) we only validate if the `user` session is set and if it contains a valid user object. This is not sufficient for secure authorization.  

**Acceptance criteria**  

1. We should validate the claims and at least perform these checks:

- Is the `nbf` (Not Before) in the future?
- Is the `exp` (Expiry Date) in the past?

These checks can be performed stateless.

2. Save refresh token on auth. Use refresh token after current access token has expired.",3
76140403,2020-12-16 13:39:22.733,Add authorisation to Management UI,"**As a** 
<br>**I want** _goal_
<br>**so** _purpose_


**:white\_check\_mark: Acceptance criteria**

1. Store roles for users in the NLX Management database
1. Show error message when user exists in OpenID connect but not in NLX Management
1. In the future we would like to map groups in OpenID Connect to roles in NLX Management
1. There should be atleast a admin role. 
1. A user can be added using the command-line. When adding the user you can specify the ID(email) and role. Eg `nlx-management-api create-user --username dillen --role admin`  

**Acceptance criteria**
1. When the user does not have the 'admin' role authentication should fail
1. When something in the authentication flow fails the user should see what went wrong

**:link: Reference links**

1.",8
75705606,2020-12-07 12:48:33.593,Polling: outgoing access request & access proof on directory detail page,"**As a** user
<br>**I want** the detail page to update with the latest outgoing access request and access proof data
<br>**so** I know what's going on

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. poll every 3000ms
1. updates outgoing access request & access proof data
1. UI will update to latest state

**tech impl**

1. subscribe to polling manager
1. update mobx",2
75704771,2020-12-07 12:33:04.957,Polling: incoming access requests & access grants in service detail view,"**As a** user
<br>**I want** to be notified when there are new incoming access requests or access grants when I'm looking at the service detail page
<br>**so** that I can see the new data on clicking the blue pill

**:desktop_computer: How to demonstrate / e2e test(s):**

1. open service detail page
1. do an access request in another tab
1. see the blue pill appear
1. click blue pill to update list

**:white\_check\_mark: Acceptance criteria**

1. poll every 3000ms
1. design in epic
1. clicking the blue pill will update the list

**:link: Reference links**

1.

**:unicorn: Designs**

Specs:<br>
`background-color: $colorBrand4; //#36C6FF`<br>
`color: $colorTextInverse; //$colorPaletteGrey900`<br>
`margin-bottom: -$spacing03; //of iets anders waardoor ie 8px lager staat dan de content`<br>

Icon:<br>
![arrow-down-line.svg](/uploads/fb770900dcfea4fa85f61481a5d984e3/arrow-down-line.svg)

<br><br>
![Group_113](/uploads/c87645c933bb68d32a7e950a5b5a8468/Group_113.png)

![Screen_Recording_2020-12-02_at_16.05.18](/uploads/6757ccab5213d6c75e008908b6966661/Screen_Recording_2020-12-02_at_16.05.18.mov)",3
75703788,2020-12-07 12:14:53.151,Polling: incoming access requests on service overview page,"**As a** user
<br>**I want** incoming access requests to automatically appear when I'm looking at the service overview page
<br>**so** I know about the actual state of incoming access requests



**:desktop_computer: How to demonstrate / e2e test(s):**

1. go to service overview page
1. add an access request from other tab
1. see the UI update

**:white\_check\_mark: Acceptance criteria**

1. poll every 3000ms
1. design in epic

**Technical implementation**

1. add new endpoint: `/api/v1/services/stats`  
   Let's discuss the format of the returned JSON
1. use polling manager
1. from react -subscribe to manager

**Details**

@publicJorn and I discussed that the format should be:

```
{
  ""test-service-1"": {
    ""incomingAccessRequestCount"": 1
  },
  ""test-service-2"": {
    ""incomingAccessRequestCount"": 2
  }
}
```

This is neat because then we can add other statistics to the same endpoint in the future.",3
75483168,2020-12-02 12:33:19.129,Show warning when removing organization inway,"**As a** user
<br>**I want** to see a warning when removing organization inway
<br>**so** I am warned that things will go wrong

**:desktop_computer: How to demonstrate / e2e test(s):**

1. go to settings
1. remove organization inway

**:white\_check\_mark: Acceptance criteria**

1. In settings, when resetting organization inway (becomes null) show warning:  
   ""Bij het verwijderen van de organisatie inway kunnen huidige toegangsverzoeken niet meer worden afgehandeld en kan je geen nieuwe meer ontvangen""",1
74956580,2020-11-25 09:16:14.047,Docs: try NLX management config mismatch,"## Situation

On the page https://docs.nlx.io/try-nlx/management/getting-up-and-running we tell the user needs to clone the NLX git repository. This results in a untagged version of the `docker-compose.management.yml` file. That file contains Docker images with the tag latest.


## Problem

The problem with this is that the settings in `docker-compose.management.yml` can mismatch with what the `latest` Docker tag points to (at the moment of cloning and pulling).

Also the user needs to clone the whole code base for a single file to run a demo.


## Proposed solution

Use a dedicated git repository for this demo and version Docker tags instead of `latest`.

- [x] Move docker-compose.management.yml to new repo 'nlx-try-me'
- [x] Add DEX config
- [x] Create demo PKI
- [x] Alter 'getting up and running'  section of docs.nlx.io
- [x] Make sure it is clear at every step this is just meant to get to know NLX, NOT FOR PRODUCTION
- [x] Add renovate bot for auto updating of docker-compose
- [x] Add README with again clear warnings",3
74170889,2020-11-10 22:10:55.564,Always show request button on overview when I can request access,"**As a** user
<br>**I want** to see the request button on the overview page
<br>**so** i can request access

**:desktop_computer: How to demonstrate / e2e test(s):**

1.

**:white\_check\_mark: Acceptance criteria**

1. when the access request already has a state, show the button over the text of that state

**:link: Reference links**

1.",2
73525271,2020-10-28 14:37:09.700,Directly expose button,Link to original issue: https://gitlab.com/commonground/core/design-system/-/issues/29,1
